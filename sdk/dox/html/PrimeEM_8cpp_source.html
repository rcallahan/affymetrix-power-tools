<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Affymetrix Power Tools: algorithm/em/PrimeEM.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_0018e20dbf892c4f939a53901e94feca.html">algorithm</a>      </li>
      <li><a class="el" href="dir_1c7383bb4934fd8c5bf3a9756e4d7ada.html">em</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>PrimeEM.cpp</h1>  </div>
</div>
<div class="contents">
<a href="PrimeEM_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">////////////////////////////////////////////////////////////////</span>
<a name="l00002"></a>00002 <span class="comment"></span><span class="comment">//</span>
<a name="l00003"></a>00003 <span class="comment">// Copyright (C) 2006 Affymetrix, Inc.</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This program is free software; you can redistribute it and/or modify </span>
<a name="l00006"></a>00006 <span class="comment">// it under the terms of the GNU General Public License (version 2) as </span>
<a name="l00007"></a>00007 <span class="comment">// published by the Free Software Foundation.</span>
<a name="l00008"></a>00008 <span class="comment">// </span>
<a name="l00009"></a>00009 <span class="comment">// This program is distributed in the hope that it will be useful, </span>
<a name="l00010"></a>00010 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of </span>
<a name="l00011"></a>00011 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU </span>
<a name="l00012"></a>00012 <span class="comment">// General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment">// </span>
<a name="l00014"></a>00014 <span class="comment">// You should have received a copy of the GNU General Public License </span>
<a name="l00015"></a>00015 <span class="comment">// along with this program;if not, write to the </span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// Free Software Foundation, Inc., </span>
<a name="l00018"></a>00018 <span class="comment">// 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
<a name="l00019"></a>00019 <span class="comment">//</span><span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment">////////////////////////////////////////////////////////////////</span>
<a name="l00021"></a>00021 <span class="comment"></span><span class="comment"></span>
<a name="l00022"></a>00022 <span class="comment">/**</span>
<a name="l00023"></a>00023 <span class="comment"> * @file   PrimeEM.cpp</span>
<a name="l00024"></a>00024 <span class="comment"> * @author Xiaojun Di</span>
<a name="l00025"></a>00025 <span class="comment"> * @date   Tue Aug 14 11:56 2006</span>
<a name="l00026"></a>00026 <span class="comment"> * </span>
<a name="l00027"></a>00027 <span class="comment"> * DRAFT: wraps the EM algorithmics for genotyping under SDK</span>
<a name="l00028"></a>00028 <span class="comment"> * </span>
<a name="l00029"></a>00029 <span class="comment"> */</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="PrimeEM_8h.html">algorithm/em/PrimeEM.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="comment">//</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00034"></a>00034 <span class="comment">//</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="keyword">using namespace </span>std;
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">// some global constants</span><span class="comment"></span>
<a name="l00039"></a>00039 <span class="comment">/// NA</span>
<a name="l00040"></a><a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b">00040</a> <span class="comment"></span><span class="preprocessor">#define NA      -1*numeric_limits&lt;double&gt;::max()</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span><span class="comment">/// maximum of doubles</span>
<a name="l00042"></a><a class="code" href="PrimeEM_8cpp.html#a6b65f4b50d2d129e2fe16f8febc172c4">00042</a> <span class="comment"></span><span class="preprocessor">#define MAX_DOUBLE      numeric_limits&lt;double&gt;::max()</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="comment">/// infinity of doubles</span>
<a name="l00044"></a><a class="code" href="PrimeEM_8cpp.html#a12c2040f25d8e3a7b9e1c2024c618cb6">00044</a> <span class="comment"></span><span class="preprocessor">#define INF     numeric_limits&lt;double&gt;::infinity()</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="comment">/// very small positive double number</span>
<a name="l00046"></a><a class="code" href="PrimeEM_8cpp.html#a002b2f4894492820fe708b1b7e7c5e70">00046</a> <span class="comment"></span><span class="preprocessor">#define EPSILON numeric_limits&lt;double&gt;::epsilon()</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00048"></a>00048 <span class="comment">/**</span>
<a name="l00049"></a>00049 <span class="comment">* Utility function to calculate value from Gaussian function </span>
<a name="l00050"></a>00050 <span class="comment">* with an exponential tail</span>
<a name="l00051"></a>00051 <span class="comment">* @param z - the z value</span>
<a name="l00052"></a>00052 <span class="comment">* @param zCut - where the exponential part starts</span>
<a name="l00053"></a>00053 <span class="comment">* @param factor - a scale factor</span>
<a name="l00054"></a>00054 <span class="comment">* @return the value of z</span>
<a name="l00055"></a>00055 <span class="comment">*/</span>
<a name="l00056"></a><a class="code" href="PrimeEM_8h.html#ae6bc1980d3e90d39bacec21e763e2156">00056</a> <span class="keywordtype">double</span> <a class="code" href="PrimeEM_8cpp.html#a24f9591c87bebc6c97f9ba0ff1b9f181" title="Utility function to calculate value from Gaussian function with an exponential tail.">calcGaussianWithExpTail</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> z,<span class="keyword">const</span> <span class="keywordtype">double</span> zCut,<span class="keyword">const</span> <span class="keywordtype">double</span> factor) 
<a name="l00057"></a>00057 {
<a name="l00058"></a>00058         <span class="keywordtype">double</span> absz = fabs(z);
<a name="l00059"></a>00059         <span class="keywordtype">double</span> exponent = 0;
<a name="l00060"></a>00060         <span class="keywordflow">if</span>(absz &lt; zCut) 
<a name="l00061"></a>00061         {
<a name="l00062"></a>00062                 exponent = -0.5f*absz*absz*factor; 
<a name="l00063"></a>00063         }
<a name="l00064"></a>00064         <span class="keywordflow">else</span> 
<a name="l00065"></a>00065         {
<a name="l00066"></a>00066                 exponent = -0.5f*zCut*absz*factor;
<a name="l00067"></a>00067         } 
<a name="l00068"></a>00068 
<a name="l00069"></a>00069         <span class="keywordflow">if</span>(exponent &lt; -200) {
<a name="l00070"></a>00070                 exponent = -200;
<a name="l00071"></a>00071         }
<a name="l00072"></a>00072         <span class="keywordflow">return</span> exp(exponent);
<a name="l00073"></a>00073 }<span class="comment"></span>
<a name="l00074"></a>00074 <span class="comment">/**</span>
<a name="l00075"></a>00075 <span class="comment">* Utility function to calculate probability from Gaussian distibution </span>
<a name="l00076"></a>00076 <span class="comment">* with an exponential tail given the mean and standard deviation</span>
<a name="l00077"></a>00077 <span class="comment">*</span>
<a name="l00078"></a>00078 <span class="comment">* @param x - the observation</span>
<a name="l00079"></a>00079 <span class="comment">* @param mu - mean of the gaussian distribution</span>
<a name="l00080"></a>00080 <span class="comment">* @param sigma - standard deviation of the gaussian distribution</span>
<a name="l00081"></a>00081 <span class="comment">* @param weight - the weight</span>
<a name="l00082"></a>00082 <span class="comment">* @param zCut - where the exponential part starts</span>
<a name="l00083"></a>00083 <span class="comment">* @param useWeight - flag to indicate whether weight should be used or not</span>
<a name="l00084"></a>00084 <span class="comment">* @return the probability of x from the given Gaussian distribution</span>
<a name="l00085"></a>00085 <span class="comment">*/</span>
<a name="l00086"></a><a class="code" href="PrimeEM_8h.html#a4d0605813203e35f80dbfac9e86b88e8">00086</a> <span class="keywordtype">double</span> <a class="code" href="PrimeEM_8cpp.html#af67b6328c5c42d5555d800b9ac3419b2" title="Utility function to calculate probability from Gaussian distibution with an exponential tail given th...">calcProbability</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x,
<a name="l00087"></a>00087                        <span class="keyword">const</span> <span class="keywordtype">double</span> mu,
<a name="l00088"></a>00088                        <span class="keyword">const</span> <span class="keywordtype">double</span> sigma,
<a name="l00089"></a>00089                        <span class="keyword">const</span> <span class="keywordtype">double</span> weight,
<a name="l00090"></a>00090                        <span class="keyword">const</span> <span class="keywordtype">double</span> zCut,
<a name="l00091"></a>00091                        <span class="keywordtype">bool</span> useWeight)
<a name="l00092"></a>00092 {
<a name="l00093"></a>00093         <span class="keywordtype">double</span> z = (mu - x)/sigma;
<a name="l00094"></a>00094         <span class="keywordtype">double</span> p = 0;
<a name="l00095"></a>00095         <span class="keywordtype">double</span> exponent = <a class="code" href="PrimeEM_8cpp.html#a24f9591c87bebc6c97f9ba0ff1b9f181" title="Utility function to calculate value from Gaussian function with an exponential tail.">calcGaussianWithExpTail</a>(z,zCut,1);
<a name="l00096"></a>00096         <span class="keywordflow">if</span>(useWeight) 
<a name="l00097"></a>00097         {
<a name="l00098"></a>00098                 p = (weight * exponent)/sigma;
<a name="l00099"></a>00099         }
<a name="l00100"></a>00100         <span class="keywordflow">else</span> 
<a name="l00101"></a>00101         {
<a name="l00102"></a>00102                 p = exponent/sigma;
<a name="l00103"></a>00103         }
<a name="l00104"></a>00104         <span class="keywordflow">return</span> p;
<a name="l00105"></a>00105 }<span class="comment"></span>
<a name="l00106"></a>00106 <span class="comment">/**</span>
<a name="l00107"></a>00107 <span class="comment">* @brief, the default constructor</span>
<a name="l00108"></a>00108 <span class="comment">* @param clusters - number of clusters to cluster data into </span>
<a name="l00109"></a>00109 <span class="comment">*/</span>
<a name="l00110"></a><a class="code" href="classCEMSeed.html#a9bb79a449b95cb5eed69f1b153ea6356">00110</a> <a class="code" href="classCEMSeed.html#a9bb79a449b95cb5eed69f1b153ea6356" title=", the default constructor">CEMSeed::CEMSeed</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> clusters) 
<a name="l00111"></a>00111 {
<a name="l00112"></a>00112         <a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.resize(clusters);
<a name="l00113"></a>00113         <a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.resize(clusters);
<a name="l00114"></a>00114         <a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.resize(clusters);
<a name="l00115"></a>00115         <a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.resize(clusters);
<a name="l00116"></a>00116         <a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.resize(clusters);
<a name="l00117"></a>00117         <a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.resize(clusters);
<a name="l00118"></a>00118         <a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.resize(clusters);
<a name="l00119"></a>00119 }<span class="comment"></span>
<a name="l00120"></a>00120 <span class="comment">/**</span>
<a name="l00121"></a>00121 <span class="comment">* @brief set the number of cluters</span>
<a name="l00122"></a>00122 <span class="comment">* @param clusters - number of clusters to cluster data into</span>
<a name="l00123"></a>00123 <span class="comment">*/</span>
<a name="l00124"></a><a class="code" href="classCEMSeed.html#a492085ad480e0c60d544028b21e8834b">00124</a> <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#a492085ad480e0c60d544028b21e8834b" title="set the number of cluters">CEMSeed::set</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> clusters) 
<a name="l00125"></a>00125 {
<a name="l00126"></a>00126         <a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.resize(clusters);
<a name="l00127"></a>00127         <a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.resize(clusters);
<a name="l00128"></a>00128         <a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.resize(clusters);
<a name="l00129"></a>00129         <a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.resize(clusters);
<a name="l00130"></a>00130         <a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.resize(clusters);
<a name="l00131"></a>00131         <a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.resize(clusters);
<a name="l00132"></a>00132         <a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.resize(clusters);
<a name="l00133"></a>00133 }<span class="comment"></span>
<a name="l00134"></a>00134 <span class="comment">/**</span>
<a name="l00135"></a>00135 <span class="comment">* @brief assignment operator</span>
<a name="l00136"></a>00136 <span class="comment">*/</span>
<a name="l00137"></a><a class="code" href="classCEMSeed.html#a8e3ce0f3c582336ca5ed5898f669e50e">00137</a> <a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a>&amp; <a class="code" href="classCEMSeed.html#a8e3ce0f3c582336ca5ed5898f669e50e" title="assignment operator">CEMSeed::operator = </a>(<span class="keyword">const</span> <a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a>&amp; rhs)
<a name="l00138"></a>00138 {
<a name="l00139"></a>00139         copy(rhs.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.end(),<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin());
<a name="l00140"></a>00140         copy(rhs.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.end(),<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin());
<a name="l00141"></a>00141         copy(rhs.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.end(),<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.begin());
<a name="l00142"></a>00142         copy(rhs.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.end(),<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.begin());
<a name="l00143"></a>00143         copy(rhs.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.end(),<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin());
<a name="l00144"></a>00144         copy(rhs.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.end(),<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin());
<a name="l00145"></a>00145         copy(rhs.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.end(),<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin());
<a name="l00146"></a>00146 
<a name="l00147"></a>00147         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00148"></a>00148 }<span class="comment"></span>
<a name="l00149"></a>00149 <span class="comment">/**</span>
<a name="l00150"></a>00150 <span class="comment">* @brief equal operator</span>
<a name="l00151"></a>00151 <span class="comment">*/</span>
<a name="l00152"></a><a class="code" href="classCEMSeed.html#a5ceba62391d0f0b151c9f18e1af59243">00152</a> <span class="keywordtype">bool</span> <a class="code" href="classCEMSeed.html#a5ceba62391d0f0b151c9f18e1af59243" title="equal operator">CEMSeed::operator == </a>(<span class="keyword">const</span> <a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a>&amp; rhs)
<a name="l00153"></a>00153 {
<a name="l00154"></a>00154         <span class="keywordtype">bool</span> ret = <span class="keyword">true</span>;
<a name="l00155"></a>00155         ret &amp;= equal(rhs.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.end(),<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin());
<a name="l00156"></a>00156         ret &amp;= equal(rhs.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.end(),<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin());
<a name="l00157"></a>00157         ret &amp;= equal(rhs.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.end(),<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.begin());
<a name="l00158"></a>00158         ret &amp;= equal(rhs.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.end(),<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin());
<a name="l00159"></a>00159         ret &amp;= equal(rhs.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.end(),<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.begin());
<a name="l00160"></a>00160         ret &amp;= equal(rhs.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.end(),<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin());
<a name="l00161"></a>00161         ret &amp;= equal(rhs.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin(),rhs.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.end(),<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin());
<a name="l00162"></a>00162         <span class="keywordflow">return</span> ret;
<a name="l00163"></a>00163 }<span class="comment"></span>
<a name="l00164"></a>00164 <span class="comment">/**</span>
<a name="l00165"></a>00165 <span class="comment">* @brief Set the centers of clusters assuming upto three clusters in total</span>
<a name="l00166"></a>00166 <span class="comment">* @param c1 - center for the first cluster</span>
<a name="l00167"></a>00167 <span class="comment">* @param c2 - center for the second cluster</span>
<a name="l00168"></a>00168 <span class="comment">* @param c3 - center for the third cluster</span>
<a name="l00169"></a>00169 <span class="comment">* @param c[] - array of centers of all clusters</span>
<a name="l00170"></a>00170 <span class="comment">* @param c - vector of centers of all clusters</span>
<a name="l00171"></a>00171 <span class="comment">*/</span>
<a name="l00172"></a><a class="code" href="classCEMSeed.html#a1d85b2d7578a68250caa978a06bf65fc">00172</a> <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#a1d85b2d7578a68250caa978a06bf65fc" title="Set the centers of clusters assuming upto three clusters in total.">CEMSeed::setMu</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> c[], <span class="keyword">const</span> <span class="keywordtype">int</span> size)
<a name="l00173"></a>00173 {
<a name="l00174"></a>00174         <a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.resize(size);
<a name="l00175"></a>00175         copy(c,&amp;c[size],<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin());
<a name="l00176"></a>00176 }
<a name="l00177"></a>00177 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#a1d85b2d7578a68250caa978a06bf65fc" title="Set the centers of clusters assuming upto three clusters in total.">CEMSeed::setMu</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> c1, <span class="keyword">const</span> <span class="keywordtype">double</span> c2,<span class="keyword">const</span> <span class="keywordtype">double</span> c3)
<a name="l00178"></a>00178 {
<a name="l00179"></a>00179         <a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.resize(3);
<a name="l00180"></a>00180         <a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0] = c1;
<a name="l00181"></a>00181         <a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1] = c2;
<a name="l00182"></a>00182         <a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2] = c3;
<a name="l00183"></a>00183 }
<a name="l00184"></a>00184 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#a1d85b2d7578a68250caa978a06bf65fc" title="Set the centers of clusters assuming upto three clusters in total.">CEMSeed::setMu</a>(std::vector&lt;double&gt;&amp; c)
<a name="l00185"></a>00185 {
<a name="l00186"></a>00186         <a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.resize(c.size());
<a name="l00187"></a>00187         copy(c.begin(),c.end(),<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin());
<a name="l00188"></a>00188 }<span class="comment"></span>
<a name="l00189"></a>00189 <span class="comment">/**</span>
<a name="l00190"></a>00190 <span class="comment">* @brief Set the minimum of centers of clusters assuming upto three clusters in total</span>
<a name="l00191"></a>00191 <span class="comment">* @param c1 - minimum of center for the first cluster</span>
<a name="l00192"></a>00192 <span class="comment">* @param c2 - minimum of center for the second cluster</span>
<a name="l00193"></a>00193 <span class="comment">* @param c3 - minimum of center for the third cluster</span>
<a name="l00194"></a>00194 <span class="comment">* @param c[] - array of minimum of centers for all clusters</span>
<a name="l00195"></a>00195 <span class="comment">* @param c - vector of minimum of centers of all clusters</span>
<a name="l00196"></a>00196 <span class="comment">*/</span>      
<a name="l00197"></a><a class="code" href="classCEMSeed.html#ab53cf92fa9b34fdae1394e5bb33b9498">00197</a> <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#ab53cf92fa9b34fdae1394e5bb33b9498" title="Set the minimum of centers of clusters assuming upto three clusters in total.">CEMSeed::setMinMu</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> c[], <span class="keyword">const</span> <span class="keywordtype">int</span> size)
<a name="l00198"></a>00198 {
<a name="l00199"></a>00199         <a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.resize(size);
<a name="l00200"></a>00200         copy(c,&amp;c[size],<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.begin());
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#ab53cf92fa9b34fdae1394e5bb33b9498" title="Set the minimum of centers of clusters assuming upto three clusters in total.">CEMSeed::setMinMu</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> c1,<span class="keyword">const</span> <span class="keywordtype">double</span> c2,<span class="keyword">const</span> <span class="keywordtype">double</span> c3)
<a name="l00203"></a>00203 {
<a name="l00204"></a>00204         <a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.resize(3);
<a name="l00205"></a>00205         <a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[0] = c1;
<a name="l00206"></a>00206         <a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[1] = c2;
<a name="l00207"></a>00207         <a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[2] = c3;
<a name="l00208"></a>00208 }
<a name="l00209"></a>00209 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#ab53cf92fa9b34fdae1394e5bb33b9498" title="Set the minimum of centers of clusters assuming upto three clusters in total.">CEMSeed::setMinMu</a>(std::vector&lt;double&gt;&amp; c)
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211         <a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.resize(c.size());
<a name="l00212"></a>00212         copy(c.begin(),c.end(),<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.begin());
<a name="l00213"></a>00213 }       <span class="comment"></span>
<a name="l00214"></a>00214 <span class="comment">/**</span>
<a name="l00215"></a>00215 <span class="comment">* @brief Set the maximum of centers of clusters assuming upto three clusters in total</span>
<a name="l00216"></a>00216 <span class="comment">* @param c1 - maximum of center for the first cluster</span>
<a name="l00217"></a>00217 <span class="comment">* @param c2 - maximum of center for the second cluster</span>
<a name="l00218"></a>00218 <span class="comment">* @param c3 - maximum of center for the third cluster</span>
<a name="l00219"></a>00219 <span class="comment">* @param c[] - array of maximum of centers for all clusters</span>
<a name="l00220"></a>00220 <span class="comment">* @param c - vector of maximum of centers of all clusters</span>
<a name="l00221"></a>00221 <span class="comment">*/</span>      
<a name="l00222"></a><a class="code" href="classCEMSeed.html#abf4e379c205f693d233e7e6154157a7f">00222</a> <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#abf4e379c205f693d233e7e6154157a7f" title="Set the maximum of centers of clusters assuming upto three clusters in total.">CEMSeed::setMaxMu</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> c[], <span class="keyword">const</span> <span class="keywordtype">int</span> size)
<a name="l00223"></a>00223 {
<a name="l00224"></a>00224         <a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.resize(size);
<a name="l00225"></a>00225         copy(c,&amp;c[size],<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin());
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#abf4e379c205f693d233e7e6154157a7f" title="Set the maximum of centers of clusters assuming upto three clusters in total.">CEMSeed::setMaxMu</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> c1,<span class="keyword">const</span> <span class="keywordtype">double</span> c2,<span class="keyword">const</span> <span class="keywordtype">double</span> c3)
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229         <a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.resize(3);
<a name="l00230"></a>00230         <a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[0] = c1;
<a name="l00231"></a>00231         <a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[1] = c2;
<a name="l00232"></a>00232         <a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[2] = c3;
<a name="l00233"></a>00233 }
<a name="l00234"></a>00234 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#abf4e379c205f693d233e7e6154157a7f" title="Set the maximum of centers of clusters assuming upto three clusters in total.">CEMSeed::setMaxMu</a>(std::vector&lt;double&gt;&amp; c)
<a name="l00235"></a>00235 {
<a name="l00236"></a>00236         <a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.resize(c.size());
<a name="l00237"></a>00237         copy(c.begin(),c.end(),<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin());
<a name="l00238"></a>00238 }       <span class="comment"></span>
<a name="l00239"></a>00239 <span class="comment">/**</span>
<a name="l00240"></a>00240 <span class="comment">* @brief Set the weight of clusters assuming upto three clusters in total</span>
<a name="l00241"></a>00241 <span class="comment">* @param w1 - weight for the first cluster</span>
<a name="l00242"></a>00242 <span class="comment">* @param w2 - weight of center for the second cluster</span>
<a name="l00243"></a>00243 <span class="comment">* @param w3 - weight of center for the third cluster</span>
<a name="l00244"></a>00244 <span class="comment">* @param w[] - array of weights for all clusters</span>
<a name="l00245"></a>00245 <span class="comment">* @param w - vector of weights  of all clusters</span>
<a name="l00246"></a>00246 <span class="comment">*/</span>      
<a name="l00247"></a><a class="code" href="classCEMSeed.html#ae014524f6c4329ca8b18364b316361c1">00247</a> <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#ae014524f6c4329ca8b18364b316361c1" title="Set the weight of clusters assuming upto three clusters in total.">CEMSeed::setWeight</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> w[], <span class="keyword">const</span> <span class="keywordtype">int</span> size)
<a name="l00248"></a>00248 {
<a name="l00249"></a>00249         <a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.resize(size);
<a name="l00250"></a>00250         copy(w,&amp;w[size],<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.begin());
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#ae014524f6c4329ca8b18364b316361c1" title="Set the weight of clusters assuming upto three clusters in total.">CEMSeed::setWeight</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> w1,<span class="keyword">const</span> <span class="keywordtype">double</span> w2,<span class="keyword">const</span> <span class="keywordtype">double</span> w3)
<a name="l00253"></a>00253 {
<a name="l00254"></a>00254         <a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.resize(3);
<a name="l00255"></a>00255         <a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[0] = w1;
<a name="l00256"></a>00256         <a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[1] = w2;
<a name="l00257"></a>00257         <a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[2] = w3;
<a name="l00258"></a>00258 }
<a name="l00259"></a>00259 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#ae014524f6c4329ca8b18364b316361c1" title="Set the weight of clusters assuming upto three clusters in total.">CEMSeed::setWeight</a>(std::vector&lt;double&gt;&amp; w)
<a name="l00260"></a>00260 {
<a name="l00261"></a>00261         <a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.resize(w.size());
<a name="l00262"></a>00262         copy(w.begin(),w.end(),<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.begin());
<a name="l00263"></a>00263 }               <span class="comment"></span>
<a name="l00264"></a>00264 <span class="comment">/**</span>
<a name="l00265"></a>00265 <span class="comment">* @brief Set the sigmas of clusters assuming upto three clusters in total</span>
<a name="l00266"></a>00266 <span class="comment">* @param s1 - sigma for the first cluster</span>
<a name="l00267"></a>00267 <span class="comment">* @param s2 - sigma for the second cluster</span>
<a name="l00268"></a>00268 <span class="comment">* @param s3 - sigma for the third cluster</span>
<a name="l00269"></a>00269 <span class="comment">* @param s[] - array of sigmas for all clusters</span>
<a name="l00270"></a>00270 <span class="comment">* @param s - vector of sigmas of all clusters</span>
<a name="l00271"></a>00271 <span class="comment">*/</span>              
<a name="l00272"></a><a class="code" href="classCEMSeed.html#af7f9a507dcdfb399eab17dec2650bad0">00272</a> <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#af7f9a507dcdfb399eab17dec2650bad0" title="Set the sigmas of clusters assuming upto three clusters in total.">CEMSeed::setSigma</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> s[], <span class="keyword">const</span> <span class="keywordtype">int</span> size)
<a name="l00273"></a>00273 {
<a name="l00274"></a>00274         <a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.resize(size);
<a name="l00275"></a>00275         copy(s,&amp;s[size],<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin());
<a name="l00276"></a>00276 }
<a name="l00277"></a>00277 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#af7f9a507dcdfb399eab17dec2650bad0" title="Set the sigmas of clusters assuming upto three clusters in total.">CEMSeed::setSigma</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> s1,<span class="keyword">const</span> <span class="keywordtype">double</span> s2,<span class="keyword">const</span> <span class="keywordtype">double</span> s3)
<a name="l00278"></a>00278 {
<a name="l00279"></a>00279         <a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.resize(3);
<a name="l00280"></a>00280         <a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[0] = s1;
<a name="l00281"></a>00281         <a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[1] = s2;
<a name="l00282"></a>00282         <a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[2] = s3;
<a name="l00283"></a>00283 }
<a name="l00284"></a>00284 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#af7f9a507dcdfb399eab17dec2650bad0" title="Set the sigmas of clusters assuming upto three clusters in total.">CEMSeed::setSigma</a>(std::vector&lt;double&gt;&amp; s)
<a name="l00285"></a>00285 {
<a name="l00286"></a>00286         <a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.resize(s.size());
<a name="l00287"></a>00287         copy(s.begin(),s.end(),<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin());
<a name="l00288"></a>00288 }               <span class="comment"></span>
<a name="l00289"></a>00289 <span class="comment">/**</span>
<a name="l00290"></a>00290 <span class="comment">* @brief Set the minimum of sigmas of clusters assuming upto three clusters in total</span>
<a name="l00291"></a>00291 <span class="comment">* @param s1 - minimum of sigma for the first cluster</span>
<a name="l00292"></a>00292 <span class="comment">* @param s2 - minimum of sigma for the second cluster</span>
<a name="l00293"></a>00293 <span class="comment">* @param s3 - minimum of sigma for the third cluster</span>
<a name="l00294"></a>00294 <span class="comment">* @param s[] - array of minimum sigmas for all clusters</span>
<a name="l00295"></a>00295 <span class="comment">* @param s - vector of minimum sigmas of all clusters</span>
<a name="l00296"></a>00296 <span class="comment">*/</span>              
<a name="l00297"></a><a class="code" href="classCEMSeed.html#abb9d2912972d1c6ca13b40a91793a74c">00297</a> <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#abb9d2912972d1c6ca13b40a91793a74c" title="Set the minimum of sigmas of clusters assuming upto three clusters in total.">CEMSeed::setMinSigma</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> s[], <span class="keyword">const</span> <span class="keywordtype">int</span> size)
<a name="l00298"></a>00298 {
<a name="l00299"></a>00299         <a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.resize(size);
<a name="l00300"></a>00300         copy(s,&amp;s[size],<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin());
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#abb9d2912972d1c6ca13b40a91793a74c" title="Set the minimum of sigmas of clusters assuming upto three clusters in total.">CEMSeed::setMinSigma</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> s1,<span class="keyword">const</span> <span class="keywordtype">double</span> s2,<span class="keyword">const</span> <span class="keywordtype">double</span> s3)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304         <a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.resize(3);
<a name="l00305"></a>00305         <a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>[0] = s1;
<a name="l00306"></a>00306         <a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>[1] = s2;
<a name="l00307"></a>00307         <a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>[2] = s3;
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#abb9d2912972d1c6ca13b40a91793a74c" title="Set the minimum of sigmas of clusters assuming upto three clusters in total.">CEMSeed::setMinSigma</a>(std::vector&lt;double&gt;&amp; s)
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311         <a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.resize(s.size());
<a name="l00312"></a>00312         copy(s.begin(),s.end(),<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin());
<a name="l00313"></a>00313 }               <span class="comment"></span>
<a name="l00314"></a>00314 <span class="comment">/**</span>
<a name="l00315"></a>00315 <span class="comment">* @brief Set the maximum of sigmas of clusters assuming upto three clusters in total</span>
<a name="l00316"></a>00316 <span class="comment">* @param s1 - maximum of sigma for the first cluster</span>
<a name="l00317"></a>00317 <span class="comment">* @param s2 - maximum of sigma for the second cluster</span>
<a name="l00318"></a>00318 <span class="comment">* @param s3 - maximum of sigma for the third cluster</span>
<a name="l00319"></a>00319 <span class="comment">* @param s[] - array of maximum sigmas for all clusters</span>
<a name="l00320"></a>00320 <span class="comment">* @param s - vector of maximum sigmas of all clusters</span>
<a name="l00321"></a>00321 <span class="comment">*/</span>      
<a name="l00322"></a><a class="code" href="classCEMSeed.html#a7507e7757be1c92ce717ed86ec1c2aa2">00322</a> <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#a7507e7757be1c92ce717ed86ec1c2aa2" title="Set the maximum of sigmas of clusters assuming upto three clusters in total.">CEMSeed::setMaxSigma</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> s[], <span class="keyword">const</span> <span class="keywordtype">int</span> size)
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324         <a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.resize(size);
<a name="l00325"></a>00325         copy(s,&amp;s[size],<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin());
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#a7507e7757be1c92ce717ed86ec1c2aa2" title="Set the maximum of sigmas of clusters assuming upto three clusters in total.">CEMSeed::setMaxSigma</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> s1,<span class="keyword">const</span> <span class="keywordtype">double</span> s2,<span class="keyword">const</span> <span class="keywordtype">double</span> s3)
<a name="l00328"></a>00328 {
<a name="l00329"></a>00329         <a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.resize(3);
<a name="l00330"></a>00330         <a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>[0] = s1;
<a name="l00331"></a>00331         <a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>[1] = s2;
<a name="l00332"></a>00332         <a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>[2] = s3;
<a name="l00333"></a>00333 }
<a name="l00334"></a>00334 <span class="keywordtype">void</span> <a class="code" href="classCEMSeed.html#a7507e7757be1c92ce717ed86ec1c2aa2" title="Set the maximum of sigmas of clusters assuming upto three clusters in total.">CEMSeed::setMaxSigma</a>(std::vector&lt;double&gt;&amp; s)
<a name="l00335"></a>00335 {
<a name="l00336"></a>00336         <a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.resize(s.size());
<a name="l00337"></a>00337         copy(s.begin(),s.end(),<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin());
<a name="l00338"></a>00338 }               
<a name="l00339"></a>00339 <span class="comment"></span>
<a name="l00340"></a>00340 <span class="comment">/**</span>
<a name="l00341"></a>00341 <span class="comment">* @brief, the default constructor</span>
<a name="l00342"></a>00342 <span class="comment">* @param clusters - number of clusters to cluster data into </span>
<a name="l00343"></a>00343 <span class="comment">*/</span>
<a name="l00344"></a><a class="code" href="classCEMEst.html#a902f388d792f5c5c1e89d74e4396c754">00344</a> <a class="code" href="classCEMEst.html#a902f388d792f5c5c1e89d74e4396c754" title=", the default constructor">CEMEst::CEMEst</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> clusters) 
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346         <a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>.resize(clusters);
<a name="l00347"></a>00347         <a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>.resize(clusters);
<a name="l00348"></a>00348         <a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>.resize(clusters);
<a name="l00349"></a>00349         <a class="code" href="classCEMEst.html#acb7ecf1e0503d1e36cee16c83baa9dfe" title="minimum of cluster centers">m_minMu</a>.resize(clusters);
<a name="l00350"></a>00350         <a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>.resize(clusters);
<a name="l00351"></a>00351         <a class="code" href="classCEMEst.html#a8d374f17bae7bf97d75823b069501781" title="maximums of cluster centers">m_maxMu</a>.resize(clusters);
<a name="l00352"></a>00352         <a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>.resize(clusters);
<a name="l00353"></a>00353         <a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.resize(clusters);
<a name="l00354"></a>00354         <a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> = -1;
<a name="l00355"></a>00355         <a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> = NA;
<a name="l00356"></a>00356         <a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = NA;
<a name="l00357"></a>00357         <a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a> = NA;
<a name="l00358"></a>00358 }<span class="comment"></span>
<a name="l00359"></a>00359 <span class="comment">/**</span>
<a name="l00360"></a>00360 <span class="comment">* @brief set the number of cluters</span>
<a name="l00361"></a>00361 <span class="comment">* @param clusters - number of clusters to cluster data into</span>
<a name="l00362"></a>00362 <span class="comment">*/</span>
<a name="l00363"></a><a class="code" href="classCEMEst.html#aa753c14df6fa982320b886b20cbe299f">00363</a> <span class="keywordtype">void</span> <a class="code" href="classCEMEst.html#aa753c14df6fa982320b886b20cbe299f" title="set the number of cluters">CEMEst::set</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> clusters) 
<a name="l00364"></a>00364 {
<a name="l00365"></a>00365         <a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>.resize(clusters);
<a name="l00366"></a>00366         <a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>.resize(clusters);
<a name="l00367"></a>00367         <a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>.resize(clusters);
<a name="l00368"></a>00368         <a class="code" href="classCEMEst.html#acb7ecf1e0503d1e36cee16c83baa9dfe" title="minimum of cluster centers">m_minMu</a>.resize(clusters);
<a name="l00369"></a>00369         <a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>.resize(clusters);
<a name="l00370"></a>00370         <a class="code" href="classCEMEst.html#a8d374f17bae7bf97d75823b069501781" title="maximums of cluster centers">m_maxMu</a>.resize(clusters);
<a name="l00371"></a>00371         <a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>.resize(clusters);
<a name="l00372"></a>00372         <a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.resize(clusters);
<a name="l00373"></a>00373         <a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> = -1;
<a name="l00374"></a>00374         <a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> = NA;
<a name="l00375"></a>00375         <a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = NA;
<a name="l00376"></a>00376         <a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a> = NA;
<a name="l00377"></a>00377 }<span class="comment"></span>
<a name="l00378"></a>00378 <span class="comment">/**</span>
<a name="l00379"></a>00379 <span class="comment">* @brief assignment operator</span>
<a name="l00380"></a>00380 <span class="comment">*/</span>
<a name="l00381"></a><a class="code" href="classCEMEst.html#ac69a084ae72e53043b21f45771cfdc2a">00381</a> <a class="code" href="classCEMEst.html" title="Object to hold all EM posterior information including some classification quality stats...">CEMEst</a>&amp; <a class="code" href="classCEMEst.html#ac69a084ae72e53043b21f45771cfdc2a" title="assignment operator">CEMEst::operator = </a>(<span class="keyword">const</span> <a class="code" href="classCEMEst.html" title="Object to hold all EM posterior information including some classification quality stats...">CEMEst</a>&amp; rhs)
<a name="l00382"></a>00382 {
<a name="l00383"></a>00383         copy(rhs.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>.begin(),rhs.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>.end(),<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>.begin());
<a name="l00384"></a>00384         copy(rhs.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>.begin(),rhs.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>.end(),<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>.begin());
<a name="l00385"></a>00385         copy(rhs.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>.begin(),rhs.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>.end(),<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>.begin());
<a name="l00386"></a>00386         copy(rhs.<a class="code" href="classCEMEst.html#acb7ecf1e0503d1e36cee16c83baa9dfe" title="minimum of cluster centers">m_minMu</a>.begin(),rhs.<a class="code" href="classCEMEst.html#acb7ecf1e0503d1e36cee16c83baa9dfe" title="minimum of cluster centers">m_minMu</a>.end(),<a class="code" href="classCEMEst.html#acb7ecf1e0503d1e36cee16c83baa9dfe" title="minimum of cluster centers">m_minMu</a>.begin());
<a name="l00387"></a>00387         copy(rhs.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>.begin(),rhs.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>.end(),<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>.begin());
<a name="l00388"></a>00388         copy(rhs.<a class="code" href="classCEMEst.html#a8d374f17bae7bf97d75823b069501781" title="maximums of cluster centers">m_maxMu</a>.begin(),rhs.<a class="code" href="classCEMEst.html#a8d374f17bae7bf97d75823b069501781" title="maximums of cluster centers">m_maxMu</a>.end(),<a class="code" href="classCEMEst.html#a8d374f17bae7bf97d75823b069501781" title="maximums of cluster centers">m_maxMu</a>.begin());
<a name="l00389"></a>00389         copy(rhs.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>.begin(),rhs.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>.end(),<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>.begin());
<a name="l00390"></a>00390         copy(rhs.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.begin(),rhs.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.end(),<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.begin());
<a name="l00391"></a>00391         copy(rhs.<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>.begin(),rhs.<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>.end(),<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>.begin());
<a name="l00392"></a>00392         copy(rhs.<a class="code" href="classCEMEst.html#a42a0ef680a299eec700fa75de7b7838c" title="probability to best fit cluster">m_prob</a>.begin(),rhs.<a class="code" href="classCEMEst.html#a42a0ef680a299eec700fa75de7b7838c" title="probability to best fit cluster">m_prob</a>.end(),<a class="code" href="classCEMEst.html#a42a0ef680a299eec700fa75de7b7838c" title="probability to best fit cluster">m_prob</a>.begin());
<a name="l00393"></a>00393         copy(rhs.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>.begin(),rhs.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>.end(),<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>.begin());
<a name="l00394"></a>00394         copy(rhs.<a class="code" href="classCEMEst.html#a363c1447d42238bd73c6a6cbcad34027" title="genotype confidence">m_confidence</a>.begin(),rhs.<a class="code" href="classCEMEst.html#a363c1447d42238bd73c6a6cbcad34027" title="genotype confidence">m_confidence</a>.end(),<a class="code" href="classCEMEst.html#a363c1447d42238bd73c6a6cbcad34027" title="genotype confidence">m_confidence</a>.begin());
<a name="l00395"></a>00395         <a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> = rhs.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a>;
<a name="l00396"></a>00396         <a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> = rhs.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a>;
<a name="l00397"></a>00397         <a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = rhs.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a>;
<a name="l00398"></a>00398         <a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a> = rhs.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a>;
<a name="l00399"></a>00399 
<a name="l00400"></a>00400         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00401"></a>00401 }<span class="comment"></span>
<a name="l00402"></a>00402 <span class="comment">/**</span>
<a name="l00403"></a>00403 <span class="comment">* @brief reset the buffer size for posterior information</span>
<a name="l00404"></a>00404 <span class="comment">* @param dim - dimension of the data to be classified</span>
<a name="l00405"></a>00405 <span class="comment">*/</span>
<a name="l00406"></a><a class="code" href="classCEMEst.html#add0f7db7485d6fa2e1f915a86a8ddaf3">00406</a> <span class="keywordtype">void</span> <a class="code" href="classCEMEst.html#add0f7db7485d6fa2e1f915a86a8ddaf3" title="reset the buffer size for posterior information">CEMEst::reset</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> dim)
<a name="l00407"></a>00407 {
<a name="l00408"></a>00408         <a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>.resize(dim);
<a name="l00409"></a>00409         <a class="code" href="classCEMEst.html#a363c1447d42238bd73c6a6cbcad34027" title="genotype confidence">m_confidence</a>.resize(dim);
<a name="l00410"></a>00410         <a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>.resize(dim);
<a name="l00411"></a>00411         <a class="code" href="classCEMEst.html#a42a0ef680a299eec700fa75de7b7838c" title="probability to best fit cluster">m_prob</a>.resize(dim);
<a name="l00412"></a>00412 }<span class="comment"></span>
<a name="l00413"></a>00413 <span class="comment">/**</span>
<a name="l00414"></a>00414 <span class="comment">* @brief defualt constructor</span>
<a name="l00415"></a>00415 <span class="comment">* @param clusters - number of clusters</span>
<a name="l00416"></a>00416 <span class="comment">*/</span>
<a name="l00417"></a><a class="code" href="classCEMParam.html#a1c7a55b0877ab18538c4d8e78e36c683">00417</a> <a class="code" href="classCEMParam.html#a1c7a55b0877ab18538c4d8e78e36c683" title="defualt constructor">CEMParam::CEMParam</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> clusters) 
<a name="l00418"></a>00418 {
<a name="l00419"></a>00419         <a class="code" href="classCEMParam.html#a9967215588cc8f2e00d2ebcdb307860d" title="tolerance for insignificant change for convergence">m_fTolerance</a> = 0.001f;
<a name="l00420"></a>00420         <a class="code" href="classCEMParam.html#a43fb61cb784b05036840a5d81a423ba9" title="maximum number of iterations">m_nMaxIter</a> = 50;
<a name="l00421"></a>00421         <a class="code" href="classCEMParam.html#aff0fe9e1cf4d2e469361d8b1b6d35362" title="factor to balance the weights in confidence of probability and loglikelihood ratio">m_factor</a> = 0.01f;
<a name="l00422"></a>00422         <a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a> = clusters;
<a name="l00423"></a>00423         <a class="code" href="classCEMParam.html#a1c13153fc8914df15821160bde8e2487" title="the loss function to be used for EM evaluation">m_lossFunction</a> = BIC_SEP;
<a name="l00424"></a>00424         <a class="code" href="classCEMParam.html#a95e7e89bbc1092167ef668f7d1199404" title="to where we place the non-Gaussian tail">m_tailCut</a> = 2.5f;
<a name="l00425"></a>00425         <a class="code" href="classCEMParam.html#ad5b5883d1e202673651bb1fdb8804bf7" title="flag to indicate weight is used or not">m_useWeight</a> = <span class="keyword">false</span>;
<a name="l00426"></a>00426         <a class="code" href="classCEMParam.html#a62b805c815a20632a64ba9dfc814d10e" title="the threshold on EM&amp;#39;s confidence">m_threshold</a> = 0.05f;
<a name="l00427"></a>00427         <a class="code" href="classCEMParam.html#a41d41907eb3751656b0316c2e653108d" title="the threshold to drop a cluster if total number of data points is less">m_clusterDropThres</a> = 0.8f;
<a name="l00428"></a>00428         <a class="code" href="classCEMParam.html#ac74aaa6eadd0a9a1396bfbe8b14588f1" title="parameter used for seed generation">m_delta</a> = 0.003f;
<a name="l00429"></a>00429         <a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a> = 0.005f;
<a name="l00430"></a>00430         <a class="code" href="classCEMParam.html#af2c3a0ba35bb9a71aeeb4e985547d940" title="factor for hom cluster variance shrinkage">m_HomReductionCoef</a> = 2.0f;
<a name="l00431"></a>00431         <a class="code" href="classCEMParam.html#a729804d595f96e14d3f05ab951772ac7" title="factor for het cluster variance shrinkage">m_HetReductionCoef</a> = 1.2f;
<a name="l00432"></a>00432         <a class="code" href="classCEMParam.html#a324652dcf06328136b2fafff51a660e0" title="factor for both hom and het cluster variance shrinkage">m_SigmaPower</a> = 0.8f;
<a name="l00433"></a>00433         m_geo_ratio_multiplier.push_back(2.5f);
<a name="l00434"></a>00434         m_geo_ratio_multiplier.push_back(3.0f);
<a name="l00435"></a>00435         m_geo_ratio_multiplier.push_back(2.5f);
<a name="l00436"></a>00436         m_geo_ratio_divisor.push_back(2.5f);
<a name="l00437"></a>00437         m_geo_ratio_divisor.push_back(2.0f);
<a name="l00438"></a>00438         m_geo_ratio_divisor.push_back(2.5f);
<a name="l00439"></a>00439 }<span class="comment"></span>
<a name="l00440"></a>00440 <span class="comment">/**</span>
<a name="l00441"></a>00441 <span class="comment">* @brief assignment operator</span>
<a name="l00442"></a>00442 <span class="comment">*/</span>
<a name="l00443"></a><a class="code" href="classCEMParam.html#abfd706833b2cdf2044a3bf0888a109c6">00443</a> <a class="code" href="classCEMParam.html" title="Object to hold all EM parameters.">CEMParam</a>&amp; <a class="code" href="classCEMParam.html#abfd706833b2cdf2044a3bf0888a109c6" title="assignment operator">CEMParam::operator = </a>(<span class="keyword">const</span> <a class="code" href="classCEMParam.html" title="Object to hold all EM parameters.">CEMParam</a>&amp; rhs)
<a name="l00444"></a>00444 {
<a name="l00445"></a>00445         <a class="code" href="classCEMParam.html#a43fb61cb784b05036840a5d81a423ba9" title="maximum number of iterations">m_nMaxIter</a> = rhs.<a class="code" href="classCEMParam.html#a43fb61cb784b05036840a5d81a423ba9" title="maximum number of iterations">m_nMaxIter</a>;
<a name="l00446"></a>00446         <a class="code" href="classCEMParam.html#aff0fe9e1cf4d2e469361d8b1b6d35362" title="factor to balance the weights in confidence of probability and loglikelihood ratio">m_factor</a> = rhs.<a class="code" href="classCEMParam.html#aff0fe9e1cf4d2e469361d8b1b6d35362" title="factor to balance the weights in confidence of probability and loglikelihood ratio">m_factor</a>;
<a name="l00447"></a>00447         <a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a> = rhs.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>;
<a name="l00448"></a>00448         <a class="code" href="classCEMParam.html#a1c13153fc8914df15821160bde8e2487" title="the loss function to be used for EM evaluation">m_lossFunction</a> = rhs.<a class="code" href="classCEMParam.html#a1c13153fc8914df15821160bde8e2487" title="the loss function to be used for EM evaluation">m_lossFunction</a>;
<a name="l00449"></a>00449         <a class="code" href="classCEMParam.html#a95e7e89bbc1092167ef668f7d1199404" title="to where we place the non-Gaussian tail">m_tailCut</a> = rhs.<a class="code" href="classCEMParam.html#a95e7e89bbc1092167ef668f7d1199404" title="to where we place the non-Gaussian tail">m_tailCut</a>;
<a name="l00450"></a>00450         <a class="code" href="classCEMParam.html#ad5b5883d1e202673651bb1fdb8804bf7" title="flag to indicate weight is used or not">m_useWeight</a> = rhs.<a class="code" href="classCEMParam.html#ad5b5883d1e202673651bb1fdb8804bf7" title="flag to indicate weight is used or not">m_useWeight</a>;
<a name="l00451"></a>00451         <a class="code" href="classCEMParam.html#a62b805c815a20632a64ba9dfc814d10e" title="the threshold on EM&amp;#39;s confidence">m_threshold</a> = rhs.<a class="code" href="classCEMParam.html#a62b805c815a20632a64ba9dfc814d10e" title="the threshold on EM&amp;#39;s confidence">m_threshold</a>;
<a name="l00452"></a>00452         <a class="code" href="classCEMParam.html#ac74aaa6eadd0a9a1396bfbe8b14588f1" title="parameter used for seed generation">m_delta</a> = rhs.<a class="code" href="classCEMParam.html#ac74aaa6eadd0a9a1396bfbe8b14588f1" title="parameter used for seed generation">m_delta</a>;
<a name="l00453"></a>00453         <a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a> = rhs.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l00454"></a>00454         <a class="code" href="classCEMParam.html#af2c3a0ba35bb9a71aeeb4e985547d940" title="factor for hom cluster variance shrinkage">m_HomReductionCoef</a> = rhs.<a class="code" href="classCEMParam.html#af2c3a0ba35bb9a71aeeb4e985547d940" title="factor for hom cluster variance shrinkage">m_HomReductionCoef</a>;
<a name="l00455"></a>00455         <a class="code" href="classCEMParam.html#a729804d595f96e14d3f05ab951772ac7" title="factor for het cluster variance shrinkage">m_HetReductionCoef</a> = rhs.<a class="code" href="classCEMParam.html#a729804d595f96e14d3f05ab951772ac7" title="factor for het cluster variance shrinkage">m_HetReductionCoef</a>;
<a name="l00456"></a>00456         m_geo_ratio_multiplier.resize(rhs.m_geo_ratio_multiplier.size());
<a name="l00457"></a>00457         m_geo_ratio_divisor.resize(rhs.m_geo_ratio_divisor.size());
<a name="l00458"></a>00458         copy(rhs.m_geo_ratio_multiplier.begin(),rhs.m_geo_ratio_multiplier.end(),m_geo_ratio_multiplier.begin());
<a name="l00459"></a>00459         copy(rhs.m_geo_ratio_divisor.begin(),rhs.m_geo_ratio_divisor.end(),m_geo_ratio_divisor.begin());
<a name="l00460"></a>00460         <a class="code" href="classCEMParam.html#a324652dcf06328136b2fafff51a660e0" title="factor for both hom and het cluster variance shrinkage">m_SigmaPower</a> = rhs.<a class="code" href="classCEMParam.html#a324652dcf06328136b2fafff51a660e0" title="factor for both hom and het cluster variance shrinkage">m_SigmaPower</a>;
<a name="l00461"></a>00461         <a class="code" href="classCEMParam.html#a41d41907eb3751656b0316c2e653108d" title="the threshold to drop a cluster if total number of data points is less">m_clusterDropThres</a> = rhs.<a class="code" href="classCEMParam.html#a41d41907eb3751656b0316c2e653108d" title="the threshold to drop a cluster if total number of data points is less">m_clusterDropThres</a>;
<a name="l00462"></a>00462         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00463"></a>00463 }<span class="comment"></span>
<a name="l00464"></a>00464 <span class="comment">/**</span>
<a name="l00465"></a>00465 <span class="comment">* @brief defualt constructor</span>
<a name="l00466"></a>00466 <span class="comment">* @param clusters - number of clusters</span>
<a name="l00467"></a>00467 <span class="comment">*/</span>
<a name="l00468"></a><a class="code" href="classCEMPrior.html#adca1bc792c9a6d7a5f96aeb80b555563">00468</a> <a class="code" href="classCEMPrior.html#adca1bc792c9a6d7a5f96aeb80b555563" title="defualt constructor">CEMPrior::CEMPrior</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> clusters) 
<a name="l00469"></a>00469 {
<a name="l00470"></a>00470         <a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.resize(clusters);
<a name="l00471"></a>00471         <a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.resize(clusters);
<a name="l00472"></a>00472         <a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.resize(clusters);
<a name="l00473"></a>00473         <a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.resize(clusters);
<a name="l00474"></a>00474         <a class="code" href="classCEMPrior.html#af4ac53fc432952067295399322071436" title="prior status">m_good</a> = <span class="keyword">false</span>; <span class="comment">// default to invalid</span>
<a name="l00475"></a>00475 }<span class="comment"></span>
<a name="l00476"></a>00476 <span class="comment">/**</span>
<a name="l00477"></a>00477 <span class="comment">* @brief initialize prior information with defaults if clusters=3</span>
<a name="l00478"></a>00478 <span class="comment">* @return void</span>
<a name="l00479"></a>00479 <span class="comment">*/</span>
<a name="l00480"></a><a class="code" href="classCEMPrior.html#a2530373e8b1e45ce86a091ca5ba5eb40">00480</a> <span class="keywordtype">void</span> <a class="code" href="classCEMPrior.html#a2530373e8b1e45ce86a091ca5ba5eb40" title="initialize prior information with defaults if clusters=3">CEMPrior::initialize</a>()
<a name="l00481"></a>00481 {
<a name="l00482"></a>00482         <span class="comment">// number of clusters has been set, if equal to 3 initialize the generic</span>
<a name="l00483"></a>00483         <span class="keywordflow">if</span>(<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.size() == 3)
<a name="l00484"></a>00484         {
<a name="l00485"></a>00485                 <span class="comment">// default prior</span>
<a name="l00486"></a>00486                 std::vector&lt;double&gt; x(3);
<a name="l00487"></a>00487                 <span class="comment">// the static default prior</span>
<a name="l00488"></a>00488                 <span class="keywordtype">double</span> c[] = {-0.66f,0,0.66f}; <span class="comment">// centers</span>
<a name="l00489"></a>00489                 copy(&amp;c[0], &amp;c[3],x.begin());
<a name="l00490"></a>00490                 <a class="code" href="classCEMPrior.html#ab38325e956716c9774a7c0679d31dcb5" title="function to set up the centers of clusters">setMu</a>(x);
<a name="l00491"></a>00491                 <span class="keywordtype">double</span> c_s[] = {0.125f,0.175f,0.125f}; <span class="comment">// stdev of centers</span>
<a name="l00492"></a>00492                 copy(&amp;c_s[0], &amp;c_s[3],x.begin());
<a name="l00493"></a>00493                 <a class="code" href="classCEMPrior.html#a74424b3822f341b670b25cbb4fb01295" title="function to set up the stdev of cluster centers">setMuSD</a>(x);
<a name="l00494"></a>00494                 <span class="keywordtype">double</span> s[] = {0.065f,0.085f,0.065f}; <span class="comment">// stdev</span>
<a name="l00495"></a>00495                 copy(&amp;s[0], &amp;s[3],x.begin());
<a name="l00496"></a>00496                 <a class="code" href="classCEMPrior.html#a04da432265d994651d22ad9e26213f95" title="function to set up the sigmas of clusters">setSigma</a>(x);
<a name="l00497"></a>00497                 <span class="keywordtype">double</span> s_s[] = {0.035f,0.015f,0.035f}; <span class="comment">// stdev of stdev</span>
<a name="l00498"></a>00498                 copy(&amp;s_s[0], &amp;s_s[3],x.begin());
<a name="l00499"></a>00499                 <a class="code" href="classCEMPrior.html#ae2be92a5fe3ba12dffd8f2dd210742af" title="function to set up the centers of clusters">setSigmaSD</a>(x);
<a name="l00500"></a>00500                 <a class="code" href="classCEMPrior.html#af4ac53fc432952067295399322071436" title="prior status">m_good</a> = <span class="keyword">true</span>;
<a name="l00501"></a>00501         }
<a name="l00502"></a>00502         <span class="keywordflow">else</span> 
<a name="l00503"></a>00503         {
<a name="l00504"></a>00504                 <a class="code" href="classCEMPrior.html#af4ac53fc432952067295399322071436" title="prior status">m_good</a> = <span class="keyword">false</span>; <span class="comment">// don&#39;t know how to set up defaults</span>
<a name="l00505"></a>00505         }
<a name="l00506"></a>00506 }
<a name="l00507"></a>00507 <span class="comment"></span>
<a name="l00508"></a>00508 <span class="comment">/**</span>
<a name="l00509"></a>00509 <span class="comment">* @brief set function to initialize buffers</span>
<a name="l00510"></a>00510 <span class="comment">* @param clusters - number of clusters</span>
<a name="l00511"></a>00511 <span class="comment">* @return void</span>
<a name="l00512"></a>00512 <span class="comment">*/</span>
<a name="l00513"></a><a class="code" href="classCEMPrior.html#a3d0d6cbce3b3e29fff215e66a8dcd6b6">00513</a> <span class="keywordtype">void</span> <a class="code" href="classCEMPrior.html#a3d0d6cbce3b3e29fff215e66a8dcd6b6" title="set function to initialize buffers">CEMPrior::set</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> clusters) 
<a name="l00514"></a>00514 {
<a name="l00515"></a>00515         <a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.resize(clusters);
<a name="l00516"></a>00516         <a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.resize(clusters);
<a name="l00517"></a>00517         <a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.resize(clusters);
<a name="l00518"></a>00518         <a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.resize(clusters);
<a name="l00519"></a>00519 }<span class="comment"></span>
<a name="l00520"></a>00520 <span class="comment">/**</span>
<a name="l00521"></a>00521 <span class="comment">* @brief assignment operator</span>
<a name="l00522"></a>00522 <span class="comment">*/</span>
<a name="l00523"></a><a class="code" href="classCEMPrior.html#a97a6bf69c2abc5e541af8d328aeb89a2">00523</a> <a class="code" href="classCEMPrior.html" title="Object to hold all EM prior information.">CEMPrior</a>&amp; <a class="code" href="classCEMPrior.html#a97a6bf69c2abc5e541af8d328aeb89a2" title="assignment operator">CEMPrior::operator = </a>(<span class="keyword">const</span> <a class="code" href="classCEMPrior.html" title="Object to hold all EM prior information.">CEMPrior</a>&amp; rhs)
<a name="l00524"></a>00524 {
<a name="l00525"></a>00525         <span class="keywordtype">int</span> clusters = rhs.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.size();
<a name="l00526"></a>00526         <a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.resize(clusters);
<a name="l00527"></a>00527         <a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.resize(clusters);
<a name="l00528"></a>00528         <a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.resize(clusters);
<a name="l00529"></a>00529         <a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.resize(clusters);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531         copy(rhs.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.begin(),rhs.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.end(),<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.begin());
<a name="l00532"></a>00532         copy(rhs.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.begin(),rhs.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.end(),<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.begin());
<a name="l00533"></a>00533         copy(rhs.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.begin(),rhs.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.end(),<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.begin());
<a name="l00534"></a>00534         copy(rhs.<a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.begin(),rhs.<a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.end(),<a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.begin());
<a name="l00535"></a>00535         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00536"></a>00536 }<span class="comment"></span>
<a name="l00537"></a>00537 <span class="comment">/**</span>
<a name="l00538"></a>00538 <span class="comment">* @brief function to set up the centers of clusters</span>
<a name="l00539"></a>00539 <span class="comment">* @param c - a vector to hold all centers of clusters</span>
<a name="l00540"></a>00540 <span class="comment">* @return void</span>
<a name="l00541"></a>00541 <span class="comment">*/</span>
<a name="l00542"></a><a class="code" href="classCEMPrior.html#ab38325e956716c9774a7c0679d31dcb5">00542</a> <span class="keywordtype">void</span> <a class="code" href="classCEMPrior.html#ab38325e956716c9774a7c0679d31dcb5" title="function to set up the centers of clusters">CEMPrior::setMu</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; c)
<a name="l00543"></a>00543 {
<a name="l00544"></a>00544         <a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.resize(c.size());
<a name="l00545"></a>00545         copy(c.begin(),c.end(),<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.begin());
<a name="l00546"></a>00546 }<span class="comment"></span>
<a name="l00547"></a>00547 <span class="comment">/**</span>
<a name="l00548"></a>00548 <span class="comment">* @brief function to set up the stdev of cluster centers</span>
<a name="l00549"></a>00549 <span class="comment">* @param c - a vector to hold all centers of clusters</span>
<a name="l00550"></a>00550 <span class="comment">* @return void</span>
<a name="l00551"></a>00551 <span class="comment">*/</span>
<a name="l00552"></a><a class="code" href="classCEMPrior.html#a74424b3822f341b670b25cbb4fb01295">00552</a> <span class="keywordtype">void</span> <a class="code" href="classCEMPrior.html#a74424b3822f341b670b25cbb4fb01295" title="function to set up the stdev of cluster centers">CEMPrior::setMuSD</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; c)
<a name="l00553"></a>00553 {
<a name="l00554"></a>00554         <a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.resize(c.size());
<a name="l00555"></a>00555         copy(c.begin(),c.end(),<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.begin());
<a name="l00556"></a>00556 }<span class="comment"></span>
<a name="l00557"></a>00557 <span class="comment">/**</span>
<a name="l00558"></a>00558 <span class="comment">* @brief function to set up the sigmas of clusters</span>
<a name="l00559"></a>00559 <span class="comment">* @param s - a vector to hold all of stdevs of clusters</span>
<a name="l00560"></a>00560 <span class="comment">* @return void</span>
<a name="l00561"></a>00561 <span class="comment">*/</span>
<a name="l00562"></a><a class="code" href="classCEMPrior.html#a04da432265d994651d22ad9e26213f95">00562</a> <span class="keywordtype">void</span> <a class="code" href="classCEMPrior.html#a04da432265d994651d22ad9e26213f95" title="function to set up the sigmas of clusters">CEMPrior::setSigma</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; s)
<a name="l00563"></a>00563 {
<a name="l00564"></a>00564         <a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.resize(s.size());
<a name="l00565"></a>00565         copy(s.begin(),s.end(),<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.begin());
<a name="l00566"></a>00566 }<span class="comment"></span>
<a name="l00567"></a>00567 <span class="comment">/**</span>
<a name="l00568"></a>00568 <span class="comment">* @brief function to set up the centers of clusters</span>
<a name="l00569"></a>00569 <span class="comment">* @param c - a vector to hold all stdevs of sigmas</span>
<a name="l00570"></a>00570 <span class="comment">* @return void</span>
<a name="l00571"></a>00571 <span class="comment">*/</span>
<a name="l00572"></a><a class="code" href="classCEMPrior.html#ae2be92a5fe3ba12dffd8f2dd210742af">00572</a> <span class="keywordtype">void</span> <a class="code" href="classCEMPrior.html#ae2be92a5fe3ba12dffd8f2dd210742af" title="function to set up the centers of clusters">CEMPrior::setSigmaSD</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; s)
<a name="l00573"></a>00573 {
<a name="l00574"></a>00574         <a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.resize(s.size());
<a name="l00575"></a>00575         copy(s.begin(),s.end(),<a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.begin());
<a name="l00576"></a>00576 }<span class="comment"></span>
<a name="l00577"></a>00577 <span class="comment">/**</span>
<a name="l00578"></a>00578 <span class="comment">* @brief default constructor</span>
<a name="l00579"></a>00579 <span class="comment">* @param clusters - number of clusters</span>
<a name="l00580"></a>00580 <span class="comment">*/</span>
<a name="l00581"></a><a class="code" href="classCPrimeEM.html#a8557b89d32a809468e4c7fed275cfbcd">00581</a> <a class="code" href="classCPrimeEM.html#a8557b89d32a809468e4c7fed275cfbcd" title="default constructor">CPrimeEM::CPrimeEM</a>() 
<a name="l00582"></a>00582 {
<a name="l00583"></a>00583         <a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a> = 0;
<a name="l00584"></a>00584         <a class="code" href="classCPrimeEM.html#a06e3381995e22ca5d3c08aabe240db6c" title="container of total probabilities">m_sumNP</a> = -1;
<a name="l00585"></a>00585         <a class="code" href="classCPrimeEM.html#a8e1e06c4f6018cbc5232b16d60774ddd" title="pointer to the current seed in use">m_pSeed</a> = 0;
<a name="l00586"></a>00586         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aa753c14df6fa982320b886b20cbe299f" title="set the number of cluters">set</a>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00587"></a>00587         <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a3d0d6cbce3b3e29fff215e66a8dcd6b6" title="set function to initialize buffers">set</a>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00588"></a>00588         <a class="code" href="classCPrimeEM.html#a74924b6e3ec91ff13d999cef4d4fed54" title="container of total cluster probabilities">m_clusterP</a>.resize(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00589"></a>00589         <a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>.resize(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00590"></a>00590         <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a2530373e8b1e45ce86a091ca5ba5eb40" title="initialize prior information with defaults if clusters=3">initialize</a>();
<a name="l00591"></a>00591 }<span class="comment"></span>
<a name="l00592"></a>00592 <span class="comment">/**</span>
<a name="l00593"></a>00593 <span class="comment">* @brief reset the data dimension</span>
<a name="l00594"></a>00594 <span class="comment">* @param dim - data dimenstion</span>
<a name="l00595"></a>00595 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l00596"></a>00596 <span class="comment">*/</span>
<a name="l00597"></a><a class="code" href="classCPrimeEM.html#a19d908bfc586e779b0548863b8d912a5">00597</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a19d908bfc586e779b0548863b8d912a5" title="reset the data dimension">CPrimeEM::reset</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> dim)
<a name="l00598"></a>00598 {
<a name="l00599"></a>00599         <span class="comment">// only reset if data dim changes</span>
<a name="l00600"></a>00600         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a> != dim)
<a name="l00601"></a>00601         {
<a name="l00602"></a>00602                 <a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a> = dim;
<a name="l00603"></a>00603                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#add0f7db7485d6fa2e1f915a86a8ddaf3" title="reset the buffer size for posterior information">reset</a>(dim);
<a name="l00604"></a>00604                 <a class="code" href="classCPrimeEM.html#aefd80259abe876018d3ed5794dca643e" title="best estimates so far">m_preEst</a>.<a class="code" href="classCEMEst.html#add0f7db7485d6fa2e1f915a86a8ddaf3" title="reset the buffer size for posterior information">reset</a>(dim);
<a name="l00605"></a>00605                 <a class="code" href="classCPrimeEM.html#a525588f1ff39c19af6eebb4a9022b265" title="container of probabilities">m_p</a>.resize(dim);
<a name="l00606"></a>00606                 <a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>.resize(dim);
<a name="l00607"></a>00607                 <a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>.resize(dim);
<a name="l00608"></a>00608                 <span class="keywordtype">int</span> i = 0;
<a name="l00609"></a>00609                 <span class="keywordflow">for</span>(i=0; i &lt; dim; i ++)
<a name="l00610"></a>00610                 {
<a name="l00611"></a>00611                         <a class="code" href="classCPrimeEM.html#a525588f1ff39c19af6eebb4a9022b265" title="container of probabilities">m_p</a>[i].resize(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00612"></a>00612                         <a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i].resize(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00613"></a>00613                 }
<a name="l00614"></a>00614                 <a class="code" href="classCPrimeEM.html#a518445ac011659b1326c283c8f2a5185" title="parameter to the scale of FLD penalty of a classification, calculated from m_nDim on the fly...">m_lamda</a> = sqrt((<span class="keywordtype">double</span>) dim);
<a name="l00615"></a>00615         }
<a name="l00616"></a>00616         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00617"></a>00617 }<span class="comment"></span>
<a name="l00618"></a>00618 <span class="comment">/**</span>
<a name="l00619"></a>00619 <span class="comment">* @brief check integrety of settings</span>
<a name="l00620"></a>00620 <span class="comment">* @return true if settings are valid and consistent, false otherwise</span>
<a name="l00621"></a>00621 <span class="comment">*/</span>
<a name="l00622"></a><a class="code" href="classCPrimeEM.html#abe47241876e79020c379bcc28bdeeaff">00622</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#abe47241876e79020c379bcc28bdeeaff" title="check integrety of settings">CPrimeEM::checkPrior</a>()
<a name="l00623"></a>00623 {
<a name="l00624"></a>00624         <span class="keywordtype">bool</span> status = (<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.size() == <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.size());
<a name="l00625"></a>00625         status &amp;= (<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.size() == <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.size());
<a name="l00626"></a>00626         status &amp;= (<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.size() == <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.size());
<a name="l00627"></a>00627         status &amp;= (<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.size() == <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00628"></a>00628         <span class="keywordflow">if</span>(status) <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a514843ae55956f83f1cf9b79dacb73b4" title="function to set the prior status, must set true with valid information to proceed if initialzie() not...">setStatus</a>(<span class="keyword">true</span>);
<a name="l00629"></a>00629         <span class="keywordflow">else</span> <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a514843ae55956f83f1cf9b79dacb73b4" title="function to set the prior status, must set true with valid information to proceed if initialzie() not...">setStatus</a>(<span class="keyword">false</span>);
<a name="l00630"></a>00630         <span class="keywordflow">return</span> status;
<a name="l00631"></a>00631 }<span class="comment"></span>
<a name="l00632"></a>00632 <span class="comment">/** </span>
<a name="l00633"></a>00633 <span class="comment">* @brief set EM parameters</span>
<a name="l00634"></a>00634 <span class="comment">* @param param - the parameters</span>
<a name="l00635"></a>00635 <span class="comment">* @return void</span>
<a name="l00636"></a>00636 <span class="comment">*/</span>
<a name="l00637"></a><a class="code" href="classCPrimeEM.html#a173a1a19f2ea9e3bb4cc7fef26212d5a">00637</a> <span class="keywordtype">void</span> <a class="code" href="classCPrimeEM.html#a173a1a19f2ea9e3bb4cc7fef26212d5a" title="set EM parameters">CPrimeEM::setParam</a>(<span class="keyword">const</span> <a class="code" href="classCEMParam.html" title="Object to hold all EM parameters.">CEMParam</a>&amp; param)
<a name="l00638"></a>00638 {
<a name="l00639"></a>00639         <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a> = param;
<a name="l00640"></a>00640         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aa753c14df6fa982320b886b20cbe299f" title="set the number of cluters">set</a>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00641"></a>00641         <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a3d0d6cbce3b3e29fff215e66a8dcd6b6" title="set function to initialize buffers">set</a>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00642"></a>00642         <a class="code" href="classCPrimeEM.html#a74924b6e3ec91ff13d999cef4d4fed54" title="container of total cluster probabilities">m_clusterP</a>.resize(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00643"></a>00643         <a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>.resize(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00644"></a>00644         <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a2530373e8b1e45ce86a091ca5ba5eb40" title="initialize prior information with defaults if clusters=3">initialize</a>();
<a name="l00645"></a>00645 }<span class="comment"></span>
<a name="l00646"></a>00646 <span class="comment">/**</span>
<a name="l00647"></a>00647 <span class="comment">* @brief set the data to be classified</span>
<a name="l00648"></a>00648 <span class="comment">* @param x - the data to be classified</span>
<a name="l00649"></a>00649 <span class="comment">* @return void</span>
<a name="l00650"></a>00650 <span class="comment">*/</span>
<a name="l00651"></a><a class="code" href="classCPrimeEM.html#ae6633a6897c30d1c94bbb9d284c4e672">00651</a> <span class="keywordtype">void</span> <a class="code" href="classCPrimeEM.html#ae6633a6897c30d1c94bbb9d284c4e672" title="set the data to be classified">CPrimeEM::setData</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; x) 
<a name="l00652"></a>00652 { 
<a name="l00653"></a>00653         <a class="code" href="classCPrimeEM.html#a19d908bfc586e779b0548863b8d912a5" title="reset the data dimension">reset</a>(x.size());
<a name="l00654"></a>00654         copy(x.begin(),x.end(),<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>.begin());
<a name="l00655"></a>00655 }<span class="comment"></span>
<a name="l00656"></a>00656 <span class="comment">/**</span>
<a name="l00657"></a>00657 <span class="comment">* Run EM for genotyping, first generate variable number of EM seeds</span>
<a name="l00658"></a>00658 <span class="comment">* based some prior information and the data to be classified, then</span>
<a name="l00659"></a>00659 <span class="comment">* use EM to get estimates starting from each seeds</span>
<a name="l00660"></a>00660 <span class="comment">* this function only works for three cluster cases as it is designed for </span>
<a name="l00661"></a>00661 <span class="comment">* genotyping only.</span>
<a name="l00662"></a>00662 <span class="comment">*</span>
<a name="l00663"></a>00663 <span class="comment">* @return true if there is no error, false otherwise</span>
<a name="l00664"></a>00664 <span class="comment">*/</span>
<a name="l00665"></a><a class="code" href="classCPrimeEM.html#a74730508ed7639a17df2121f45d59132">00665</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a74730508ed7639a17df2121f45d59132" title="The function to run EM for genotyping, function only works for three cluster cases.">CPrimeEM::goPrimeEM</a>()
<a name="l00666"></a>00666 {
<a name="l00667"></a>00667         <span class="comment">// check consistency</span>
<a name="l00668"></a>00668         <span class="keywordflow">if</span>(!<a class="code" href="classCPrimeEM.html#abe47241876e79020c379bcc28bdeeaff" title="check integrety of settings">checkPrior</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00669"></a>00669 
<a name="l00670"></a>00670         <span class="comment">// if we are here we need generate seeds first</span>
<a name="l00671"></a>00671         <span class="keywordflow">if</span>(!<a class="code" href="classCPrimeEM.html#afcaac33a699e66d524f5aa362bfd8fc7" title="generate variable number of EM seeds based on some prior information this function is designed specif...">generateEmpiricalEMSeeds</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673         <span class="keywordtype">size_t</span> nSeeds = <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.size();
<a name="l00674"></a>00674 <span class="comment">//      if(nSeeds == 1) return false;</span>
<a name="l00675"></a>00675         <span class="keywordflow">if</span>(nSeeds == 1)
<a name="l00676"></a>00676         {
<a name="l00677"></a>00677                 <span class="comment">// get EM estimates for this seed</span>
<a name="l00678"></a>00678                 <span class="keywordtype">bool</span> bret = <a class="code" href="classCPrimeEM.html#a9c2454ee67f79c7465be66233ac48994" title="the function to get EM&amp;#39;s estimate with a specific initial seed">EMEstimate</a>(<a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>[0]);
<a name="l00679"></a>00679                 accumulate(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.begin(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.end(),0);
<a name="l00680"></a>00680                 <span class="keywordflow">return</span> bret;
<a name="l00681"></a>00681         }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683         <span class="keywordtype">size_t</span> it = 0;
<a name="l00684"></a>00684         <a class="code" href="classCEMEst.html" title="Object to hold all EM posterior information including some classification quality stats...">CEMEst</a> bestEst;
<a name="l00685"></a>00685         bestEst.<a class="code" href="classCEMEst.html#aa753c14df6fa982320b886b20cbe299f" title="set the number of cluters">set</a>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l00686"></a>00686         bestEst.<a class="code" href="classCEMEst.html#add0f7db7485d6fa2e1f915a86a8ddaf3" title="reset the buffer size for posterior information">reset</a>(<a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>);
<a name="l00687"></a>00687         <span class="keywordflow">for</span>(it = 0; it &lt; nSeeds; it ++)
<a name="l00688"></a>00688         {
<a name="l00689"></a>00689                 <span class="comment">// get EM estimates for this seed</span>
<a name="l00690"></a>00690                 <a class="code" href="classCPrimeEM.html#a9c2454ee67f79c7465be66233ac48994" title="the function to get EM&amp;#39;s estimate with a specific initial seed">EMEstimate</a>(<a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>[it]);
<a name="l00691"></a>00691 
<a name="l00692"></a>00692                 <span class="comment">// evaluate estimates</span>
<a name="l00693"></a>00693                 <span class="keywordflow">if</span>(it == 0)
<a name="l00694"></a>00694                         bestEst = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>;
<a name="l00695"></a>00695                 <span class="keywordflow">else</span>
<a name="l00696"></a>00696                         <a class="code" href="classCPrimeEM.html#af8190fb2a69496599a457081e2c8bc33" title="compare the current estimates to the best by far">evaluateEstimates</a>(bestEst);
<a name="l00697"></a>00697         }
<a name="l00698"></a>00698 
<a name="l00699"></a>00699         <span class="comment">// let&#39;s keep the best</span>
<a name="l00700"></a>00700         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a> = bestEst;
<a name="l00701"></a>00701 
<a name="l00702"></a>00702         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00703"></a>00703 }
<a name="l00704"></a>00704 <span class="comment"></span>
<a name="l00705"></a>00705 <span class="comment">/** </span>
<a name="l00706"></a>00706 <span class="comment">* @brief Roll back to initial values for all estimates</span>
<a name="l00707"></a>00707 <span class="comment">* @param seed - the container with the initial values</span>
<a name="l00708"></a>00708 <span class="comment">* @return true is no error, false otherwise</span>
<a name="l00709"></a>00709 <span class="comment">*/</span>
<a name="l00710"></a><a class="code" href="classCPrimeEM.html#a1e18aa915354e600001ab02ad3b09044">00710</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a1e18aa915354e600001ab02ad3b09044" title="roll back to the initial values">CPrimeEM::useInitialEstimate</a>(<a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a>&amp; seed)
<a name="l00711"></a>00711 {
<a name="l00712"></a>00712         <span class="comment">// validate seed, modify if necessary</span>
<a name="l00713"></a>00713         <a class="code" href="classCPrimeEM.html#ae91c191658a3111b11048943f4888a17" title="validate and adjust seed according to constraints">validate</a>(seed);
<a name="l00714"></a>00714 
<a name="l00715"></a>00715         <span class="comment">// final updates</span>
<a name="l00716"></a>00716         <a class="code" href="classCPrimeEM.html#a20bcac316166891e42e276a79913f85c" title="the Expectation step of EM algorithm">doEstep</a>(<span class="keyword">true</span>);
<a name="l00717"></a>00717 
<a name="l00718"></a>00718         <span class="comment">// get optimal estimates</span>
<a name="l00719"></a>00719         <a class="code" href="classCPrimeEM.html#a00a609a5422409351a44053053c322c1" title="compute all posterior estimates">computeOptimalEstimates</a>();
<a name="l00720"></a>00720 
<a name="l00721"></a>00721         <span class="comment">// Fisher&#39;s discriminants based on EM posterior, only do this when three cluster is requested</span>
<a name="l00722"></a>00722         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> = NA, <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = NA;
<a name="l00723"></a>00723         <a class="code" href="classCPrimeEM.html#a2a42d54bccfe7b0c4c1e162a4d1e07b4" title="compute Fisher&amp;#39;s Linear discrimants only computed if clusters are 2 or three">computeFLD</a>();
<a name="l00724"></a>00724      
<a name="l00725"></a>00725         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00726"></a>00726 }
<a name="l00727"></a>00727 <span class="comment"></span>
<a name="l00728"></a>00728 <span class="comment">/**</span>
<a name="l00729"></a>00729 <span class="comment">* Start EM from the initial seed to get estimates for a given data set,</span>
<a name="l00730"></a>00730 <span class="comment">* all the posterior information will be calculated</span>
<a name="l00731"></a>00731 <span class="comment">*</span>
<a name="l00732"></a>00732 <span class="comment">* @param seed - the initial seed for EM to start with</span>
<a name="l00733"></a>00733 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l00734"></a>00734 <span class="comment">*/</span>
<a name="l00735"></a><a class="code" href="classCPrimeEM.html#a9c2454ee67f79c7465be66233ac48994">00735</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a9c2454ee67f79c7465be66233ac48994" title="the function to get EM&amp;#39;s estimate with a specific initial seed">CPrimeEM::EMEstimate</a>(<a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a>&amp; seed)
<a name="l00736"></a>00736 {
<a name="l00737"></a>00737         <span class="comment">// validate seed, modify if necessary</span>
<a name="l00738"></a>00738         <a class="code" href="classCPrimeEM.html#ae91c191658a3111b11048943f4888a17" title="validate and adjust seed according to constraints">validate</a>(seed);
<a name="l00739"></a>00739 
<a name="l00740"></a>00740         <span class="comment">// keep a global pointer of the current seed</span>
<a name="l00741"></a>00741         <a class="code" href="classCPrimeEM.html#a8e1e06c4f6018cbc5232b16d60774ddd" title="pointer to the current seed in use">m_pSeed</a> = &amp;seed;
<a name="l00742"></a>00742 
<a name="l00743"></a>00743         <span class="keywordtype">int</span> it = 0;
<a name="l00744"></a>00744         <span class="keywordflow">while</span>(it &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a43fb61cb784b05036840a5d81a423ba9" title="maximum number of iterations">m_nMaxIter</a>)
<a name="l00745"></a>00745         {
<a name="l00746"></a>00746                 <span class="comment">// E step</span>
<a name="l00747"></a>00747                 <a class="code" href="classCPrimeEM.html#a20bcac316166891e42e276a79913f85c" title="the Expectation step of EM algorithm">doEstep</a>();
<a name="l00748"></a>00748 
<a name="l00749"></a>00749                 <span class="comment">// M step</span>
<a name="l00750"></a>00750                 <a class="code" href="classCPrimeEM.html#ac6d621419894b3636d910d229aa94b80" title="the Maximization step of EM algorithm">doMstep</a>();
<a name="l00751"></a>00751 
<a name="l00752"></a>00752                 <span class="keywordflow">if</span>(!<a class="code" href="classCPrimeEM.html#a5f01ee11ebbc408a52ce66755eebcdae" title="check the convergence status">checkStatus</a>(it))
<a name="l00753"></a>00753                         <span class="keywordflow">break</span>;
<a name="l00754"></a>00754 
<a name="l00755"></a>00755                 <a class="code" href="classCPrimeEM.html#aefd80259abe876018d3ed5794dca643e" title="best estimates so far">m_preEst</a> = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>;
<a name="l00756"></a>00756                 it++;
<a name="l00757"></a>00757         }
<a name="l00758"></a>00758 
<a name="l00759"></a>00759         <span class="comment">// final updates</span>
<a name="l00760"></a>00760         <a class="code" href="classCPrimeEM.html#a20bcac316166891e42e276a79913f85c" title="the Expectation step of EM algorithm">doEstep</a>(<span class="keyword">true</span>);
<a name="l00761"></a>00761 
<a name="l00762"></a>00762         <span class="comment">// get optimal estimates</span>
<a name="l00763"></a>00763         <a class="code" href="classCPrimeEM.html#a00a609a5422409351a44053053c322c1" title="compute all posterior estimates">computeOptimalEstimates</a>();
<a name="l00764"></a>00764 
<a name="l00765"></a>00765         <span class="comment">// Fisher&#39;s discriminants based on EM posterior, only do this when three cluster is requested</span>
<a name="l00766"></a>00766         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> = NA, <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = NA;
<a name="l00767"></a>00767         <a class="code" href="classCPrimeEM.html#a2a42d54bccfe7b0c4c1e162a4d1e07b4" title="compute Fisher&amp;#39;s Linear discrimants only computed if clusters are 2 or three">computeFLD</a>();
<a name="l00768"></a>00768      
<a name="l00769"></a>00769         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 <span class="comment"></span>
<a name="l00772"></a>00772 <span class="comment">/**</span>
<a name="l00773"></a>00773 <span class="comment">* @brief the Expectation step of EM algorithm</span>
<a name="l00774"></a>00774 <span class="comment">* @param final - flag to indicate it&#39;s step to calculate posterior</span>
<a name="l00775"></a>00775 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l00776"></a>00776 <span class="comment">*/</span>
<a name="l00777"></a><a class="code" href="classCPrimeEM.html#a20bcac316166891e42e276a79913f85c">00777</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a20bcac316166891e42e276a79913f85c" title="the Expectation step of EM algorithm">CPrimeEM::doEstep</a>(<span class="keywordtype">bool</span> <span class="keyword">final</span>)
<a name="l00778"></a>00778 {
<a name="l00779"></a>00779         <span class="keywordtype">int</span> j =0, i = 0;
<a name="l00780"></a>00780         <span class="comment">// sum of normalized probabilities for each cluster over all samples</span>
<a name="l00781"></a>00781         vector&lt;double&gt; sum_p;
<a name="l00782"></a>00782         sum_p.resize(<a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>);
<a name="l00783"></a>00783         fill(sum_p.begin(),sum_p.end(),0.0f);
<a name="l00784"></a>00784         <span class="keywordtype">double</span> z = 0;
<a name="l00785"></a>00785 
<a name="l00786"></a>00786         <span class="comment">// calculating probabilities for each sample in each cluster// and sum up for each sample</span>
<a name="l00787"></a>00787         <span class="keywordflow">for</span>(j= 0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++) 
<a name="l00788"></a>00788         {
<a name="l00789"></a>00789                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j]) 
<a name="l00790"></a>00790                 {
<a name="l00791"></a>00791                         <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>; i ++) 
<a name="l00792"></a>00792                         {
<a name="l00793"></a>00793                                 z = fabs(<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j])/<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j];
<a name="l00794"></a>00794                                 <span class="keywordflow">if</span>(<span class="keyword">final</span> || z &lt; 50)
<a name="l00795"></a>00795                                 {
<a name="l00796"></a>00796                                         <a class="code" href="classCPrimeEM.html#a525588f1ff39c19af6eebb4a9022b265" title="container of probabilities">m_p</a>[i][j] = <a class="code" href="PrimeEM_8cpp.html#af67b6328c5c42d5555d800b9ac3419b2" title="Utility function to calculate probability from Gaussian distibution with an exponential tail given th...">calcProbability</a>(<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i],<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j],<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j],<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[j],<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a95e7e89bbc1092167ef668f7d1199404" title="to where we place the non-Gaussian tail">m_tailCut</a>,<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#ad5b5883d1e202673651bb1fdb8804bf7" title="flag to indicate weight is used or not">m_useWeight</a>);
<a name="l00797"></a>00797                                 }
<a name="l00798"></a>00798                                 <span class="keywordflow">else</span>
<a name="l00799"></a>00799                                 {
<a name="l00800"></a>00800                                    <a class="code" href="classCPrimeEM.html#a525588f1ff39c19af6eebb4a9022b265" title="container of probabilities">m_p</a>[i][j] = 0;
<a name="l00801"></a>00801                                 }
<a name="l00802"></a>00802                                 sum_p[i] = sum_p[i] + <a class="code" href="classCPrimeEM.html#a525588f1ff39c19af6eebb4a9022b265" title="container of probabilities">m_p</a>[i][j];
<a name="l00803"></a>00803                         }
<a name="l00804"></a>00804                 }
<a name="l00805"></a>00805         }
<a name="l00806"></a>00806 
<a name="l00807"></a>00807         <span class="comment">// normalize probabilities for each sample in each cluster// and sum up for each cluster</span>
<a name="l00808"></a>00808         <a class="code" href="classCPrimeEM.html#a06e3381995e22ca5d3c08aabe240db6c" title="container of total probabilities">m_sumNP</a> = 0;
<a name="l00809"></a>00809         fill(<a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>.begin(),<a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>.end(),0.0f);
<a name="l00810"></a>00810         <span class="keywordflow">for</span>(j=0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++) 
<a name="l00811"></a>00811         {
<a name="l00812"></a>00812                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j]) 
<a name="l00813"></a>00813                 {
<a name="l00814"></a>00814                         <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>; i ++) 
<a name="l00815"></a>00815                         {
<a name="l00816"></a>00816                                 <span class="keywordflow">if</span>(sum_p[i] &gt; 0) {
<a name="l00817"></a>00817                                         <a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][j] = <a class="code" href="classCPrimeEM.html#a525588f1ff39c19af6eebb4a9022b265" title="container of probabilities">m_p</a>[i][j]/sum_p[i];
<a name="l00818"></a>00818                                 }
<a name="l00819"></a>00819                                 <span class="keywordflow">else</span> 
<a name="l00820"></a>00820                                 {
<a name="l00821"></a>00821                                         <a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][j] = 0;
<a name="l00822"></a>00822                                 }
<a name="l00823"></a>00823                                 <a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>[j] = <a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>[j] + <a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][j];
<a name="l00824"></a>00824                         }
<a name="l00825"></a>00825                         <a class="code" href="classCPrimeEM.html#a06e3381995e22ca5d3c08aabe240db6c" title="container of total probabilities">m_sumNP</a> += <a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>[j];
<a name="l00826"></a>00826                 }
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828    
<a name="l00829"></a>00829     <span class="comment">// check if we need to drop any clusters</span>
<a name="l00830"></a>00830     <span class="keywordflow">if</span>(!<span class="keyword">final</span>) 
<a name="l00831"></a>00831         {
<a name="l00832"></a>00832                 <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++) 
<a name="l00833"></a>00833                 {
<a name="l00834"></a>00834                         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>[j] &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a41d41907eb3751656b0316c2e653108d" title="the threshold to drop a cluster if total number of data points is less">m_clusterDropThres</a>)
<a name="l00835"></a>00835                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j] = <span class="keyword">false</span>;
<a name="l00836"></a>00836                 }
<a name="l00837"></a>00837     }
<a name="l00838"></a>00838 
<a name="l00839"></a>00839         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00840"></a>00840 }<span class="comment"></span>
<a name="l00841"></a>00841 <span class="comment">/**</span>
<a name="l00842"></a>00842 <span class="comment">* @brief the Maximization step of EM algorithm</span>
<a name="l00843"></a>00843 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l00844"></a>00844 <span class="comment">*/</span>
<a name="l00845"></a><a class="code" href="classCPrimeEM.html#ac6d621419894b3636d910d229aa94b80">00845</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#ac6d621419894b3636d910d229aa94b80" title="the Maximization step of EM algorithm">CPrimeEM::doMstep</a>()
<a name="l00846"></a>00846 {
<a name="l00847"></a>00847         <span class="keywordtype">bool</span> bret = <span class="keyword">true</span>;
<a name="l00848"></a>00848         <span class="comment">// we have the Estep, now we are ready to update mu and sigma</span>
<a name="l00849"></a>00849         bret &amp;= <a class="code" href="classCPrimeEM.html#a2b61a397ea3979a65eb0f1f8e8b811f7" title="update cluster centers">updateMu</a>();
<a name="l00850"></a>00850 
<a name="l00851"></a>00851         <span class="comment">// adjust mu</span>
<a name="l00852"></a>00852         bret &amp;= <a class="code" href="classCPrimeEM.html#a09521746ac5e2de4329222a037c4888e" title="adjust cluster centers according to constraints">adjustMu</a>();
<a name="l00853"></a>00853 
<a name="l00854"></a>00854         <span class="comment">// update weights</span>
<a name="l00855"></a>00855         bret &amp;= <a class="code" href="classCPrimeEM.html#a07e6dfff27749cebe2052ed8739c9383" title="update cluster weights">updateWeight</a>();
<a name="l00856"></a>00856 
<a name="l00857"></a>00857         <span class="comment">// update sigmas</span>
<a name="l00858"></a>00858         bret &amp;= <a class="code" href="classCPrimeEM.html#a0fa34b8e45f99de75d4cebd5bac5bc47" title="update cluster variances">updateSigma</a>();
<a name="l00859"></a>00859 
<a name="l00860"></a>00860         <span class="comment">// adjust sigmas</span>
<a name="l00861"></a>00861         bret &amp;= <a class="code" href="classCPrimeEM.html#a5c1ee1ede02c39e70f32a930c7f9aca5" title="adjust cluster variances according to constraints">adjustSigma</a>();
<a name="l00862"></a>00862 
<a name="l00863"></a>00863         <span class="keywordflow">return</span> bret;
<a name="l00864"></a>00864 }<span class="comment"></span>
<a name="l00865"></a>00865 <span class="comment">/** </span>
<a name="l00866"></a>00866 <span class="comment">* @brief check the convergence status</span>
<a name="l00867"></a>00867 <span class="comment">* @param it - current iteration</span>
<a name="l00868"></a>00868 <span class="comment">* @return true if not converged, false otherwise</span>
<a name="l00869"></a>00869 <span class="comment">*/</span>
<a name="l00870"></a><a class="code" href="classCPrimeEM.html#a5f01ee11ebbc408a52ce66755eebcdae">00870</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a5f01ee11ebbc408a52ce66755eebcdae" title="check the convergence status">CPrimeEM::checkStatus</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> it)
<a name="l00871"></a>00871 {
<a name="l00872"></a>00872         <span class="keywordflow">if</span>(it == 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00873"></a>00873 
<a name="l00874"></a>00874         <span class="keywordtype">bool</span> changed = <span class="keyword">false</span>;
<a name="l00875"></a>00875 
<a name="l00876"></a>00876         <span class="comment">// check changes</span>
<a name="l00877"></a>00877         <span class="keywordtype">int</span> j = 0;
<a name="l00878"></a>00878         <span class="keywordflow">for</span>(j=0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++) 
<a name="l00879"></a>00879         {
<a name="l00880"></a>00880                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j]) 
<a name="l00881"></a>00881                 {
<a name="l00882"></a>00882                         <span class="keywordtype">double</span> w_diff = fabs(<a class="code" href="classCPrimeEM.html#aefd80259abe876018d3ed5794dca643e" title="best estimates so far">m_preEst</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[j] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[j]);
<a name="l00883"></a>00883                         <span class="keywordtype">double</span> m_diff = fabs(<a class="code" href="classCPrimeEM.html#aefd80259abe876018d3ed5794dca643e" title="best estimates so far">m_preEst</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j]);
<a name="l00884"></a>00884                         <span class="keywordtype">double</span> s_diff = fabs(<a class="code" href="classCPrimeEM.html#aefd80259abe876018d3ed5794dca643e" title="best estimates so far">m_preEst</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j]);
<a name="l00885"></a>00885                         <span class="keywordflow">if</span>(w_diff &gt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a9967215588cc8f2e00d2ebcdb307860d" title="tolerance for insignificant change for convergence">m_fTolerance</a> || m_diff &gt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a9967215588cc8f2e00d2ebcdb307860d" title="tolerance for insignificant change for convergence">m_fTolerance</a> || s_diff &gt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a9967215588cc8f2e00d2ebcdb307860d" title="tolerance for insignificant change for convergence">m_fTolerance</a>) 
<a name="l00886"></a>00886                         {
<a name="l00887"></a>00887                                 changed = <span class="keyword">true</span>;
<a name="l00888"></a>00888                                 <span class="keywordflow">break</span>;
<a name="l00889"></a>00889                         }
<a name="l00890"></a>00890                 }
<a name="l00891"></a>00891         }
<a name="l00892"></a>00892 
<a name="l00893"></a>00893         <span class="keywordflow">return</span> changed;
<a name="l00894"></a>00894 }<span class="comment"></span>
<a name="l00895"></a>00895 <span class="comment">/**</span>
<a name="l00896"></a>00896 <span class="comment">* @brief initialize the type and likelihood pair vector, assign likelihood to infinity</span>
<a name="l00897"></a>00897 <span class="comment">* @param typeLikelihoodPair - the type and likelihood pair vector to be initialized</span>
<a name="l00898"></a>00898 <span class="comment">* @return void</span>
<a name="l00899"></a>00899 <span class="comment">*/</span>
<a name="l00900"></a><a class="code" href="classCPrimeEM.html#a95185f539e435d9fe730cb4903251c95">00900</a> <span class="keywordtype">void</span> <a class="code" href="classCPrimeEM.html#a95185f539e435d9fe730cb4903251c95" title="initialize the type and likelihood pair vector, assign likelihood to infinity">CPrimeEM::initializeTypeLikelihoodPair</a>(std::vector&lt;std::pair&lt;double,int&gt; &gt;&amp; typeLikelihoodPair)
<a name="l00901"></a>00901 {
<a name="l00902"></a>00902         <span class="keywordtype">int</span> j = 0;
<a name="l00903"></a>00903         <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++)
<a name="l00904"></a>00904         {
<a name="l00905"></a>00905                 typeLikelihoodPair[j].first = MAX_DOUBLE;
<a name="l00906"></a>00906                 typeLikelihoodPair[j].second = j;
<a name="l00907"></a>00907         }
<a name="l00908"></a>00908 }<span class="comment"></span>
<a name="l00909"></a>00909 <span class="comment">/**</span>
<a name="l00910"></a>00910 <span class="comment">* @brief assign likelihood to each cluster for data point i</span>
<a name="l00911"></a>00911 <span class="comment">* @param typeLikelihoodPair - the type and likelihood pair container</span>
<a name="l00912"></a>00912 <span class="comment">* @param i - data point index</span>
<a name="l00913"></a>00913 <span class="comment">* @return void</span>
<a name="l00914"></a>00914 <span class="comment">*/</span>
<a name="l00915"></a><a class="code" href="classCPrimeEM.html#ac7e98a76ba03038cd8fdc6a4bd82bed8">00915</a> <span class="keywordtype">void</span> <a class="code" href="classCPrimeEM.html#ac7e98a76ba03038cd8fdc6a4bd82bed8" title="assign likelihood to each cluster for data point i">CPrimeEM::assignLogLikelihood</a>(std::vector&lt;std::pair&lt;double,int&gt; &gt;&amp; typeLikelihoodPair, <span class="keyword">const</span> <span class="keywordtype">int</span> i)
<a name="l00916"></a>00916 {
<a name="l00917"></a>00917         <span class="keywordtype">int</span> j = 0;
<a name="l00918"></a>00918         <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++)
<a name="l00919"></a>00919         {
<a name="l00920"></a>00920                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j])
<a name="l00921"></a>00921                 {
<a name="l00922"></a>00922                         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][j] &gt; 0)
<a name="l00923"></a>00923                                 typeLikelihoodPair[j].first = -log(<a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][j]);
<a name="l00924"></a>00924                         <span class="keywordflow">else</span> 
<a name="l00925"></a>00925                                 typeLikelihoodPair[j].first = MAX_DOUBLE;
<a name="l00926"></a>00926                         typeLikelihoodPair[j].second = j;
<a name="l00927"></a>00927                 }
<a name="l00928"></a>00928                 <span class="keywordflow">else</span> 
<a name="l00929"></a>00929                 {
<a name="l00930"></a>00930                         typeLikelihoodPair[j].first = MAX_DOUBLE;
<a name="l00931"></a>00931                         typeLikelihoodPair[j].second = j;
<a name="l00932"></a>00932                 }
<a name="l00933"></a>00933         }
<a name="l00934"></a>00934 }<span class="comment"></span>
<a name="l00935"></a>00935 <span class="comment">/**</span>
<a name="l00936"></a>00936 <span class="comment">* @brief compute Fisher&#39;s Linear discrimants</span>
<a name="l00937"></a>00937 <span class="comment">*                only computed if clusters are 2 or three</span>
<a name="l00938"></a>00938 <span class="comment">* @param FLD1 - FLD for the first two clusters</span>
<a name="l00939"></a>00939 <span class="comment">* @param FLD2 - FLD for the second two clusters</span>
<a name="l00940"></a>00940 <span class="comment">* @return void</span>
<a name="l00941"></a>00941 <span class="comment">*/</span>
<a name="l00942"></a><a class="code" href="classCPrimeEM.html#a2a42d54bccfe7b0c4c1e162a4d1e07b4">00942</a> <span class="keywordtype">void</span> <a class="code" href="classCPrimeEM.html#a2a42d54bccfe7b0c4c1e162a4d1e07b4" title="compute Fisher&amp;#39;s Linear discrimants only computed if clusters are 2 or three">CPrimeEM::computeFLD</a>()
<a name="l00943"></a>00943 {
<a name="l00944"></a>00944         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a> &gt; 3 || <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a> &lt; 2)
<a name="l00945"></a>00945         {
<a name="l00946"></a>00946                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> = NA;
<a name="l00947"></a>00947                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = NA;
<a name="l00948"></a>00948                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a> = NA;
<a name="l00949"></a>00949                 <span class="keywordflow">return</span>;
<a name="l00950"></a>00950         }
<a name="l00951"></a>00951 
<a name="l00952"></a>00952         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[0] &amp;&amp; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[1]) 
<a name="l00953"></a>00953         {
<a name="l00954"></a>00954                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> = (<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[1]-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[0])/sqrt(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[1]*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[1]+<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[0]*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[0]);
<a name="l00955"></a>00955         }
<a name="l00956"></a>00956         
<a name="l00957"></a>00957         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a> == 3)
<a name="l00958"></a>00958         {
<a name="l00959"></a>00959                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[1] &amp;&amp; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[2]) 
<a name="l00960"></a>00960                 {
<a name="l00961"></a>00961                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = (<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[2]-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[1])/sqrt(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[2]*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[2]+<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[1]*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[1]);
<a name="l00962"></a>00962                 }
<a name="l00963"></a>00963 
<a name="l00964"></a>00964                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[0] &amp;&amp; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[2] &amp;&amp; !<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[1]) 
<a name="l00965"></a>00965                 {
<a name="l00966"></a>00966                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = (<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[2]-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[0])/sqrt(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[2]*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[2]+<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[0]*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[0]);
<a name="l00967"></a>00967                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a>/4;
<a name="l00968"></a>00968                 }
<a name="l00969"></a>00969         }
<a name="l00970"></a>00970         <span class="keywordflow">else</span>
<a name="l00971"></a>00971         {
<a name="l00972"></a>00972                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> = NA;
<a name="l00973"></a>00973         }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a> &amp;&amp; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a>)
<a name="l00976"></a>00976                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a> = sqrt(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a>*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a>);
<a name="l00977"></a>00977         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a> != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a>)
<a name="l00978"></a>00978                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a> = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ababeb709f8bbf460f11460be510f540d" title="Fisher&amp;#39;s linear discriminant of the first two clusters.">m_FLD1</a>;
<a name="l00979"></a>00979         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a> != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a>)
<a name="l00980"></a>00980                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a> = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a23a899a7ea1fc285b27e53bfb1d38c7c" title="Fisher&amp;#39;s linear discriminant of the second two clusters.">m_FLD2</a>;
<a name="l00981"></a>00981         <span class="keywordflow">else</span> <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a> = NA;
<a name="l00982"></a>00982 }<span class="comment"></span>
<a name="l00983"></a>00983 <span class="comment">/**</span>
<a name="l00984"></a>00984 <span class="comment">* @brief adjust class membership and associated confidence to data point i</span>
<a name="l00985"></a>00985 <span class="comment">* @param i - data point index</span>
<a name="l00986"></a>00986 <span class="comment">* @return void</span>
<a name="l00987"></a>00987 <span class="comment">*/</span>
<a name="l00988"></a><a class="code" href="classCPrimeEM.html#a7786e17a86ce043c18b5d191c83671b1">00988</a> <span class="keywordtype">void</span> <a class="code" href="classCPrimeEM.html#a7786e17a86ce043c18b5d191c83671b1" title="adjust class membership and associated confidence to data point i">CPrimeEM::adjustClassAndConfidence</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i)
<a name="l00989"></a>00989 {
<a name="l00990"></a>00990         <span class="keywordtype">int</span> nValidClusters = accumulate(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.begin(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.end(),0);
<a name="l00991"></a>00991 
<a name="l00992"></a>00992         <span class="comment">// reassign so that 0==AA,1==AB,2==BB,-1==NC</span>
<a name="l00993"></a>00993         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>[i] = 2 - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>[i];
<a name="l00994"></a>00994         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>[i] &gt; 2)
<a name="l00995"></a>00995                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>[i] = -1;
<a name="l00996"></a>00996 
<a name="l00997"></a>00997         <span class="comment">// calculate confidence scores</span>
<a name="l00998"></a>00998         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a363c1447d42238bd73c6a6cbcad34027" title="genotype confidence">m_confidence</a>[i] = 1 - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a42a0ef680a299eec700fa75de7b7838c" title="probability to best fit cluster">m_prob</a>[i];
<a name="l00999"></a>00999         <span class="keywordflow">if</span>(nValidClusters &gt; 1)
<a name="l01000"></a>01000         {
<a name="l01001"></a>01001                 <span class="keywordtype">double</span> pRatio = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>[i]/(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>[i] + 1);
<a name="l01002"></a>01002                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a363c1447d42238bd73c6a6cbcad34027" title="genotype confidence">m_confidence</a>[i] = 1- <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a42a0ef680a299eec700fa75de7b7838c" title="probability to best fit cluster">m_prob</a>[i] * pRatio;
<a name="l01003"></a>01003         }
<a name="l01004"></a>01004         <span class="comment">// thresholding</span>
<a name="l01005"></a>01005         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a363c1447d42238bd73c6a6cbcad34027" title="genotype confidence">m_confidence</a>[i] &gt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a62b805c815a20632a64ba9dfc814d10e" title="the threshold on EM&amp;#39;s confidence">m_threshold</a>)
<a name="l01006"></a>01006                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>[i] = -1;
<a name="l01007"></a>01007 }<span class="comment"></span>
<a name="l01008"></a>01008 <span class="comment">/**</span>
<a name="l01009"></a>01009 <span class="comment">* @brief assign class membership and associated confidence to data point i</span>
<a name="l01010"></a>01010 <span class="comment">* @param typeLikelihoodPair - the type and likelihood pair container</span>
<a name="l01011"></a>01011 <span class="comment">* @param i - data point index</span>
<a name="l01012"></a>01012 <span class="comment">* @return void</span>
<a name="l01013"></a>01013 <span class="comment">*/</span>      
<a name="l01014"></a><a class="code" href="classCPrimeEM.html#ac30c57ecc269eeeeac8dafb9af75eca1">01014</a> <span class="keywordtype">void</span> <a class="code" href="classCPrimeEM.html#ac30c57ecc269eeeeac8dafb9af75eca1" title="assign class membership and associated confidence to data point i">CPrimeEM::assignClassAndConfidence</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i, std::vector&lt;std::pair&lt;double,int&gt; &gt;&amp; typeLikelihoodPair)
<a name="l01015"></a>01015 {
<a name="l01016"></a>01016         <span class="comment">// results holders</span>
<a name="l01017"></a>01017         <span class="keywordtype">int</span> best = 0, second = -1, third = -1, temp = -1;
<a name="l01018"></a>01018 
<a name="l01019"></a>01019         <span class="comment">// number of valid clusters</span>
<a name="l01020"></a>01020         <span class="keywordtype">int</span> nValidClusters = accumulate(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.begin(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.end(),0);
<a name="l01021"></a>01021 
<a name="l01022"></a>01022         <span class="keywordflow">if</span>(nValidClusters &gt; 1) 
<a name="l01023"></a>01023         {
<a name="l01024"></a>01024                 best = typeLikelihoodPair[0].second, second = typeLikelihoodPair[1].second;
<a name="l01025"></a>01025                 <span class="keywordtype">double</span> dotProd = (<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[second])*(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[best]-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[second]);
<a name="l01026"></a>01026                 <span class="keywordflow">if</span>(dotProd &lt; 0) 
<a name="l01027"></a>01027                 { <span class="comment">//inconsistency found</span>
<a name="l01028"></a>01028             temp = best;
<a name="l01029"></a>01029             best = second;
<a name="l01030"></a>01030             second = temp;
<a name="l01031"></a>01031                 }
<a name="l01032"></a>01032                 <span class="keywordflow">if</span>(nValidClusters &gt; 2) 
<a name="l01033"></a>01033                 {
<a name="l01034"></a>01034                         third = typeLikelihoodPair[2].second;
<a name="l01035"></a>01035             dotProd = (<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[third])*(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[best]-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[third]);
<a name="l01036"></a>01036             <span class="keywordflow">if</span>(dotProd &lt; 0) 
<a name="l01037"></a>01037                         { <span class="comment">//inconsistency found</span>
<a name="l01038"></a>01038                                 temp = second;
<a name="l01039"></a>01039                                 second = best;
<a name="l01040"></a>01040                                 best = third;
<a name="l01041"></a>01041                                 third = temp;
<a name="l01042"></a>01042             }
<a name="l01043"></a>01043                 }
<a name="l01044"></a>01044         }
<a name="l01045"></a>01045         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a76437dcd2f2e5a2b93429124946fda8d" title="EM cluster member assignment.">m_class</a>[i] = best;
<a name="l01046"></a>01046 
<a name="l01047"></a>01047         <span class="keywordflow">if</span>(nValidClusters &gt; 1) 
<a name="l01048"></a>01048         {
<a name="l01049"></a>01049                 <span class="comment">// check that the second most likely cluster is much less probable</span>
<a name="l01050"></a>01050                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][second] == 0) 
<a name="l01051"></a>01051             <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>[i] = 0;
<a name="l01052"></a>01052                 <span class="keywordflow">else</span> 
<a name="l01053"></a>01053             <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>[i] = <a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][best]/<a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][second];
<a name="l01054"></a>01054                 
<a name="l01055"></a>01055                 <span class="comment">// need to modify if the ratio is too large, do this later</span>
<a name="l01056"></a>01056                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>[i] == <a class="code" href="PrimeEM_8cpp.html#a12c2040f25d8e3a7b9e1c2024c618cb6" title="infinity of doubles">INF</a>) 
<a name="l01057"></a>01057                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>[i] = MAX_DOUBLE;
<a name="l01058"></a>01058                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>[i] &gt; <a class="code" href="PrimeEM_8cpp.html#a6b65f4b50d2d129e2fe16f8febc172c4" title="maximum of doubles">MAX_DOUBLE</a>) 
<a name="l01059"></a>01059                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a99720a90e8d5ce524e3069a3c3c20e3a" title="probability ratio, best vs. second best">m_probRatio</a>[i] = MAX_DOUBLE;
<a name="l01060"></a>01060         }                       
<a name="l01061"></a>01061         
<a name="l01062"></a>01062         <span class="keywordtype">double</span> z = (<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[best])/<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[best];
<a name="l01063"></a>01063         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a42a0ef680a299eec700fa75de7b7838c" title="probability to best fit cluster">m_prob</a>[i] = <a class="code" href="PrimeEM_8cpp.html#a24f9591c87bebc6c97f9ba0ff1b9f181" title="Utility function to calculate value from Gaussian function with an exponential tail.">calcGaussianWithExpTail</a>(z,<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a95e7e89bbc1092167ef668f7d1199404" title="to where we place the non-Gaussian tail">m_tailCut</a>,<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#aff0fe9e1cf4d2e469361d8b1b6d35362" title="factor to balance the weights in confidence of probability and loglikelihood ratio">m_factor</a>);
<a name="l01064"></a>01064         
<a name="l01065"></a>01065         <span class="comment">// the probability to be used for seed quality</span>
<a name="l01066"></a>01066         <span class="keywordtype">double</span> prob = <a class="code" href="PrimeEM_8cpp.html#af67b6328c5c42d5555d800b9ac3419b2" title="Utility function to calculate probability from Gaussian distibution with an exponential tail given th...">calcProbability</a>(<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i],<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[best],<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[best],<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[best],<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a95e7e89bbc1092167ef668f7d1199404" title="to where we place the non-Gaussian tail">m_tailCut</a>);   
<a name="l01067"></a>01067         prob = prob*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[best];
<a name="l01068"></a>01068         <span class="keywordtype">double</span> logProb = -log(prob);
<a name="l01069"></a>01069 
<a name="l01070"></a>01070         <span class="comment">// sum up the best negative log probabilities over all samples</span>
<a name="l01071"></a>01071         <span class="comment">// there is tweek waiting for Chad&#39;s response</span>
<a name="l01072"></a>01072         <span class="keywordflow">if</span>(logProb &gt; 20) 
<a name="l01073"></a>01073                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 20;
<a name="l01074"></a>01074         <span class="keywordflow">else</span> 
<a name="l01075"></a>01075                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + logProb;   
<a name="l01076"></a>01076         
<a name="l01077"></a>01077         <span class="comment">// adjust call and compute confidence</span>
<a name="l01078"></a>01078     <span class="comment">// reassign so that 0==AA,1==AB,2==BB,-1==NC</span>
<a name="l01079"></a>01079         <a class="code" href="classCPrimeEM.html#a7786e17a86ce043c18b5d191c83671b1" title="adjust class membership and associated confidence to data point i">adjustClassAndConfidence</a>(i);
<a name="l01080"></a>01080 }
<a name="l01081"></a>01081 <span class="comment"></span>
<a name="l01082"></a>01082 <span class="comment">/**</span>
<a name="l01083"></a>01083 <span class="comment">* @brief compute all posterior estimates</span>
<a name="l01084"></a>01084 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l01085"></a>01085 <span class="comment">*/</span>
<a name="l01086"></a><a class="code" href="classCPrimeEM.html#a00a609a5422409351a44053053c322c1">01086</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a00a609a5422409351a44053053c322c1" title="compute all posterior estimates">CPrimeEM::computeOptimalEstimates</a>()
<a name="l01087"></a>01087 {
<a name="l01088"></a>01088         <span class="comment">// number of valid clusters</span>
<a name="l01089"></a>01089         <span class="keywordtype">int</span> nValidClusters = accumulate(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.begin(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.end(),0);
<a name="l01090"></a>01090                 
<a name="l01091"></a>01091         <span class="keywordtype">int</span> i = 0;
<a name="l01092"></a>01092         vector&lt;pair&lt;double,int&gt; &gt; typeLikelihoodPair(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l01093"></a>01093         <span class="keywordflow">if</span>(nValidClusters &gt; 0) 
<a name="l01094"></a>01094         { 
<a name="l01095"></a>01095                 <span class="comment">// reset likelihood for each data point</span>
<a name="l01096"></a>01096                 <a class="code" href="classCPrimeEM.html#a95185f539e435d9fe730cb4903251c95" title="initialize the type and likelihood pair vector, assign likelihood to infinity">initializeTypeLikelihoodPair</a>(typeLikelihoodPair);
<a name="l01097"></a>01097 
<a name="l01098"></a>01098                 <span class="comment">// calculate negative log likelihoods</span>
<a name="l01099"></a>01099                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> = 0;
<a name="l01100"></a>01100                 <span class="keywordflow">for</span>(i=0; i &lt; <a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>; i ++) 
<a name="l01101"></a>01101                 {
<a name="l01102"></a>01102                         <span class="comment">// calculate and assign log likelihood for each data point</span>
<a name="l01103"></a>01103                         <a class="code" href="classCPrimeEM.html#ac7e98a76ba03038cd8fdc6a4bd82bed8" title="assign likelihood to each cluster for data point i">assignLogLikelihood</a>(typeLikelihoodPair,i);
<a name="l01104"></a>01104 
<a name="l01105"></a>01105                         <span class="comment">// order class index based on likelihood</span>
<a name="l01106"></a>01106                         sort(typeLikelihoodPair.begin(),typeLikelihoodPair.end(),<a class="code" href="structPairLess.html">PairLess</a>());
<a name="l01107"></a>01107                         
<a name="l01108"></a>01108                         <span class="comment">// build call and confidence for data point i</span>
<a name="l01109"></a>01109                         <a class="code" href="classCPrimeEM.html#ac30c57ecc269eeeeac8dafb9af75eca1" title="assign class membership and associated confidence to data point i">assignClassAndConfidence</a>(i,typeLikelihoodPair);
<a name="l01110"></a>01110                 }
<a name="l01111"></a>01111         }
<a name="l01112"></a>01112                 
<a name="l01113"></a>01113         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01114"></a>01114 }<span class="comment"></span>
<a name="l01115"></a>01115 <span class="comment">/**</span>
<a name="l01116"></a>01116 <span class="comment">* @brief compare the current estimates to the best by far</span>
<a name="l01117"></a>01117 <span class="comment">* @param bestEst - best estimates so far</span>
<a name="l01118"></a>01118 <span class="comment">* @return true if current is better</span>
<a name="l01119"></a>01119 <span class="comment">*/</span>
<a name="l01120"></a><a class="code" href="classCPrimeEM.html#af8190fb2a69496599a457081e2c8bc33">01120</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#af8190fb2a69496599a457081e2c8bc33" title="compare the current estimates to the best by far">CPrimeEM::evaluateEstimates</a>(<a class="code" href="classCEMEst.html" title="Object to hold all EM posterior information including some classification quality stats...">CEMEst</a>&amp; bestEst)
<a name="l01121"></a>01121 {
<a name="l01122"></a>01122         <span class="keywordtype">bool</span> test = <span class="keyword">false</span>;
<a name="l01123"></a>01123         <span class="keywordtype">int</span> nValidClusters = accumulate(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.begin(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.end(),0);
<a name="l01124"></a>01124         <span class="keywordflow">switch</span>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a1c13153fc8914df15821160bde8e2487" title="the loss function to be used for EM evaluation">m_lossFunction</a>)
<a name="l01125"></a>01125         {
<a name="l01126"></a>01126         <span class="keywordflow">case</span> ML:
<a name="l01127"></a>01127                 test = (<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> &lt; bestEst.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a>);
<a name="l01128"></a>01128                 <span class="keywordflow">break</span>;
<a name="l01129"></a>01129         <span class="keywordflow">case</span> AIC:
<a name="l01130"></a>01130                 test = (2*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 2*nValidClusters 
<a name="l01131"></a>01131                         &lt; 2*bestEst.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 2*nValidClusters);
<a name="l01132"></a>01132                 <span class="keywordflow">break</span>;
<a name="l01133"></a>01133         <span class="keywordflow">case</span> BIC:
<a name="l01134"></a>01134                 test = (2*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 2*<a class="code" href="classCPrimeEM.html#a518445ac011659b1326c283c8f2a5185" title="parameter to the scale of FLD penalty of a classification, calculated from m_nDim on the fly...">m_lamda</a>*nValidClusters 
<a name="l01135"></a>01135                         &lt; 2*bestEst.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 2*<a class="code" href="classCPrimeEM.html#a518445ac011659b1326c283c8f2a5185" title="parameter to the scale of FLD penalty of a classification, calculated from m_nDim on the fly...">m_lamda</a>*nValidClusters);
<a name="l01136"></a>01136                 <span class="keywordflow">break</span>;
<a name="l01137"></a>01137         <span class="keywordflow">case</span> BIC_SEP:
<a name="l01138"></a>01138                 test = (2*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 2*<a class="code" href="classCPrimeEM.html#a518445ac011659b1326c283c8f2a5185" title="parameter to the scale of FLD penalty of a classification, calculated from m_nDim on the fly...">m_lamda</a>*(nValidClusters-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a>) 
<a name="l01139"></a>01139                         &lt; 2*bestEst.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 2*<a class="code" href="classCPrimeEM.html#a518445ac011659b1326c283c8f2a5185" title="parameter to the scale of FLD penalty of a classification, calculated from m_nDim on the fly...">m_lamda</a>*(nValidClusters-bestEst.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a>));
<a name="l01140"></a>01140                 <span class="keywordflow">break</span>;
<a name="l01141"></a>01141         <span class="keywordflow">default</span>:
<a name="l01142"></a>01142                 test = (2*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 2*<a class="code" href="classCPrimeEM.html#a518445ac011659b1326c283c8f2a5185" title="parameter to the scale of FLD penalty of a classification, calculated from m_nDim on the fly...">m_lamda</a>*(nValidClusters-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a>) 
<a name="l01143"></a>01143                         &lt; 2*bestEst.<a class="code" href="classCEMEst.html#ae200f27ce72c54f12b60f8cd397a9bd3" title="total maximum likelihood">m_ML</a> + 2*<a class="code" href="classCPrimeEM.html#a518445ac011659b1326c283c8f2a5185" title="parameter to the scale of FLD penalty of a classification, calculated from m_nDim on the fly...">m_lamda</a>*(nValidClusters-bestEst.<a class="code" href="classCEMEst.html#a576a2d970932af8fc97b3290c865eaf7" title="separation of the clustering results">m_sep</a>));
<a name="l01144"></a>01144                 <span class="keywordflow">break</span>;
<a name="l01145"></a>01145         }
<a name="l01146"></a>01146         <span class="keywordflow">if</span>(test)
<a name="l01147"></a>01147                 bestEst = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>;
<a name="l01148"></a>01148 
<a name="l01149"></a>01149         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01150"></a>01150 }
<a name="l01151"></a>01151 <span class="comment"></span>
<a name="l01152"></a>01152 <span class="comment">/**</span>
<a name="l01153"></a>01153 <span class="comment">* @brief update cluster centers </span>
<a name="l01154"></a>01154 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l01155"></a>01155 <span class="comment">*/</span>
<a name="l01156"></a><a class="code" href="classCPrimeEM.html#a2b61a397ea3979a65eb0f1f8e8b811f7">01156</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a2b61a397ea3979a65eb0f1f8e8b811f7" title="update cluster centers">CPrimeEM::updateMu</a>()
<a name="l01157"></a>01157 {
<a name="l01158"></a>01158     <span class="comment">// calculate mu</span>
<a name="l01159"></a>01159         <span class="keywordtype">int</span> j = 0, i = 0;
<a name="l01160"></a>01160         fill(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>.begin(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>.end(),0.0f);
<a name="l01161"></a>01161         <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j++) 
<a name="l01162"></a>01162         {
<a name="l01163"></a>01163                 <span class="comment">// only work on valid clusters</span>
<a name="l01164"></a>01164                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j]) 
<a name="l01165"></a>01165                 {
<a name="l01166"></a>01166                         <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>; i ++)
<a name="l01167"></a>01167                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j] + <a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][j] * <a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i];
<a name="l01168"></a>01168         
<a name="l01169"></a>01169                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j]/<a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>[j];
<a name="l01170"></a>01170                 }
<a name="l01171"></a>01171         }
<a name="l01172"></a>01172 
<a name="l01173"></a>01173         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01174"></a>01174 }<span class="comment"></span>
<a name="l01175"></a>01175 <span class="comment">/**</span>
<a name="l01176"></a>01176 <span class="comment">* @brief update cluster variances </span>
<a name="l01177"></a>01177 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l01178"></a>01178 <span class="comment">*/</span>
<a name="l01179"></a><a class="code" href="classCPrimeEM.html#a0fa34b8e45f99de75d4cebd5bac5bc47">01179</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a0fa34b8e45f99de75d4cebd5bac5bc47" title="update cluster variances">CPrimeEM::updateSigma</a>()
<a name="l01180"></a>01180 {
<a name="l01181"></a>01181     <span class="keywordtype">double</span> s_2 = 0;
<a name="l01182"></a>01182         <span class="keywordtype">int</span> i = 0, j = 0;
<a name="l01183"></a>01183     <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++) 
<a name="l01184"></a>01184         {
<a name="l01185"></a>01185                 <span class="comment">// only work on valid clusters</span>
<a name="l01186"></a>01186                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j]) 
<a name="l01187"></a>01187                 {
<a name="l01188"></a>01188                         s_2 = 0;
<a name="l01189"></a>01189                         <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>; i ++) 
<a name="l01190"></a>01190                         {
<a name="l01191"></a>01191                                 s_2 += <a class="code" href="classCPrimeEM.html#a0ccff5865e707a78d1447eec6b2ced5c" title="container of normalized probabilities">m_np</a>[i][j] * (<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i]-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j])*(<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>[i]-<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[j]);
<a name="l01192"></a>01192                         }
<a name="l01193"></a>01193                         s_2 = s_2/<a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>[j];
<a name="l01194"></a>01194                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] = sqrt(s_2);
<a name="l01195"></a>01195                 }
<a name="l01196"></a>01196     }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01199"></a>01199 }<span class="comment"></span>
<a name="l01200"></a>01200 <span class="comment">/**</span>
<a name="l01201"></a>01201 <span class="comment">* @brief update cluster weights </span>
<a name="l01202"></a>01202 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l01203"></a>01203 <span class="comment">*/</span>
<a name="l01204"></a><a class="code" href="classCPrimeEM.html#a07e6dfff27749cebe2052ed8739c9383">01204</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a07e6dfff27749cebe2052ed8739c9383" title="update cluster weights">CPrimeEM::updateWeight</a>()
<a name="l01205"></a>01205 {
<a name="l01206"></a>01206         <span class="keywordtype">int</span> j = 0;
<a name="l01207"></a>01207         <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++)
<a name="l01208"></a>01208         {
<a name="l01209"></a>01209                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j])
<a name="l01210"></a>01210                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[j] = <a class="code" href="classCPrimeEM.html#a2dc6ba29771f53d778fad707ad3781d7" title="container of total cluster normalized probabilities">m_clusterNP</a>[j]/<a class="code" href="classCPrimeEM.html#a06e3381995e22ca5d3c08aabe240db6c" title="container of total probabilities">m_sumNP</a>;
<a name="l01211"></a>01211         }
<a name="l01212"></a>01212 
<a name="l01213"></a>01213         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01214"></a>01214 }
<a name="l01215"></a>01215 <span class="comment"></span>
<a name="l01216"></a>01216 <span class="comment">/**</span>
<a name="l01217"></a>01217 <span class="comment">* @brief validate and adjust seed according to constraints</span>
<a name="l01218"></a>01218 <span class="comment">* @param seed - the seed to be adjusted and returned after adjustment</span>
<a name="l01219"></a>01219 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l01220"></a>01220 <span class="comment">*/</span>
<a name="l01221"></a><a class="code" href="classCPrimeEM.html#ae91c191658a3111b11048943f4888a17">01221</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#ae91c191658a3111b11048943f4888a17" title="validate and adjust seed according to constraints">CPrimeEM::validate</a>(<a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a>&amp; seed)
<a name="l01222"></a>01222 {
<a name="l01223"></a>01223         <span class="comment">// consistency</span>
<a name="l01224"></a>01224         <span class="keywordtype">bool</span> consistent = (seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.size() == seed.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.size());
<a name="l01225"></a>01225         consistent &amp;= (seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.size() == seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.size());
<a name="l01226"></a>01226         consistent &amp;= (seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.size() == seed.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.size());
<a name="l01227"></a>01227         consistent &amp;= (seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.size() == seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.size());
<a name="l01228"></a>01228         consistent &amp;= (seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.size() == seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.size());
<a name="l01229"></a>01229         consistent &amp;= (seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.size() == seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.size());
<a name="l01230"></a>01230         consistent &amp;= (seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.size() == <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l01231"></a>01231         <span class="keywordflow">if</span>(!consistent) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01232"></a>01232 
<a name="l01233"></a>01233         <span class="keywordtype">int</span> i = 0;
<a name="l01234"></a>01234         <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; i ++)
<a name="l01235"></a>01235         {
<a name="l01236"></a>01236                 <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[i] &gt; 0)
<a name="l01237"></a>01237                 {
<a name="l01238"></a>01238                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[i] = <span class="keyword">true</span>;
<a name="l01239"></a>01239 
<a name="l01240"></a>01240                         <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[i] &gt; seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[i])
<a name="l01241"></a>01241                                 seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[i] = seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[i];
<a name="l01242"></a>01242                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[i] &lt; seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[i])
<a name="l01243"></a>01243                                 seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[i] = seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[i];
<a name="l01244"></a>01244 
<a name="l01245"></a>01245                         <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[i] &gt; seed.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>[i])
<a name="l01246"></a>01246                                 seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[i] = seed.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>[i];
<a name="l01247"></a>01247                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[i] &lt; seed.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>[i])
<a name="l01248"></a>01248                                 seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[i] = seed.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>[i];
<a name="l01249"></a>01249                 }
<a name="l01250"></a>01250                 <span class="keywordflow">else</span> <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[i] = <span class="keyword">false</span>;
<a name="l01251"></a>01251         }
<a name="l01252"></a>01252 
<a name="l01253"></a>01253         <span class="comment">// set initial step</span>
<a name="l01254"></a>01254         copy(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin(),seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.end(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>.begin());
<a name="l01255"></a>01255         copy(seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin(),seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.end(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>.begin());
<a name="l01256"></a>01256         copy(seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.begin(),seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.end(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>.begin());
<a name="l01257"></a>01257         copy(seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.begin(),seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>.end(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#acb7ecf1e0503d1e36cee16c83baa9dfe" title="minimum of cluster centers">m_minMu</a>.begin());
<a name="l01258"></a>01258         copy(seed.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin(),seed.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.end(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>.begin());
<a name="l01259"></a>01259         copy(seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin(),seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.end(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a8d374f17bae7bf97d75823b069501781" title="maximums of cluster centers">m_maxMu</a>.begin());
<a name="l01260"></a>01260         copy(seed.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin(),seed.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.end(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>.begin());
<a name="l01261"></a>01261 
<a name="l01262"></a>01262         <span class="comment">// the results holder</span>
<a name="l01263"></a>01263         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aa753c14df6fa982320b886b20cbe299f" title="set the number of cluters">set</a>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l01264"></a>01264         <a class="code" href="classCPrimeEM.html#aefd80259abe876018d3ed5794dca643e" title="best estimates so far">m_preEst</a>.<a class="code" href="classCEMEst.html#aa753c14df6fa982320b886b20cbe299f" title="set the number of cluters">set</a>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>);
<a name="l01265"></a>01265 
<a name="l01266"></a>01266         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01267"></a>01267 }<span class="comment"></span>
<a name="l01268"></a>01268 <span class="comment">/**</span>
<a name="l01269"></a>01269 <span class="comment">* @brief adjust cluster centers according to constraints</span>
<a name="l01270"></a>01270 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l01271"></a>01271 <span class="comment">*/</span>
<a name="l01272"></a><a class="code" href="classCPrimeEM.html#a09521746ac5e2de4329222a037c4888e">01272</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a09521746ac5e2de4329222a037c4888e" title="adjust cluster centers according to constraints">CPrimeEM::adjustMu</a>()
<a name="l01273"></a>01273 {
<a name="l01274"></a>01274         <span class="keywordtype">int</span> i = 0;
<a name="l01275"></a>01275         <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; i ++)
<a name="l01276"></a>01276         {
<a name="l01277"></a>01277                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[i])
<a name="l01278"></a>01278                 {
<a name="l01279"></a>01279                         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[i] &gt; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a8d374f17bae7bf97d75823b069501781" title="maximums of cluster centers">m_maxMu</a>[i])
<a name="l01280"></a>01280                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[i] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a8d374f17bae7bf97d75823b069501781" title="maximums of cluster centers">m_maxMu</a>[i];
<a name="l01281"></a>01281                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[i] &lt; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#acb7ecf1e0503d1e36cee16c83baa9dfe" title="minimum of cluster centers">m_minMu</a>[i])
<a name="l01282"></a>01282                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[i] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#acb7ecf1e0503d1e36cee16c83baa9dfe" title="minimum of cluster centers">m_minMu</a>[i];
<a name="l01283"></a>01283 
<a name="l01284"></a>01284                         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[i] &gt; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>[i])
<a name="l01285"></a>01285                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[i] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>[i];
<a name="l01286"></a>01286                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[i] &lt; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>[i])
<a name="l01287"></a>01287                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[i] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>[i];
<a name="l01288"></a>01288                 }
<a name="l01289"></a>01289         }
<a name="l01290"></a>01290 
<a name="l01291"></a>01291         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01292"></a>01292 }<span class="comment"></span>
<a name="l01293"></a>01293 <span class="comment">/**</span>
<a name="l01294"></a>01294 <span class="comment">* @brief adjust cluster variances according to constraints</span>
<a name="l01295"></a>01295 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l01296"></a>01296 <span class="comment">*/</span>
<a name="l01297"></a><a class="code" href="classCPrimeEM.html#a5c1ee1ede02c39e70f32a930c7f9aca5">01297</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#a5c1ee1ede02c39e70f32a930c7f9aca5" title="adjust cluster variances according to constraints">CPrimeEM::adjustSigma</a>()
<a name="l01298"></a>01298 {
<a name="l01299"></a>01299         <span class="comment">// if not three clusters just return</span>
<a name="l01300"></a>01300         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a> != 3) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01301"></a>01301 
<a name="l01302"></a>01302     <span class="comment">// adjust sigmas</span>
<a name="l01303"></a>01303     <span class="keywordtype">bool</span> bHet_adjusted = <span class="keyword">false</span>;
<a name="l01304"></a>01304         <span class="keywordtype">double</span> reducedSigma = 0;
<a name="l01305"></a>01305 
<a name="l01306"></a>01306         <span class="keywordtype">double</span> weights = accumulate(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>.begin(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>.end(),0.0f);
<a name="l01307"></a>01307     <span class="keywordflow">if</span>(weights &gt; 0) 
<a name="l01308"></a>01308         {
<a name="l01309"></a>01309                 <span class="keywordtype">double</span> diff1 = 0, diff2 = 0;
<a name="l01310"></a>01310                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[0] != 0 &amp;&amp; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[1] != 0)
<a name="l01311"></a>01311                         diff1 = fabs(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[1] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[0]);
<a name="l01312"></a>01312                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[1] != 0 &amp;&amp; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[2] != 0)
<a name="l01313"></a>01313                         diff2 = fabs(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[2] - <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a0c5fe09b5823515a7125c18f522cea83" title="cluster centers">m_mu</a>[1]);
<a name="l01314"></a>01314                 vector&lt;double&gt; sigmaMax = <a class="code" href="classCPrimeEM.html#a8e1e06c4f6018cbc5232b16d60774ddd" title="pointer to the current seed in use">m_pSeed</a>-&gt;<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>;
<a name="l01315"></a>01315 
<a name="l01316"></a>01316                 <span class="comment">// do sigma ajustment</span>
<a name="l01317"></a>01317                 <span class="keywordflow">if</span>(diff1 != 0 &amp;&amp; diff1 &lt; 1) 
<a name="l01318"></a>01318                 {
<a name="l01319"></a>01319                         reducedSigma = <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#af2c3a0ba35bb9a71aeeb4e985547d940" title="factor for hom cluster variance shrinkage">m_HomReductionCoef</a> * sigmaMax[0] * (1-pow(diff1,<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a324652dcf06328136b2fafff51a660e0" title="factor for both hom and het cluster variance shrinkage">m_SigmaPower</a>));
<a name="l01320"></a>01320                         <span class="keywordflow">if</span>(reducedSigma &gt; sigmaMax[0])
<a name="l01321"></a>01321                                 reducedSigma = sigmaMax[0];
<a name="l01322"></a>01322                         reducedSigma = reducedSigma*(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[1]/(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[0]+<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[1]));
<a name="l01323"></a>01323                         sigmaMax[0] = sigmaMax[0] - reducedSigma;       
<a name="l01324"></a>01324                 }
<a name="l01325"></a>01325 
<a name="l01326"></a>01326                 <span class="keywordflow">if</span>(diff2 != 0 &amp;&amp; diff2 &lt; 1) 
<a name="l01327"></a>01327                 {
<a name="l01328"></a>01328                         reducedSigma = <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#af2c3a0ba35bb9a71aeeb4e985547d940" title="factor for hom cluster variance shrinkage">m_HomReductionCoef</a> * sigmaMax[2] * (1-pow(diff2,<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a324652dcf06328136b2fafff51a660e0" title="factor for both hom and het cluster variance shrinkage">m_SigmaPower</a>));
<a name="l01329"></a>01329                         <span class="keywordflow">if</span>(reducedSigma &gt; sigmaMax[2])
<a name="l01330"></a>01330                                 reducedSigma = sigmaMax[2];
<a name="l01331"></a>01331                         reducedSigma = reducedSigma*(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[1]/(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[1]+<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[2]));
<a name="l01332"></a>01332                         sigmaMax[2] = sigmaMax[2] - reducedSigma;
<a name="l01333"></a>01333                 }
<a name="l01334"></a>01334 
<a name="l01335"></a>01335                 <span class="comment">// give hom more weights</span>
<a name="l01336"></a>01336                 <span class="keywordflow">if</span>((diff1!=0 &amp;&amp; diff1&lt;diff2) || diff2==0 || diff2 &gt;= 1) 
<a name="l01337"></a>01337                 {
<a name="l01338"></a>01338                         <span class="keywordflow">if</span>(diff1 != 0 &amp;&amp; diff1 &lt; 1) 
<a name="l01339"></a>01339                         {
<a name="l01340"></a>01340                                 reducedSigma = <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a729804d595f96e14d3f05ab951772ac7" title="factor for het cluster variance shrinkage">m_HetReductionCoef</a> * sigmaMax[1] * (1-pow(diff1,<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a324652dcf06328136b2fafff51a660e0" title="factor for both hom and het cluster variance shrinkage">m_SigmaPower</a>));
<a name="l01341"></a>01341                                 <span class="keywordflow">if</span>(reducedSigma &gt; sigmaMax[1])
<a name="l01342"></a>01342                                         reducedSigma = sigmaMax[1];
<a name="l01343"></a>01343                                 reducedSigma = reducedSigma*(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[0]/(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[0]+<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[1]));
<a name="l01344"></a>01344                                 sigmaMax[1] = sigmaMax[1] - reducedSigma;
<a name="l01345"></a>01345                                 bHet_adjusted = <span class="keyword">true</span>;
<a name="l01346"></a>01346                         }
<a name="l01347"></a>01347                 }
<a name="l01348"></a>01348 
<a name="l01349"></a>01349                 <span class="keywordflow">if</span>(!bHet_adjusted) 
<a name="l01350"></a>01350                 {
<a name="l01351"></a>01351                         <span class="keywordflow">if</span>(diff2 != 0 &amp;&amp; diff2 &lt; 1) 
<a name="l01352"></a>01352                         {
<a name="l01353"></a>01353                                 reducedSigma = <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a729804d595f96e14d3f05ab951772ac7" title="factor for het cluster variance shrinkage">m_HetReductionCoef</a> * sigmaMax[1] * (1-pow(diff2,<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a324652dcf06328136b2fafff51a660e0" title="factor for both hom and het cluster variance shrinkage">m_SigmaPower</a>));
<a name="l01354"></a>01354                                 <span class="keywordflow">if</span>(reducedSigma &gt; sigmaMax[1])
<a name="l01355"></a>01355                                         reducedSigma = sigmaMax[1];
<a name="l01356"></a>01356                                 reducedSigma = reducedSigma*(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[2]/(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[2]+<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaac70efd0322814ba59ffbc67f09e334" title="cluster weights">m_weight</a>[1]));
<a name="l01357"></a>01357                                 sigmaMax[1] = sigmaMax[1] - reducedSigma;                       
<a name="l01358"></a>01358                         }
<a name="l01359"></a>01359                 }
<a name="l01360"></a>01360 
<a name="l01361"></a>01361                 <span class="comment">// sigmaMax should not be larger than the simgaMax or smaller than sigmaMin seeded</span>
<a name="l01362"></a>01362                 <span class="keywordtype">int</span> j = 0;
<a name="l01363"></a>01363                 <span class="keywordflow">for</span>(j =0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++) 
<a name="l01364"></a>01364                 {
<a name="l01365"></a>01365                         <span class="keywordflow">if</span>(sigmaMax[j] &gt; <a class="code" href="classCPrimeEM.html#a8e1e06c4f6018cbc5232b16d60774ddd" title="pointer to the current seed in use">m_pSeed</a>-&gt;<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>[j])
<a name="l01366"></a>01366                                 sigmaMax[j] = <a class="code" href="classCPrimeEM.html#a8e1e06c4f6018cbc5232b16d60774ddd" title="pointer to the current seed in use">m_pSeed</a>-&gt;<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>[j];
<a name="l01367"></a>01367                         <span class="keywordflow">if</span>(sigmaMax[j] &lt; <a class="code" href="classCPrimeEM.html#a8e1e06c4f6018cbc5232b16d60774ddd" title="pointer to the current seed in use">m_pSeed</a>-&gt;<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>[j])
<a name="l01368"></a>01368                                 sigmaMax[j] = <a class="code" href="classCPrimeEM.html#a8e1e06c4f6018cbc5232b16d60774ddd" title="pointer to the current seed in use">m_pSeed</a>-&gt;<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>[j];   
<a name="l01369"></a>01369                 }
<a name="l01370"></a>01370 
<a name="l01371"></a>01371                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a> = sigmaMax;
<a name="l01372"></a>01372     }
<a name="l01373"></a>01373 
<a name="l01374"></a>01374     <span class="comment">// check any unusual sigmas</span>
<a name="l01375"></a>01375         <span class="keywordtype">int</span> j = 0;
<a name="l01376"></a>01376         <span class="keywordflow">for</span>(j =0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++)
<a name="l01377"></a>01377         {
<a name="l01378"></a>01378                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j]) 
<a name="l01379"></a>01379                 {
<a name="l01380"></a>01380                         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] &lt; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>[j])
<a name="l01381"></a>01381                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>[j];
<a name="l01382"></a>01382                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] &gt; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>[j])
<a name="l01383"></a>01383                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>[j];
<a name="l01384"></a>01384                 }
<a name="l01385"></a>01385     }
<a name="l01386"></a>01386     
<a name="l01387"></a>01387     <span class="comment">// check if any sigmas have gone below or above 2.5/3.0 times of </span>
<a name="l01388"></a>01388     <span class="comment">// geometric mean of all sigmas</span>
<a name="l01389"></a>01389     <span class="keywordtype">double</span> sigmaGeoMean = 1;
<a name="l01390"></a>01390 
<a name="l01391"></a>01391         <span class="keywordflow">for</span>(j =0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++)
<a name="l01392"></a>01392         {
<a name="l01393"></a>01393                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j]) 
<a name="l01394"></a>01394                 sigmaGeoMean = sigmaGeoMean*<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j];
<a name="l01395"></a>01395     }
<a name="l01396"></a>01396         <span class="keywordtype">int</span> nValidClusters = accumulate(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.begin(),<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>.end(),0);
<a name="l01397"></a>01397     <span class="keywordflow">if</span>(nValidClusters &gt; 0)
<a name="l01398"></a>01398         sigmaGeoMean = pow(sigmaGeoMean,1/nValidClusters);
<a name="l01399"></a>01399     
<a name="l01400"></a>01400         <span class="keywordflow">for</span>(j =0; j &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; j ++)
<a name="l01401"></a>01401         {
<a name="l01402"></a>01402                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a2c3b17d83e155f0d85c577bd6601b847" title="number of clusters remaining">m_cluster</a>[j])
<a name="l01403"></a>01403                 {
<a name="l01404"></a>01404                         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] &gt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.m_geo_ratio_multiplier[j]*sigmaGeoMean) 
<a name="l01405"></a>01405                         {
<a name="l01406"></a>01406                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] = <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.m_geo_ratio_multiplier[j]*sigmaGeoMean;
<a name="l01407"></a>01407                                 <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] &gt; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>[j])
<a name="l01408"></a>01408                                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#aaa3ba56a5dae53357dd4e289a2232557" title="maximums of cluster sigmas">m_maxSigma</a>[j];
<a name="l01409"></a>01409                         }
<a name="l01410"></a>01410             }
<a name="l01411"></a>01411             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] &lt; (sigmaGeoMean/<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.m_geo_ratio_divisor[j])) 
<a name="l01412"></a>01412                 {
<a name="l01413"></a>01413                         <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] = (sigmaGeoMean/<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.m_geo_ratio_divisor[j]);
<a name="l01414"></a>01414                         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] &lt; <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>[j])
<a name="l01415"></a>01415                                 <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#a25ef544dc666cbad66131245c2d3c1c0" title="cluster sigmas">m_sigma</a>[j] = <a class="code" href="classCPrimeEM.html#a207c329ade851d3526d61639e992d4eb" title="current estimates">m_est</a>.<a class="code" href="classCEMEst.html#ae8e0df85bc9f7527301c202737034c8d" title="minimums of cluster sigmas">m_minSigma</a>[j];
<a name="l01416"></a>01416             }
<a name="l01417"></a>01417     }
<a name="l01418"></a>01418         
<a name="l01419"></a>01419         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01420"></a>01420 }
<a name="l01421"></a>01421 <span class="comment"></span>
<a name="l01422"></a>01422 <span class="comment">/**</span>
<a name="l01423"></a>01423 <span class="comment">* @brief generate variable number of EM seeds based on some prior information</span>
<a name="l01424"></a>01424 <span class="comment">*               this function is designed specifically for 3-clusters scenario, hence only </span>
<a name="l01425"></a>01425 <span class="comment">*               works if three-clusters is specified, otherwise return false and do nothing</span>
<a name="l01426"></a>01426 <span class="comment">* @return true if no error, false otherwise</span>
<a name="l01427"></a>01427 <span class="comment">*/</span>
<a name="l01428"></a><a class="code" href="classCPrimeEM.html#afcaac33a699e66d524f5aa362bfd8fc7">01428</a> <span class="keywordtype">bool</span> <a class="code" href="classCPrimeEM.html#afcaac33a699e66d524f5aa362bfd8fc7" title="generate variable number of EM seeds based on some prior information this function is designed specif...">CPrimeEM::generateEmpiricalEMSeeds</a>()
<a name="l01429"></a>01429 {
<a name="l01430"></a>01430         <span class="comment">// this only works for three clusters or fewer</span>
<a name="l01431"></a>01431         <span class="keywordflow">if</span>(<a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a> != 3) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01432"></a>01432 
<a name="l01433"></a>01433         <span class="comment">// clear buffer</span>
<a name="l01434"></a>01434         <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.clear();
<a name="l01435"></a>01435 
<a name="l01436"></a>01436         vector&lt;double&gt; sigmaMax(3),sigmaMin(3), mu(3), weight(3);
<a name="l01437"></a>01437         transform(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.end(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.begin(),sigmaMax.begin(),plus&lt;double&gt;());
<a name="l01438"></a>01438         transform(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.end(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a922f8ed43756869b2ffe23b98786912a" title="stdev of cluster sigmas">m_sigmaSD</a>.begin(),sigmaMin.begin(),minus&lt;double&gt;());
<a name="l01439"></a>01439 
<a name="l01440"></a>01440         <span class="keywordtype">int</span> a = 0, b = 0, h = 0,k = 0;
<a name="l01441"></a>01441         <a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a> bestSeed;
<a name="l01442"></a>01442         <span class="keywordtype">double</span> bestFLD= 0, hardshell = 0.25;
<a name="l01443"></a>01443         <span class="keywordtype">double</span> ratio1 = <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>[0]/(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>[0]+<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>[1]);
<a name="l01444"></a>01444         <span class="keywordtype">double</span> ratio2 = <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>[2]/(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>[2]+<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>[1]);
<a name="l01445"></a>01445 
<a name="l01446"></a>01446         vector&lt;double&gt; data(<a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>);
<a name="l01447"></a>01447         vector&lt;double&gt;::iterator uit, lit,it;
<a name="l01448"></a>01448         copy(<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>.begin(),<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>.end(),data.begin());
<a name="l01449"></a>01449         sort(data.begin(),data.end(),less&lt;double&gt;());
<a name="l01450"></a>01450         <span class="keywordflow">for</span>(a = 1; a &lt;= 3; a ++)
<a name="l01451"></a>01451         {
<a name="l01452"></a>01452                 <span class="keywordflow">for</span>(b = 1; b &lt;= 3; b ++)
<a name="l01453"></a>01453                 {
<a name="l01454"></a>01454                         <span class="keywordflow">for</span>(h = -2; h &lt;= 2; h ++)
<a name="l01455"></a>01455                         {
<a name="l01456"></a>01456                                 <span class="keywordtype">bool</span> skip = <span class="keyword">false</span>;
<a name="l01457"></a>01457                                 <a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a> seed;
<a name="l01458"></a>01458                                 copy(sigmaMax.begin(),sigmaMax.end(),seed.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin());
<a name="l01459"></a>01459                                 copy(sigmaMin.begin(),sigmaMin.end(),seed.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin());
<a name="l01460"></a>01460                                 copy(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.end(),seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin());
<a name="l01461"></a>01461 
<a name="l01462"></a>01462                                 <span class="keywordtype">double</span> factor[] = {b-1,h,1-a};
<a name="l01463"></a>01463                                 transform(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.end(),&amp;factor[0],mu.begin(),multiplies&lt;double&gt;());
<a name="l01464"></a>01464                                 transform(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.end(),mu.begin(),seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin(),plus&lt;double&gt;());
<a name="l01465"></a>01465                                 <span class="comment">// mu minimum</span>
<a name="l01466"></a>01466                                 seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[0] = -1.25f;
<a name="l01467"></a>01467                                 <span class="keywordtype">double</span> ext = (1-ratio1)*(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]-seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0]);
<a name="l01468"></a>01468                                 seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[1] = seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1] - ext + <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l01469"></a>01469                                 ext = ratio2*(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2]-seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]);
<a name="l01470"></a>01470                                 seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[2] = seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2] - ext + <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l01471"></a>01471                                 <span class="comment">// mu maximum</span>
<a name="l01472"></a>01472                                 ext = ratio1*(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]-seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0]);
<a name="l01473"></a>01473                                 seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[0] = seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0] + ext - <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l01474"></a>01474                                 ext = (1-ratio2)*(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2]-seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]);
<a name="l01475"></a>01475                                 seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[1] = seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1] + ext - <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l01476"></a>01476                                 seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[2] = 1.25f;
<a name="l01477"></a>01477 
<a name="l01478"></a>01478                                 <span class="comment">//heck consistencey</span>
<a name="l01479"></a>01479                                 <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[0] &gt; seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[1])
<a name="l01480"></a>01480                                         skip = <span class="keyword">true</span>;
<a name="l01481"></a>01481                                 <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[1] &gt; seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[2])
<a name="l01482"></a>01482                                         skip = <span class="keyword">true</span>;
<a name="l01483"></a>01483 
<a name="l01484"></a>01484                                 <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;
<a name="l01485"></a>01485 
<a name="l01486"></a>01486                                 <span class="keywordtype">int</span> nTotal = 0;
<a name="l01487"></a>01487                                 <span class="keywordtype">double</span> percent = 0;
<a name="l01488"></a>01488                                 <span class="keywordtype">double</span> FLD = NA, FLD12 = NA, FLD23 = NA, FLD13 = NA;
<a name="l01489"></a>01489                                 vector&lt;double&gt; temp(<a class="code" href="classCPrimeEM.html#ae26a8fda3cc37f0fe96f1c0bc0d50686" title="number of data points">m_nDim</a>);
<a name="l01490"></a>01490                                 copy(<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>.begin(),<a class="code" href="classCPrimeEM.html#a98c5d7a1f8e4e656204abfc8b9c7e363" title="the data to be classified">m_data</a>.end(),temp.begin()); 
<a name="l01491"></a>01491                                 sort(temp.begin(),temp.end(),less&lt;double&gt;());
<a name="l01492"></a>01492                                 <span class="keywordflow">for</span>(k = 0; k &lt; <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a0561aeabaee6946e2d744f19300c6338" title="maximum number of clusters">m_nClusters</a>; k ++)
<a name="l01493"></a>01493                                 {
<a name="l01494"></a>01494                                         uit = lower_bound(temp.begin(),temp.end(),seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[k]);
<a name="l01495"></a>01495                                         lit = upper_bound(temp.begin(),temp.end(),seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[k]);
<a name="l01496"></a>01496                                         <span class="keywordtype">int</span> nCount = uit - lit;
<a name="l01497"></a>01497                                         <span class="keywordflow">if</span>(nCount &gt; 0)
<a name="l01498"></a>01498                                         {
<a name="l01499"></a>01499                                                 seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[k] = accumulate(lit,uit,0.0f)/nCount;
<a name="l01500"></a>01500                                                 seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[k] = nCount;
<a name="l01501"></a>01501 
<a name="l01502"></a>01502                                                 vector&lt;double&gt; var(nCount),mean(nCount);
<a name="l01503"></a>01503                                                 fill(mean.begin(),mean.end(),seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[k]);
<a name="l01504"></a>01504                                                 transform(lit,uit,mean.begin(),var.begin(),minus&lt;double&gt;());
<a name="l01505"></a>01505                                                 copy(var.begin(),var.end(),mean.begin());
<a name="l01506"></a>01506                                                 seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[k] = sqrt(inner_product(var.begin(),var.end(),mean.begin(),0.0f)/<span class="keywordtype">double</span>(nCount));
<a name="l01507"></a>01507                                                 <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[k] &lt; <a class="code" href="PrimeEM_8cpp.html#a002b2f4894492820fe708b1b7e7c5e70" title="very small positive double number">EPSILON</a>)
<a name="l01508"></a>01508                                                         seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[k] = sigmaMin[k];
<a name="l01509"></a>01509                                         }
<a name="l01510"></a>01510                                         <span class="keywordflow">else</span> 
<a name="l01511"></a>01511                                         {
<a name="l01512"></a>01512                                                 seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[k] = 0;
<a name="l01513"></a>01513                                                 seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[k] = <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>[k];;
<a name="l01514"></a>01514                                                 seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[k] = <a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>[k];
<a name="l01515"></a>01515                                         }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517                                         nTotal += nCount;
<a name="l01518"></a>01518                                 }
<a name="l01519"></a>01519 
<a name="l01520"></a>01520                                 <span class="comment">// did not cover any data points</span>
<a name="l01521"></a>01521                                 <span class="keywordflow">if</span>(nTotal &lt;= 0) <span class="keywordflow">continue</span>;
<a name="l01522"></a>01522 
<a name="l01523"></a>01523                                 <span class="comment">// calculate weights</span>
<a name="l01524"></a>01524                                 <span class="keywordflow">for</span>(it=seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.begin(); it != seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>.end(); it++) *it /= <span class="keywordtype">double</span>(nTotal);
<a name="l01525"></a>01525 
<a name="l01526"></a>01526                                 <span class="comment">// readjust the minmax of the centers</span>
<a name="l01527"></a>01527                                 seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[1] = seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1] - (1-ratio1)*(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]-seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0]) + <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l01528"></a>01528                                 seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[2] = seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2] - ratio2*(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2]-seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]) + <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l01529"></a>01529                                 seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[0] = seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0] + ratio1*(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]-seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0]) - <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l01530"></a>01530                                 seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[1] = seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1] + (1-ratio2)*(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2]-seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]) - <a class="code" href="classCPrimeEM.html#ace77851ffb297c28cb43fe8252c56266" title="EM parameters.">m_param</a>.<a class="code" href="classCEMParam.html#a5e64e41aa150feab18ee16552081d7e5" title="parameter used for seed generation">m_epsilon</a>;
<a name="l01531"></a>01531 
<a name="l01532"></a>01532                                 percent = double(nTotal)/data.size();
<a name="l01533"></a>01533                                 <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[0] &gt; 0 &amp;&amp; seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[1] &gt; 0)
<a name="l01534"></a>01534                                 {
<a name="l01535"></a>01535                                         <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[0] &gt; seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[1] || (seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1] - seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0]) &lt; hardshell)
<a name="l01536"></a>01536                                                 skip = <span class="keyword">true</span>;
<a name="l01537"></a>01537                                         FLD12 = (seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1] - seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0])/sqrt(seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[1]*seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[1]+seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[0]*seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[0]);
<a name="l01538"></a>01538                                 }
<a name="l01539"></a>01539                                 <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[1] &gt; 0 &amp;&amp; seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[2] &gt; 0)
<a name="l01540"></a>01540                                 {
<a name="l01541"></a>01541                                         <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>[1] &gt; seed.<a class="code" href="classCEMSeed.html#a6501406955c8bbd4842b6a41dcfae158" title="minimums of cluster centers">m_minMu</a>[2] || (seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2] - seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1]) &lt; hardshell)
<a name="l01542"></a>01542                                                 skip = <span class="keyword">true</span>;
<a name="l01543"></a>01543                                         FLD23 = (seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2] - seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[1])/sqrt(seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[1]*seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[1]+seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[2]*seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[2]);
<a name="l01544"></a>01544                                 }
<a name="l01545"></a>01545                                 <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[0] &gt; 0 &amp;&amp; seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[2] &gt; 0 &amp;&amp; seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[1] == 0)
<a name="l01546"></a>01546                                 {
<a name="l01547"></a>01547                                         <span class="keywordflow">if</span>(seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2] - seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0] &lt; 3*hardshell)
<a name="l01548"></a>01548                                                 skip = <span class="keyword">true</span>;
<a name="l01549"></a>01549                                         FLD13 = (seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[2] - seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>[0])/sqrt(seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[0]*seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[0]+seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[2]*seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>[2]);
<a name="l01550"></a>01550                                 }                               
<a name="l01551"></a>01551 
<a name="l01552"></a>01552                                 <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;
<a name="l01553"></a>01553 
<a name="l01554"></a>01554                                 <span class="comment">// lets look at the stats first to see whether we need more seeds or not</span>
<a name="l01555"></a>01555                                 <span class="keywordflow">if</span>(FLD12 != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a> &amp;&amp; FLD23 != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a>) 
<a name="l01556"></a>01556                                         FLD = FLD12 &lt; FLD23? FLD12:FLD23;
<a name="l01557"></a>01557                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(FLD12 != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a>)
<a name="l01558"></a>01558                                         FLD = FLD12;
<a name="l01559"></a>01559                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(FLD23 != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a>)
<a name="l01560"></a>01560                                         FLD = FLD23;
<a name="l01561"></a>01561                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(FLD13 != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a>)
<a name="l01562"></a>01562                                         FLD = FLD13;
<a name="l01563"></a>01563 
<a name="l01564"></a>01564                                 <span class="keywordtype">double</span> HET = seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[1];
<a name="l01565"></a>01565                                 <span class="keywordtype">double</span> HOM = (seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[0] &lt; seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[2])? seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[0] : seed.<a class="code" href="classCEMSeed.html#a3da232608fbf78b893896eb762fba3d6" title="weights of clusters">m_weight</a>[2];
<a name="l01566"></a>01566                                 <span class="keywordflow">if</span>(FLD != <a class="code" href="PrimeEM_8cpp.html#a68eddd535923d17ddbc8bb03bab70b3b" title="NA.">NA</a> &amp;&amp; FLD &gt; bestFLD &amp;&amp; percent &gt; 0.9f &amp;&amp; HET &gt;= 0.5*HOM &amp;&amp; HOM &gt; 0)
<a name="l01567"></a>01567                                 {
<a name="l01568"></a>01568                                         bestSeed = seed;
<a name="l01569"></a>01569                                         bestFLD = FLD;
<a name="l01570"></a>01570                                 }
<a name="l01571"></a>01571                         
<a name="l01572"></a>01572                                 <span class="comment">// collect this seed</span>
<a name="l01573"></a>01573                                 <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.push_back(seed);
<a name="l01574"></a>01574                         }
<a name="l01575"></a>01575                 }
<a name="l01576"></a>01576         }
<a name="l01577"></a>01577 
<a name="l01578"></a>01578         <span class="comment">// single seed conditions satisfied</span>
<a name="l01579"></a>01579         <span class="keywordflow">if</span>(bestFLD &gt; 3)
<a name="l01580"></a>01580         {
<a name="l01581"></a>01581                 <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>[0] = bestSeed;
<a name="l01582"></a>01582                 <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.resize(1);
<a name="l01583"></a>01583                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01584"></a>01584         }
<a name="l01585"></a>01585 
<a name="l01586"></a>01586         <span class="comment">// add the generic prior seed and two two-cluster generic seeds to cover rare cases</span>
<a name="l01587"></a>01587         <a class="code" href="classCEMSeed.html" title="Object to hold all prior information to constitute an EM seed.">CEMSeed</a> seed;
<a name="l01588"></a>01588         copy(sigmaMax.begin(),sigmaMax.end(),seed.<a class="code" href="classCEMSeed.html#aa7df19869629c5b2becb857d09cdc6f9" title="maximums of cluster sigmas">m_maxSigma</a>.begin());
<a name="l01589"></a>01589         copy(sigmaMin.begin(),sigmaMin.end(),seed.<a class="code" href="classCEMSeed.html#ab4adf8ae769c5ba54b4f2c2bdbb5995b" title="minimums of cluter sigmas">m_minSigma</a>.begin());
<a name="l01590"></a>01590         copy(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.end(),seed.<a class="code" href="classCEMSeed.html#a1a46ad34059ace7ca5cb7ef5443af9da" title="centers of clusters">m_mu</a>.begin());
<a name="l01591"></a>01591         copy(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a1a63173cea7d761ac8aabfc5b32e7655" title="cluster sigmas">m_sigma</a>.end(),seed.<a class="code" href="classCEMSeed.html#ae7cc9bf3d02902428b9ebc4770a2e755" title="sigmas of clusters">m_sigma</a>.begin());
<a name="l01592"></a>01592         transform(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.end(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.begin(),seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin(),plus&lt;double&gt;());
<a name="l01593"></a>01593         transform(<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.begin(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#a8e2f03eeb4410316a56e0e2eafef06c3" title="cluster centers">m_mu</a>.end(),<a class="code" href="classCPrimeEM.html#aa6791e45195d0df271e80cf65ff32030" title="the generic prior, kept in the level to be adjustable case specific intead of generic">m_prior</a>.<a class="code" href="classCEMPrior.html#abe14ff668c13d6e299d2852e16b3d73e" title="stdev of cluster centers">m_muSD</a>.begin(),seed.<a class="code" href="classCEMSeed.html#a731cd05530a5bec9eb3c6db1f2f8c1b2" title="maximums of cluster centers">m_maxMu</a>.begin(),minus&lt;double&gt;());
<a name="l01594"></a>01594 
<a name="l01595"></a>01595         <span class="comment">// three cluster seed with equal weights</span>
<a name="l01596"></a>01596         seed.<a class="code" href="classCEMSeed.html#ae014524f6c4329ca8b18364b316361c1" title="Set the weight of clusters assuming upto three clusters in total.">setWeight</a>(0.33f,0.34f,0.33f);
<a name="l01597"></a>01597         <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.push_back(seed);
<a name="l01598"></a>01598         <span class="comment">// BB and AB cluster seed</span>
<a name="l01599"></a>01599         seed.<a class="code" href="classCEMSeed.html#ae014524f6c4329ca8b18364b316361c1" title="Set the weight of clusters assuming upto three clusters in total.">setWeight</a>(0.75f,0.25f,0);
<a name="l01600"></a>01600         <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.push_back(seed);
<a name="l01601"></a>01601         <span class="comment">// AB and AA cluster seed</span>
<a name="l01602"></a>01602         seed.<a class="code" href="classCEMSeed.html#ae014524f6c4329ca8b18364b316361c1" title="Set the weight of clusters assuming upto three clusters in total.">setWeight</a>(0,0.25f,0.75f);
<a name="l01603"></a>01603         <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.push_back(seed);
<a name="l01604"></a>01604 
<a name="l01605"></a>01605         <span class="comment">// remove all redundant seeds</span>
<a name="l01606"></a>01606         vector&lt;CEMSeed&gt;::iterator sit = <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.begin(), tit;
<a name="l01607"></a>01607         <span class="keywordflow">while</span>(sit != <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.end())
<a name="l01608"></a>01608         {
<a name="l01609"></a>01609                 <span class="keywordflow">for</span>(tit=sit+1; tit != <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.end();)
<a name="l01610"></a>01610                 {
<a name="l01611"></a>01611                         <span class="keywordflow">if</span>(*sit == *tit) tit = <a class="code" href="classCPrimeEM.html#acad1ca275725dbe8cf4d6837b948f9c0" title="container to hold all EM seeds">m_seeds</a>.erase(tit);
<a name="l01612"></a>01612                         <span class="keywordflow">else</span> tit ++;
<a name="l01613"></a>01613                 }
<a name="l01614"></a>01614                 sit ++;
<a name="l01615"></a>01615         }
<a name="l01616"></a>01616 <span class="comment">//      unique(m_seeds.begin(),m_seeds.end());</span>
<a name="l01617"></a>01617 
<a name="l01618"></a>01618         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01619"></a>01619 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Jul 15 2014 10:37:20 for Affymetrix Power Tools by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
