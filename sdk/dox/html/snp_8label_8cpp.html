<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Affymetrix Power Tools: label/snp.label.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_193b2a3f99f2dd1b25dacc191a57775e.html">label</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>snp.label.cpp File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &quot;<a class="el" href="snp_8label_8h_source.html">label/snp.label.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="BioTypes_8h_source.html">chipstream/BioTypes.h</a>&quot;</code><br/>
<code>#include &quot;chipstream/MatrixUtil.h&quot;</code><br/>
<code>#include &quot;newmat.h&quot;</code><br/>
<code>#include &lt;algorithm&gt;</code><br/>
<code>#include &lt;cmath&gt;</code><br/>
<code>#include &lt;cstdio&gt;</code><br/>
<code>#include &lt;cstdlib&gt;</code><br/>
<code>#include &lt;functional&gt;</code><br/>
<code>#include &lt;memory&gt;</code><br/>
<code>#include &lt;new&gt;</code><br/>
<code>#include &lt;utility&gt;</code><br/>
<code>#include &lt;vector&gt;</code><br/>

<p><a href="snp_8label_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfirst__less.html">first_less</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make utility for comparing pairs  <a href="structfirst__less.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsecond__less.html">second_less</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">utility for comparing pairs  <a href="structsecond__less.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a05c9fe8994d405ac2e71e60d84a41a3c">hax</a> (int i, int j, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">hash indexer  <a href="#a05c9fe8994d405ac2e71e60d84a41a3c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#ad32e3aff38d25c6b491ca6ed6e7fbc0d">transfer</a> (double *final, double *source, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">copies one float vector to another  <a href="#ad32e3aff38d25c6b491ca6ed6e7fbc0d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a089fb51f8383b6eea013f35531b091a9">cumsum</a> (double *final, double *source, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cumulative sum of source vector  <a href="#a089fb51f8383b6eea013f35531b091a9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#ae947c9f1d5e7e344a40a3672ce12da20">vcumsum</a> (vector&lt; double &gt; &amp;final, const vector&lt; double &gt; &amp;source, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cumulative sum of source vector using STL  <a href="#ae947c9f1d5e7e344a40a3672ce12da20"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#ad748ef26c031cf6086e3a490afd3a47f">delta</a> (double *source, int length, int a, int b)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">difference in cumulative sums: i.e.  <a href="#ad748ef26c031cf6086e3a490afd3a47f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a476e5d98fb03d9efaccb100f40cd672f">apply_sum</a> (vector&lt; double &gt; &amp;final, const vector&lt; double &gt; &amp;source, int length, int flag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sum up the source array along one axis  <a href="#a476e5d98fb03d9efaccb100f40cd672f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a4ad3f76517de13f099989b46c01d6c50">reversecumsum</a> (double *final, const double *source, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">takes a cumulative sum and makes it cumulate from the other end  <a href="#a4ad3f76517de13f099989b46c01d6c50"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a71b11dd6854f20d84e0f3f8993a6cdbe">vreversecumsum</a> (vector&lt; double &gt; &amp;final, const vector&lt; double &gt; &amp;source, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">takes a cumulative sum and makes it cumulate from the other end  <a href="#a71b11dd6854f20d84e0f3f8993a6cdbe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#aa07c57aa95a5e1df7ed8e7d7c5154780">outer_minus</a> (double *final, const double *a, const double *b, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">takes outer difference of two vectors  <a href="#aa07c57aa95a5e1df7ed8e7d7c5154780"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a553a86714dd371ce3f5833b6f8b3f447">mask</a> (double *final, int length, double val)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mask out a portion of an array  <a href="#a553a86714dd371ce3f5833b6f8b3f447"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a0753c4704b4a8316c7aec8ad57f1e59f">vmask</a> (vector&lt; double &gt; &amp;final, int length, double val)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mask out a portion of an array  <a href="#a0753c4704b4a8316c7aec8ad57f1e59f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a8de4a2f660ae0703b6f1f922b0b29478">vsum</a> (double *final, const double *a, const double *b, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sum two vectors  <a href="#a8de4a2f660ae0703b6f1f922b0b29478"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a36c1a215b939f32b274bc2e7bf086e71">vplusscaldr</a> (double *final, double *a, double k, int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">add a constant to each element of a vector  <a href="#a36c1a215b939f32b274bc2e7bf086e71"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a8edf9aba80a02747bdb9108abc2f1e27">vmult</a> (vector&lt; double &gt; &amp;X, double factor)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">multiply each element of a vector by a value  <a href="#a8edf9aba80a02747bdb9108abc2f1e27"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a57e554714be3edbd1b2393e5824b03b4">inversethree</a> (vector&lt; double &gt; &amp;w, vector&lt; double &gt; &amp;v)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">inverts 3x3 matrix specialty code, avoid calling external routines  <a href="#a57e554714be3edbd1b2393e5824b03b4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a1f2ff039971eee5c78e94867f1cc9369">sumthree</a> (vector&lt; double &gt; &amp;z, vector&lt; double &gt; &amp;a, vector&lt; double &gt; &amp;b)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sum two vectors  <a href="#a1f2ff039971eee5c78e94867f1cc9369"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#afc25b20145576567e02ac9bfa60efaa0">timesthree</a> (vector&lt; double &gt; &amp;z, vector&lt; double &gt; &amp;a, vector&lt; double &gt; &amp;b)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">multiply two 3x3 matrices  <a href="#afc25b20145576567e02ac9bfa60efaa0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a0119ec6004b03769d03578f1a2c7e289">timesone</a> (vector&lt; double &gt; &amp;z, vector&lt; double &gt; &amp;a, vector&lt; double &gt; &amp;b)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">multiply a 1x3 vector by a 3x3 matrix  <a href="#a0119ec6004b03769d03578f1a2c7e289"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#ad1202229394b0f93827ae5a67abd951f">b_mean</a> (double k, double m, double mm, double n)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">bayesian mean - prior + observed  <a href="#ad1202229394b0f93827ae5a67abd951f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#aafff55244ded61e2583fe23532e19799">b_var</a> (double v, double pv, double ddx, double cc, double nc, double k, double mcc, double pm)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">bayesian variance - prior + observed + shift in means  <a href="#aafff55244ded61e2583fe23532e19799"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a2ca380c421378333fbafecc2304e27a6">l_posterior</a> (double xcx, double lc, double xc, double yc, double dvc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gaussian likelihood, in convenient running sums form  <a href="#a2ca380c421378333fbafecc2304e27a6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a7280a531de940ab662d2c20605be5d21">l_normal</a> (double m, double x, double v)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gaussian likelihood, for just one piece of data  <a href="#a7280a531de940ab662d2c20605be5d21"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae5888b170f3551ccab26ef4c4ccb44e2"></a><!-- doxytag: member="snp.label.cpp::l_two_normal" ref="ae5888b170f3551ccab26ef4c4ccb44e2" args="(double x, double y, cluster_data &amp;cl, double inflatePRA)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>l_two_normal</b> (double x, double y, <a class="el" href="classcluster__data.html">cluster_data</a> &amp;cl, double inflatePRA)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#ad9a6d2941c7fb47be8cd441cbb60c2d9">l_inverse</a> (double av, double dv, double v)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cheap inverse-gamma likelihood, for one piece of data  <a href="#ad9a6d2941c7fb47be8cd441cbb60c2d9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a448b37d74fcf36fe83e37c69e5c74b2b">fix_shell</a> (double a, double b, double h, double shell)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">check if centers too close, return bignum if true  <a href="#a448b37d74fcf36fe83e37c69e5c74b2b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a6d67d855bb034343920e82fbaf1bdb2b">fix_hom_shell</a> (double a, double b, double h, double shell)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">prevents hom clusters from approaching midline not useful on B chip due to asymmetric probe choice  <a href="#a6d67d855bb034343920e82fbaf1bdb2b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a2a658dc31870f851cdbdf18aa2d3d39e">make_a_call</a> (affx::GType &amp;call, double &amp;conf, double txd, double txh, double txc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given 3 genotype probabilities, make a call/confidence output.  <a href="#a2a658dc31870f851cdbdf18aa2d3d39e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a86cb22d116534c54810fb8ea68b1fb47">make_calls</a> (vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, int length, <a class="el" href="classcluster__data.html">cluster_data</a> &amp;pa, <a class="el" href="classcluster__data.html">cluster_data</a> &amp;ph, <a class="el" href="classcluster__data.html">cluster_data</a> &amp;pb, int cn, int freqflag, vector&lt; double &gt; &amp;vTxa, vector&lt; double &gt; &amp;vTxh, vector&lt; double &gt; &amp;vTxb, bool store_probabilities)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given cluster parameters for each genotype, call data as genotypes.  <a href="#a86cb22d116534c54810fb8ea68b1fb47"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a64093c4de47f32c8b4821a5b3c37dab3">make_two_calls</a> (vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, int length, <a class="el" href="classsnp__distribution.html">snp_distribution</a> &amp;p, int cn, int freqflag, double ocean, double inflatePRA, vector&lt; double &gt; &amp;vTxa, vector&lt; double &gt; &amp;vTxh, vector&lt; double &gt; &amp;vTxb, bool store_probabilities)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given cluster parameters for each genotype, call data as genotypes.  <a href="#a64093c4de47f32c8b4821a5b3c37dab3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a10bb8cda395efca9a0885ab042920921">make_label_calls</a> (vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, int length, vector&lt; double &gt; &amp;ed, vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, int cn)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make calls using the final labelings - primarily a matter of unsorting the contrast values  <a href="#a10bb8cda395efca9a0885ab042920921"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a1a85fb40b35261384899759ca5a83b66">setup_bins</a> (<a class="el" href="classbinned__data.html">binned_data</a> &amp;zall, vector&lt; double &gt; &amp;z, vector&lt; double &gt; &amp;w, vector&lt; int &gt; &amp;zerohints, vector&lt; double &gt; &amp;zeroInbred, int zlength, int bins, int hok, double Cpenalty)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">assigns the sorted constrast data into "bins" for fast processing  <a href="#a1a85fb40b35261384899759ca5a83b66"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a2cf95e5f494d77911161becc1518ef95">compute_binned_cluster</a> (double &amp;n, double &amp;m, double &amp;s, <a class="el" href="classbinned__data.html">binned_data</a> &amp;zall, vector&lt; double &gt; &amp;wi, int ZS)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">generate sums of data based on weighted cluster membership  <a href="#a2cf95e5f494d77911161becc1518ef95"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a35346d828a53f326d0e58596c6067c07">compute_two_binned_cluster</a> (vector&lt; double &gt; &amp;six, <a class="el" href="classbinned__data.html">binned_data</a> &amp;zall, vector&lt; double &gt; &amp;wi, int ZS)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">generate sums of data based on weighted cluster membership  <a href="#a35346d828a53f326d0e58596c6067c07"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a0290a1a25d31fc26c81588daca77a8f2">expand_data</a> (vector&lt; double &gt; &amp;tex, int length, vector&lt; double &gt; &amp;ex, vector&lt; double &gt; &amp;nz, int ZS)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">take probabilities of bins and turn them into probabilities of individual points  <a href="#a0290a1a25d31fc26c81588daca77a8f2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a8e097ae837d7e8b8ff40b974a07570aa">qtoeq</a> (vector&lt; double &gt; &amp;q, int ZS)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert log-likelihood of all labelings into relative probability  <a href="#a8e097ae837d7e8b8ff40b974a07570aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a4e0eeb85252ceaca83c545aef7ba4c4e">eqtoproblabel</a> (vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, vector&lt; double &gt; &amp;ed, int ZS, vector&lt; double &gt; q)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">turn the overall relative probability of labelings into relative probability of individual genotypes  <a href="#a4e0eeb85252ceaca83c545aef7ba4c4e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#ac2829bc689e49ff601dd7a2cabb6eec2">setupBRLMM</a> (vector&lt; double &gt; &amp;m, vector&lt; double &gt; &amp;Minv, vector&lt; double &gt; &amp;Sinv, <a class="el" href="classsnp__param.html">snp_param</a> &amp;sp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">setup the matrixes for doing individual BRLMM steps  <a href="#ac2829bc689e49ff601dd7a2cabb6eec2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6402da9f37e1c7acf5be3e54ce027245"></a><!-- doxytag: member="snp.label.cpp::force_isotonic" ref="a6402da9f37e1c7acf5be3e54ce027245" args="(double &amp;mb, double &amp;mh, double &amp;ma, double wb, double wh, double wa, double delta)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>force_isotonic</b> (double &amp;mb, double &amp;mh, double &amp;ma, double wb, double wh, double wa, double delta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6deb20b6b30558bfd68308c9971d1c6e"></a><!-- doxytag: member="snp.label.cpp::force_IsoHetY" ref="a6deb20b6b30558bfd68308c9971d1c6e" args="(snp_distribution &amp;post, double IsoHetWeight)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>force_IsoHetY</b> (<a class="el" href="classsnp__distribution.html">snp_distribution</a> &amp;post, double IsoHetWeight)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad18fd7baaea6096b660d0d354f393c4c"></a><!-- doxytag: member="snp.label.cpp::bayes_two_variance" ref="ad18fd7baaea6096b660d0d354f393c4c" args="(cluster_data &amp;post, vector&lt; double &gt; &amp;sixc, cluster_data &amp;prior)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>bayes_two_variance</b> (<a class="el" href="classcluster__data.html">cluster_data</a> &amp;post, vector&lt; double &gt; &amp;sixc, <a class="el" href="classcluster__data.html">cluster_data</a> &amp;prior)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7452a001c56eea9336de964b6d3e3261"></a><!-- doxytag: member="snp.label.cpp::shrink_cluster_variance" ref="a7452a001c56eea9336de964b6d3e3261" args="(cluster_data &amp;out, cluster_data &amp;a, cluster_data &amp;b, cluster_data &amp;c, double lambda)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>shrink_cluster_variance</b> (<a class="el" href="classcluster__data.html">cluster_data</a> &amp;out, <a class="el" href="classcluster__data.html">cluster_data</a> &amp;a, <a class="el" href="classcluster__data.html">cluster_data</a> &amp;b, <a class="el" href="classcluster__data.html">cluster_data</a> &amp;c, double lambda)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a983f7f2a53bdcbb18974914442b1d708"></a><!-- doxytag: member="snp.label.cpp::bayes_two_shrink_variance" ref="a983f7f2a53bdcbb18974914442b1d708" args="(snp_param &amp;sp)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>bayes_two_shrink_variance</b> (<a class="el" href="classsnp__param.html">snp_param</a> &amp;sp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93d1d3d5ccde871c1a10bdbe3de51dc5"></a><!-- doxytag: member="snp.label.cpp::Dump_Matrix" ref="a93d1d3d5ccde871c1a10bdbe3de51dc5" args="(Matrix &amp;M)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>Dump_Matrix</b> (Matrix &amp;M)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa421fb967ce36c3b34baeb9b54ecc3aa"></a><!-- doxytag: member="snp.label.cpp::Dump_Column" ref="aa421fb967ce36c3b34baeb9b54ecc3aa" args="(ColumnVector &amp;V)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>Dump_Column</b> (ColumnVector &amp;V)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4889d04838fe81b94a3aff6690f891c9"></a><!-- doxytag: member="snp.label.cpp::labels_two_posterior" ref="a4889d04838fe81b94a3aff6690f891c9" args="(vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, vector&lt; double &gt; &amp;ed, int ZS, binned_data &amp;zall, snp_param &amp;sp)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>labels_two_posterior</b> (vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, vector&lt; double &gt; &amp;ed, int ZS, <a class="el" href="classbinned__data.html">binned_data</a> &amp;zall, <a class="el" href="classsnp__param.html">snp_param</a> &amp;sp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#aa6c1f401c915be4f6db927f0b0b627c8">labelstoposterior</a> (vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, vector&lt; double &gt; &amp;ed, int ZS, <a class="el" href="classbinned__data.html">binned_data</a> &amp;zall, <a class="el" href="classsnp__param.html">snp_param</a> &amp;sp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">convert binned label relative probabilities into cluster parameters  <a href="#aa6c1f401c915be4f6db927f0b0b627c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a13b6fb2fd4777966e2fc309ddac76b38">mixture_penalty</a> (double a, double b, double c, double oa, double ob, double oc, double lambda)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This penalizes unusual frequency distributions.  <a href="#a13b6fb2fd4777966e2fc309ddac76b38"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a188ea3959b9c819926f6a1ea3207f4d6">HW_penalty</a> (double a, double b, double c, double lambda)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This penalizes unusual cluster distributions (violating HW extremely) Expected to be useful for screening/finding initial priors.  <a href="#a188ea3959b9c819926f6a1ea3207f4d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#af8085a9844832cf7a94ad62a95704b67">integratebrlmmoverlabelings</a> (vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, vector&lt; double &gt; &amp;ed, int ZS, <a class="el" href="classbinned__data.html">binned_data</a> &amp;zall, <a class="el" href="classsnp__param.html">snp_param</a> &amp;sp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is the "labeling" routine that tries out all plausible genotypes for best likelihood Basic goal: efficiently evaluate likelihood of three clusters based on seed Loops over BB,...BB (i times), AB,...AB (j-i), AA,...AA (n-j+1).  <a href="#af8085a9844832cf7a94ad62a95704b67"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a8f4d65cf5118d9aad3b3c4e8c40e613f">apply_wobble</a> (<a class="el" href="classsnp__param.html">snp_param</a> &amp;sp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">tunes up the prior to allow for cluster shifts  <a href="#a8f4d65cf5118d9aad3b3c4e8c40e613f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4a60a00eef00382f60d371e73e9c2e44"></a><!-- doxytag: member="snp.label.cpp::qc_modify_confidences" ref="a4a60a00eef00382f60d371e73e9c2e44" args="(vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;y, double perr)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>qc_modify_confidences</b> (vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;y, double perr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab809ce316571f732810f1e36835a2ff2"></a><!-- doxytag: member="snp.label.cpp::qc_compute_copy_posterior" ref="ab809ce316571f732810f1e36835a2ff2" args="(vector&lt; affx::GType &gt; call, vector&lt; double &gt; &amp;y, snp_distribution &amp;posterior)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>qc_compute_copy_posterior</b> (vector&lt; affx::GType &gt; call, vector&lt; double &gt; &amp;y, <a class="el" href="classsnp__distribution.html">snp_distribution</a> &amp;posterior)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a177ca9f19d2652b1f1a23f2d5c9627b8"></a><!-- doxytag: member="snp.label.cpp::qc_posterior_modify_confidences" ref="a177ca9f19d2652b1f1a23f2d5c9627b8" args="(vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;y, double perr, snp_distribution dist)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>qc_posterior_modify_confidences</b> (vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;y, double perr, <a class="el" href="classsnp__distribution.html">snp_distribution</a> dist)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a2979dac75c6e93d694bae23f061b1be8">initialize_bins</a> (<a class="el" href="classbinned__data.html">binned_data</a> &amp;zall, vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; int &gt; &amp;genohints, vector&lt; double &gt; &amp;SubsetInbred, int numbins, int hok, double CP)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set up the binned data from the regular data compute running sums, allocate sorted bins.  <a href="#a2979dac75c6e93d694bae23f061b1be8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="snp_8label_8cpp.html#a1050ceb8ac15c0c39cffa4dbf76709b3">bayes_label</a> (vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; int &gt; &amp;genohints, vector&lt; double &gt; &amp;SubsetInbred, <a class="el" href="classsnp__param.html">snp_param</a> &amp;sp)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The master routine: takes data and turns it into genotypes with no seeds needed.  <a href="#a1050ceb8ac15c0c39cffa4dbf76709b3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5629b13df4e5adffa0a4dda8c9964173"></a><!-- doxytag: member="snp.label.cpp::bayes_label" ref="a5629b13df4e5adffa0a4dda8c9964173" args="(vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; int &gt; &amp;genohints, vector&lt; double &gt; &amp;SubsetInbred, snp_param &amp;sp, vector&lt; double &gt; &amp;ted, vector&lt; double &gt; &amp;teh, vector&lt; double &gt; &amp;tec, bool store_probabilities)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>bayes_label</b> (vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; int &gt; &amp;genohints, vector&lt; double &gt; &amp;SubsetInbred, <a class="el" href="classsnp__param.html">snp_param</a> &amp;sp, vector&lt; double &gt; &amp;ted, vector&lt; double &gt; &amp;teh, vector&lt; double &gt; &amp;tec, bool store_probabilities)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="author"><dt><b>Author:</b></dt><dd>Earl Hubbell </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>Jan 22 2007</dd></dl>
<p>Does the labeling algorithmics. </p>

<p>Definition in file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a476e5d98fb03d9efaccb100f40cd672f"></a><!-- doxytag: member="snp.label.cpp::apply_sum" ref="a476e5d98fb03d9efaccb100f40cd672f" args="(vector&lt; double &gt; &amp;final, const vector&lt; double &gt; &amp;source, int length, int flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_sum </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sum up the source array along one axis </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- output, marginal sums of array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>- input, all the individual values </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- dimension of array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flag</em>&nbsp;</td><td>- which margin to sum to </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00135">135</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8cpp_source.html#l00062">hax()</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l00984">eqtoproblabel()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f4d65cf5118d9aad3b3c4e8c40e613f"></a><!-- doxytag: member="snp.label.cpp::apply_wobble" ref="a8f4d65cf5118d9aad3b3c4e8c40e613f" args="(snp_param &amp;sp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_wobble </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsnp__param.html">snp_param</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>tunes up the prior to allow for cluster shifts </p>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l01836">1836</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00133">snp_distribution::aa</a>, <a class="el" href="snp_8label_8h_source.html#l00134">snp_distribution::ab</a>, <a class="el" href="snp_8label_8h_source.html#l00135">snp_distribution::bb</a>, <a class="el" href="snp_8label_8h_source.html#l00059">cluster_data::k</a>, and <a class="el" href="snp_8label_8h_source.html#l00207">snp_param::wobble</a>.</p>

</div>
</div>
<a class="anchor" id="ad1202229394b0f93827ae5a67abd951f"></a><!-- doxytag: member="snp.label.cpp::b_mean" ref="ad1202229394b0f93827ae5a67abd951f" args="(double k, double m, double mm, double n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double b_mean </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>mm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>bayesian mean - prior + observed </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>k</em>&nbsp;</td><td>- prior pseudo-observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>- prior mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mm</em>&nbsp;</td><td>- observed sum of data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>- number of observations </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00357">357</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aafff55244ded61e2583fe23532e19799"></a><!-- doxytag: member="snp.label.cpp::b_var" ref="aafff55244ded61e2583fe23532e19799" args="(double v, double pv, double ddx, double cc, double nc, double k, double mcc, double pm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double b_var </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>pv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ddx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>nc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>mcc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>pm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>bayesian variance - prior + observed + shift in means </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>v</em>&nbsp;</td><td>- prior pseudo-observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pv</em>&nbsp;</td><td>- prior variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ddx</em>&nbsp;</td><td>- sum of squares of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cc</em>&nbsp;</td><td>- sum of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nc</em>&nbsp;</td><td>- number of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>k</em>&nbsp;</td><td>- prior pseudo-observations for mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mcc</em>&nbsp;</td><td>- observed mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pm</em>&nbsp;</td><td>- prior location for mean </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00375">375</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l01363">labelstoposterior()</a>.</p>

</div>
</div>
<a class="anchor" id="a1050ceb8ac15c0c39cffa4dbf76709b3"></a><!-- doxytag: member="snp.label.cpp::bayes_label" ref="a1050ceb8ac15c0c39cffa4dbf76709b3" args="(vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; int &gt; &amp;genohints, vector&lt; double &gt; &amp;SubsetInbred, snp_param &amp;sp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bayes_label </td>
          <td>(</td>
          <td class="paramtype">vector&lt; affx::GType &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>call</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>genohints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>SubsetInbred</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsnp__param.html">snp_param</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The master routine: takes data and turns it into genotypes with no seeds needed. </p>
<p>This is the magic function that does the clustering for the outside world.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>call</em>&nbsp;</td><td>- output of genotypes per data point </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conf</em>&nbsp;</td><td>- output of confidences (1-relative probability) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>- contrast values per data point </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>y</em>&nbsp;</td><td>- size values per data point - used as QC check for copy number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>genohints</em>&nbsp;</td><td>- any reference genotypes you have lying around as hints </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sp</em>&nbsp;</td><td>- snp parameters: prior information, algorithm parameters, etc. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l02129">2129</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8cpp_source.html#l02129">bayes_label()</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l02129">bayes_label()</a>, <a class="el" href="QuantLabelZMulti_8cpp_source.html#l00820">QuantLabelZMulti::computeEstimate()</a>, and <a class="el" href="QuantLabelZ_8cpp_source.html#l00601">QuantLabelZ::computeEstimate()</a>.</p>

</div>
</div>
<a class="anchor" id="a2cf95e5f494d77911161becc1518ef95"></a><!-- doxytag: member="snp.label.cpp::compute_binned_cluster" ref="a2cf95e5f494d77911161becc1518ef95" args="(double &amp;n, double &amp;m, double &amp;s, binned_data &amp;zall, vector&lt; double &gt; &amp;wi, int ZS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_binned_cluster </td>
          <td>(</td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbinned__data.html">binned_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>zall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>wi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ZS</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>generate sums of data based on weighted cluster membership </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>- effective number of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>- effective sum of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>- effective sum of squares of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zall</em>&nbsp;</td><td>- binned contrast data for points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wi</em>&nbsp;</td><td>- weight of bins </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ZS</em>&nbsp;</td><td>- number of bins </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00871">871</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00108">binned_data::nz</a>, <a class="el" href="snp_8label_8h_source.html#l00109">binned_data::zz</a>, and <a class="el" href="snp_8label_8h_source.html#l00110">binned_data::zzx</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01363">labelstoposterior()</a>.</p>

</div>
</div>
<a class="anchor" id="a35346d828a53f326d0e58596c6067c07"></a><!-- doxytag: member="snp.label.cpp::compute_two_binned_cluster" ref="a35346d828a53f326d0e58596c6067c07" args="(vector&lt; double &gt; &amp;six, binned_data &amp;zall, vector&lt; double &gt; &amp;wi, int ZS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_two_binned_cluster </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>six</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbinned__data.html">binned_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>zall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>wi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ZS</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>generate sums of data based on weighted cluster membership </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>- effective number of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>- effective sum of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>- effective sum of squares of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zall</em>&nbsp;</td><td>- binned contrast data for points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wi</em>&nbsp;</td><td>- weight of bins </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ZS</em>&nbsp;</td><td>- number of bins </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00896">896</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00108">binned_data::nz</a>, <a class="el" href="snp_8label_8h_source.html#l00115">binned_data::zxy</a>, <a class="el" href="snp_8label_8h_source.html#l00112">binned_data::zy</a>, <a class="el" href="snp_8label_8h_source.html#l00109">binned_data::zz</a>, <a class="el" href="snp_8label_8h_source.html#l00110">binned_data::zzx</a>, and <a class="el" href="snp_8label_8h_source.html#l00113">binned_data::zzy</a>.</p>

</div>
</div>
<a class="anchor" id="a089fb51f8383b6eea013f35531b091a9"></a><!-- doxytag: member="snp.label.cpp::cumsum" ref="a089fb51f8383b6eea013f35531b091a9" args="(double *final, double *source, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cumsum </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>cumulative sum of source vector </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- destination for cumulative sum </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>- source of individual values </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00087">87</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad748ef26c031cf6086e3a490afd3a47f"></a><!-- doxytag: member="snp.label.cpp::delta" ref="ad748ef26c031cf6086e3a490afd3a47f" args="(double *source, int length, int a, int b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double delta </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>difference in cumulative sums: i.e. </p>
<p>sum from b to a</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>- vector of cumulative sums </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- larger cumulative point </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- smaller cumulative point </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00117">117</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="SummaryStats_8cpp_source.html#l00043">SummaryStats::addData()</a>, <a class="el" href="CumulativeStats_8h_source.html#l00066">CumulativeStats&lt; double &gt;::addData()</a>, <a class="el" href="CNAnalysisMethod_8cpp_source.html#l00535">CNAnalysisMethod::binEqualSpacing()</a>, <a class="el" href="RMA_8cpp_source.html#l00195">RMA::medianPolishPsetFromMatrix()</a>, <a class="el" href="RMA_8cpp_source.html#l00422">RMA::medianPolishWithPrecomputedEffectsOnePass()</a>, <a class="el" href="RMA_8cpp_source.html#l00318">RMA::medianPolishWithPrecomputedEffectsUsedAsSeedValues()</a>, and <a class="el" href="CNAnalysisMethodCN_8cpp_source.html#l00787">CNAnalysisMethodCN::viterbi()</a>.</p>

</div>
</div>
<a class="anchor" id="a4e0eeb85252ceaca83c545aef7ba4c4e"></a><!-- doxytag: member="snp.label.cpp::eqtoproblabel" ref="a4e0eeb85252ceaca83c545aef7ba4c4e" args="(vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, vector&lt; double &gt; &amp;ed, int ZS, vector&lt; double &gt; q)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eqtoproblabel </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>eh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ZS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt;&nbsp;</td>
          <td class="paramname"> <em>q</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>turn the overall relative probability of labelings into relative probability of individual genotypes </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ec</em>&nbsp;</td><td>- relative probability of c = a allele dominant </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eh</em>&nbsp;</td><td>- relative probability of h = ab allele about equal </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ed</em>&nbsp;</td><td>- relative probability of d = b allele dominant </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ZS</em>&nbsp;</td><td>- marginal size of matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>q</em>&nbsp;</td><td>- matrix of relative probability of labelings </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00984">984</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8cpp_source.html#l00135">apply_sum()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l00101">vcumsum()</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="a0290a1a25d31fc26c81588daca77a8f2"></a><!-- doxytag: member="snp.label.cpp::expand_data" ref="a0290a1a25d31fc26c81588daca77a8f2" args="(vector&lt; double &gt; &amp;tex, int length, vector&lt; double &gt; &amp;ex, vector&lt; double &gt; &amp;nz, int ZS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void expand_data </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>tex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ZS</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>take probabilities of bins and turn them into probabilities of individual points </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tex</em>&nbsp;</td><td>- output per point </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- number of real data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ex</em>&nbsp;</td><td>- binned data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nz</em>&nbsp;</td><td>- number of points per bin </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ZS</em>&nbsp;</td><td>- number of bins </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00927">927</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6d67d855bb034343920e82fbaf1bdb2b"></a><!-- doxytag: member="snp.label.cpp::fix_hom_shell" ref="a6d67d855bb034343920e82fbaf1bdb2b" args="(double a, double b, double h, double shell)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fix_hom_shell </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>shell</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>prevents hom clusters from approaching midline not useful on B chip due to asymmetric probe choice </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- cluster aa mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- cluster bb mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>- cluater ab mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>shell</em>&nbsp;</td><td>- homs can't be closer to center than this or penalty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00481">481</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="a448b37d74fcf36fe83e37c69e5c74b2b"></a><!-- doxytag: member="snp.label.cpp::fix_shell" ref="a448b37d74fcf36fe83e37c69e5c74b2b" args="(double a, double b, double h, double shell)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fix_shell </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>shell</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>check if centers too close, return bignum if true </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- cluster aa </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- cluster bb </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>h</em>&nbsp;</td><td>- cluster ab </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>shell</em>&nbsp;</td><td>- minimum distance squared for penalty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00460">460</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="a05c9fe8994d405ac2e71e60d84a41a3c"></a><!-- doxytag: member="snp.label.cpp::hax" ref="a05c9fe8994d405ac2e71e60d84a41a3c" args="(int i, int j, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hax </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>hash indexer </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i</em>&nbsp;</td><td>- first index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>j</em>&nbsp;</td><td>- second index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- size of side of array </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00062">62</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l00135">apply_sum()</a>, <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00207">mask()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00191">outer_minus()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00949">qtoeq()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l00222">vmask()</a>.</p>

</div>
</div>
<a class="anchor" id="a188ea3959b9c819926f6a1ea3207f4d6"></a><!-- doxytag: member="snp.label.cpp::HW_penalty" ref="a188ea3959b9c819926f6a1ea3207f4d6" args="(double a, double b, double c, double lambda)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double HW_penalty </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>lambda</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This penalizes unusual cluster distributions (violating HW extremely) Expected to be useful for screening/finding initial priors. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- hom cluster freq </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- hom cluster freq </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>- het cluster freq </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l01493">1493</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="a2979dac75c6e93d694bae23f061b1be8"></a><!-- doxytag: member="snp.label.cpp::initialize_bins" ref="a2979dac75c6e93d694bae23f061b1be8" args="(binned_data &amp;zall, vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; int &gt; &amp;genohints, vector&lt; double &gt; &amp;SubsetInbred, int numbins, int hok, double CP)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize_bins </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbinned__data.html">binned_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>zall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>genohints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>SubsetInbred</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numbins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>hok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>CP</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set up the binned data from the regular data compute running sums, allocate sorted bins. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>zall</em>&nbsp;</td><td>- overall structure to keep track of data + soft genotype labels by bin </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>- initial data points (unsorted) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>genohints</em>&nbsp;</td><td>- hints associated with data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numbins</em>&nbsp;</td><td>- how many bins to make, if bins&gt;points, go with points </td></tr>
  </table>
  </dd>
</dl>

<p><p>store sorted data </p>
</p>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l02038">2038</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00119">binned_data::noc</a>, <a class="el" href="snp_8label_8h_source.html#l00117">binned_data::nod</a>, <a class="el" href="snp_8label_8h_source.html#l00118">binned_data::noh</a>, <a class="el" href="snp_8label_8h_source.html#l00108">binned_data::nz</a>, <a class="el" href="snp_8label_8cpp_source.html#l00785">setup_bins()</a>, <a class="el" href="snp_8label_8h_source.html#l00115">binned_data::zxy</a>, <a class="el" href="snp_8label_8h_source.html#l00112">binned_data::zy</a>, <a class="el" href="snp_8label_8h_source.html#l00109">binned_data::zz</a>, <a class="el" href="snp_8label_8h_source.html#l00110">binned_data::zzx</a>, and <a class="el" href="snp_8label_8h_source.html#l00113">binned_data::zzy</a>.</p>

</div>
</div>
<a class="anchor" id="af8085a9844832cf7a94ad62a95704b67"></a><!-- doxytag: member="snp.label.cpp::integratebrlmmoverlabelings" ref="af8085a9844832cf7a94ad62a95704b67" args="(vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, vector&lt; double &gt; &amp;ed, int ZS, binned_data &amp;zall, snp_param &amp;sp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void integratebrlmmoverlabelings </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>eh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ZS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbinned__data.html">binned_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>zall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsnp__param.html">snp_param</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is the "labeling" routine that tries out all plausible genotypes for best likelihood Basic goal: efficiently evaluate likelihood of three clusters based on seed Loops over BB,...BB (i times), AB,...AB (j-i), AA,...AA (n-j+1). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ec</em>&nbsp;</td><td>- relative probability of c = a allele dominates </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eh</em>&nbsp;</td><td>- relative probability of h = ab allele similar </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ec</em>&nbsp;</td><td>- relative probability of d = b allele dominates </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ZS</em>&nbsp;</td><td>- number of bins + 1 = size of data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zall</em>&nbsp;</td><td>- data in bins, sum, sum of squares </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sp</em>&nbsp;</td><td>- snp parameters </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l01519">1519</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00133">snp_distribution::aa</a>, <a class="el" href="snp_8label_8h_source.html#l00134">snp_distribution::ab</a>, <a class="el" href="snp_8label_8cpp_source.html#l00375">b_var()</a>, <a class="el" href="snp_8label_8h_source.html#l00135">snp_distribution::bb</a>, <a class="el" href="snp_8label_8h_source.html#l00204">snp_param::bic</a>, <a class="el" href="snp_8label_8h_source.html#l00193">snp_param::comvar</a>, <a class="el" href="snp_8label_8h_source.html#l00199">snp_param::copynumber</a>, <a class="el" href="snp_8label_8h_source.html#l00205">snp_param::CSepPen</a>, <a class="el" href="snp_8label_8h_source.html#l00206">snp_param::CSepThr</a>, <a class="el" href="snp_8label_8cpp_source.html#l00984">eqtoproblabel()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00481">fix_hom_shell()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00460">fix_shell()</a>, <a class="el" href="snp_8label_8h_source.html#l00196">snp_param::hardshell</a>, <a class="el" href="snp_8label_8cpp_source.html#l00062">hax()</a>, <a class="el" href="snp_8label_8h_source.html#l00200">snp_param::hints</a>, <a class="el" href="snp_8label_8cpp_source.html#l01493">HW_penalty()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00278">inversethree()</a>, <a class="el" href="snp_8label_8h_source.html#l00059">cluster_data::k</a>, <a class="el" href="snp_8label_8cpp_source.html#l00447">l_inverse()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00412">l_normal()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00398">l_posterior()</a>, <a class="el" href="snp_8label_8h_source.html#l00194">snp_param::lambda</a>, <a class="el" href="snp_8label_8h_source.html#l00057">cluster_data::m</a>, <a class="el" href="snp_8label_8h_source.html#l00203">snp_param::mix</a>, <a class="el" href="snp_8label_8cpp_source.html#l01471">mixture_penalty()</a>, <a class="el" href="snp_8label_8h_source.html#l00119">binned_data::noc</a>, <a class="el" href="snp_8label_8h_source.html#l00117">binned_data::nod</a>, <a class="el" href="snp_8label_8h_source.html#l00118">binned_data::noh</a>, <a class="el" href="snp_8label_8h_source.html#l00108">binned_data::nz</a>, <a class="el" href="snp_8label_8cpp_source.html#l00949">qtoeq()</a>, <a class="el" href="snp_8label_8h_source.html#l00216">snp_param::SafetyFrequency</a>, <a class="el" href="snp_8label_8cpp_source.html#l01027">setupBRLMM()</a>, <a class="el" href="snp_8label_8h_source.html#l00197">snp_param::shellbarrier</a>, <a class="el" href="snp_8label_8h_source.html#l00058">cluster_data::ss</a>, <a class="el" href="snp_8label_8cpp_source.html#l00305">sumthree()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00340">timesone()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00319">timesthree()</a>, <a class="el" href="snp_8label_8h_source.html#l00060">cluster_data::v</a>, <a class="el" href="snp_8label_8cpp_source.html#l00101">vcumsum()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00174">vreversecumsum()</a>, <a class="el" href="snp_8label_8h_source.html#l00109">binned_data::zz</a>, and <a class="el" href="snp_8label_8h_source.html#l00110">binned_data::zzx</a>.</p>

</div>
</div>
<a class="anchor" id="a57e554714be3edbd1b2393e5824b03b4"></a><!-- doxytag: member="snp.label.cpp::inversethree" ref="a57e554714be3edbd1b2393e5824b03b4" args="(vector&lt; double &gt; &amp;w, vector&lt; double &gt; &amp;v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void inversethree </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>v</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>inverts 3x3 matrix specialty code, avoid calling external routines </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>w</em>&nbsp;</td><td>- output inverse of matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>v</em>&nbsp;</td><td>- input matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00278">278</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l01363">labelstoposterior()</a>.</p>

</div>
</div>
<a class="anchor" id="ad9a6d2941c7fb47be8cd441cbb60c2d9"></a><!-- doxytag: member="snp.label.cpp::l_inverse" ref="ad9a6d2941c7fb47be8cd441cbb60c2d9" args="(double av, double dv, double v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double l_inverse </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>av</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>v</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>cheap inverse-gamma likelihood, for one piece of data </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>av</em>&nbsp;</td><td>- prior expected variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dv</em>&nbsp;</td><td>- observed variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>v</em>&nbsp;</td><td>- pseudo-observations for prior </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00447">447</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="a7280a531de940ab662d2c20605be5d21"></a><!-- doxytag: member="snp.label.cpp::l_normal" ref="a7280a531de940ab662d2c20605be5d21" args="(double m, double x, double v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double l_normal </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>v</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>gaussian likelihood, for just one piece of data </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>- mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>- observed value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>v</em>&nbsp;</td><td>- variance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00412">412</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l00534">make_calls()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ca380c421378333fbafecc2304e27a6"></a><!-- doxytag: member="snp.label.cpp::l_posterior" ref="a2ca380c421378333fbafecc2304e27a6" args="(double xcx, double lc, double xc, double yc, double dvc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double l_posterior </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>xcx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>xc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>yc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>dvc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>gaussian likelihood, in convenient running sums form </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>xcx</em>&nbsp;</td><td>- sum of squares of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lc</em>&nbsp;</td><td>- posterior mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>xc</em>&nbsp;</td><td>- sum of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>yc</em>&nbsp;</td><td>- number of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dvc</em>&nbsp;</td><td>- posterior variance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00398">398</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="aa6c1f401c915be4f6db927f0b0b627c8"></a><!-- doxytag: member="snp.label.cpp::labelstoposterior" ref="aa6c1f401c915be4f6db927f0b0b627c8" args="(vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, vector&lt; double &gt; &amp;ed, int ZS, binned_data &amp;zall, snp_param &amp;sp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void labelstoposterior </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>eh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ZS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbinned__data.html">binned_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>zall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsnp__param.html">snp_param</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>convert binned label relative probabilities into cluster parameters </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ec</em>&nbsp;</td><td>- relative probability of c = a allele dominates </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eh</em>&nbsp;</td><td>- relative probability of h = ab about equal </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ed</em>&nbsp;</td><td>- relative probability of d = b allele dominates </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ZS</em>&nbsp;</td><td>- length of bins </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zall</em>&nbsp;</td><td>- all binned data, sums, sums of squares </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sp</em>&nbsp;</td><td>- snp parameters </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l01363">1363</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00133">snp_distribution::aa</a>, <a class="el" href="snp_8label_8h_source.html#l00134">snp_distribution::ab</a>, <a class="el" href="snp_8label_8cpp_source.html#l00375">b_var()</a>, <a class="el" href="snp_8label_8h_source.html#l00135">snp_distribution::bb</a>, <a class="el" href="snp_8label_8cpp_source.html#l00871">compute_binned_cluster()</a>, <a class="el" href="snp_8label_8h_source.html#l00193">snp_param::comvar</a>, <a class="el" href="snp_8label_8h_source.html#l00196">snp_param::hardshell</a>, <a class="el" href="snp_8label_8cpp_source.html#l00278">inversethree()</a>, <a class="el" href="snp_8label_8h_source.html#l00059">cluster_data::k</a>, <a class="el" href="snp_8label_8h_source.html#l00194">snp_param::lambda</a>, <a class="el" href="snp_8label_8h_source.html#l00057">cluster_data::m</a>, <a class="el" href="snp_8label_8h_source.html#l00066">cluster_data::Set()</a>, <a class="el" href="snp_8label_8cpp_source.html#l01027">setupBRLMM()</a>, <a class="el" href="snp_8label_8h_source.html#l00197">snp_param::shellbarrier</a>, <a class="el" href="snp_8label_8h_source.html#l00058">cluster_data::ss</a>, <a class="el" href="snp_8label_8cpp_source.html#l00305">sumthree()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00340">timesone()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00319">timesthree()</a>, <a class="el" href="snp_8label_8h_source.html#l00060">cluster_data::v</a>, <a class="el" href="snp_8label_8h_source.html#l00140">snp_distribution::xhb</a>, <a class="el" href="snp_8label_8h_source.html#l00063">cluster_data::xyss</a>, <a class="el" href="snp_8label_8h_source.html#l00061">cluster_data::ym</a>, and <a class="el" href="snp_8label_8h_source.html#l00062">cluster_data::yss</a>.</p>

</div>
</div>
<a class="anchor" id="a2a658dc31870f851cdbdf18aa2d3d39e"></a><!-- doxytag: member="snp.label.cpp::make_a_call" ref="a2a658dc31870f851cdbdf18aa2d3d39e" args="(affx::GType &amp;call, double &amp;conf, double txd, double txh, double txc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_a_call </td>
          <td>(</td>
          <td class="paramtype">affx::GType &amp;&nbsp;</td>
          <td class="paramname"> <em>call</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>txd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>txh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>txc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given 3 genotype probabilities, make a call/confidence output. </p>
<p>- call of final genotype 2,1,0  - confidence of final genotypes 1-likelihood  - relative probability of d = b allele dominant  - relative probability of a+b allele  - relative probability of c = a allele dominant </p>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00502">502</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l00534">make_calls()</a>, <a class="el" href="snp_8label_8cpp_source.html#l00741">make_label_calls()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l00624">make_two_calls()</a>.</p>

</div>
</div>
<a class="anchor" id="a86cb22d116534c54810fb8ea68b1fb47"></a><!-- doxytag: member="snp.label.cpp::make_calls" ref="a86cb22d116534c54810fb8ea68b1fb47" args="(vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, int length, cluster_data &amp;pa, cluster_data &amp;ph, cluster_data &amp;pb, int cn, int freqflag, vector&lt; double &gt; &amp;vTxa, vector&lt; double &gt; &amp;vTxh, vector&lt; double &gt; &amp;vTxb, bool store_probabilities)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_calls </td>
          <td>(</td>
          <td class="paramtype">vector&lt; affx::GType &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>call</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcluster__data.html">cluster_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>pa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcluster__data.html">cluster_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>ph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcluster__data.html">cluster_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>pb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>freqflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>vTxa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>vTxh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>vTxb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>store_probabilities</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given cluster parameters for each genotype, call data as genotypes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>call</em>&nbsp;</td><td>- output called genotypes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conf</em>&nbsp;</td><td>- output confidences for each call </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>- input data in contrast space </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- number of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbma</em>&nbsp;</td><td>- aa cluster mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbva</em>&nbsp;</td><td>- aa cluster variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbmb</em>&nbsp;</td><td>- bb cluster mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbvb</em>&nbsp;</td><td>- bb cluster variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbmh</em>&nbsp;</td><td>- ab cluster mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbvh</em>&nbsp;</td><td>- ab cluster variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cn</em>&nbsp;</td><td>- copy number - are we 1 copy (all homs) or two allowing hets </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00534">534</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00059">cluster_data::k</a>, <a class="el" href="snp_8label_8cpp_source.html#l00412">l_normal()</a>, <a class="el" href="snp_8label_8h_source.html#l00057">cluster_data::m</a>, <a class="el" href="snp_8label_8cpp_source.html#l00502">make_a_call()</a>, and <a class="el" href="snp_8label_8h_source.html#l00058">cluster_data::ss</a>.</p>

</div>
</div>
<a class="anchor" id="a10bb8cda395efca9a0885ab042920921"></a><!-- doxytag: member="snp.label.cpp::make_label_calls" ref="a10bb8cda395efca9a0885ab042920921" args="(vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, int length, vector&lt; double &gt; &amp;ed, vector&lt; double &gt; &amp;ec, vector&lt; double &gt; &amp;eh, int cn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_label_calls </td>
          <td>(</td>
          <td class="paramtype">vector&lt; affx::GType &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>call</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>eh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>make calls using the final labelings - primarily a matter of unsorting the contrast values </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>call</em>&nbsp;</td><td>- output called genotypes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conf</em>&nbsp;</td><td>- confidence of call </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>- raw contrast values (unsorted) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- number of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ed</em>&nbsp;</td><td>- estimated relative probability for d = bb genotype (sorted) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ec</em>&nbsp;</td><td>- estimated relative probability for c = aa genotype (sorted) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eh</em>&nbsp;</td><td>- estimated relative probability for h = ab genotype (sorted) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cn</em>&nbsp;</td><td>- copynumber 1 = homs only, copynumber 2 = hets allowed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00741">741</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8cpp_source.html#l00502">make_a_call()</a>.</p>

</div>
</div>
<a class="anchor" id="a64093c4de47f32c8b4821a5b3c37dab3"></a><!-- doxytag: member="snp.label.cpp::make_two_calls" ref="a64093c4de47f32c8b4821a5b3c37dab3" args="(vector&lt; affx::GType &gt; &amp;call, vector&lt; double &gt; &amp;conf, vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, int length, snp_distribution &amp;p, int cn, int freqflag, double ocean, double inflatePRA, vector&lt; double &gt; &amp;vTxa, vector&lt; double &gt; &amp;vTxh, vector&lt; double &gt; &amp;vTxb, bool store_probabilities)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_two_calls </td>
          <td>(</td>
          <td class="paramtype">vector&lt; affx::GType &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>call</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsnp__distribution.html">snp_distribution</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>freqflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ocean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>inflatePRA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>vTxa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>vTxh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>vTxb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>store_probabilities</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given cluster parameters for each genotype, call data as genotypes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>call</em>&nbsp;</td><td>- output called genotypes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conf</em>&nbsp;</td><td>- output confidences for each call </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>- input data in contrast space </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- number of data points </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbma</em>&nbsp;</td><td>- aa cluster mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbva</em>&nbsp;</td><td>- aa cluster variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbmb</em>&nbsp;</td><td>- bb cluster mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbvb</em>&nbsp;</td><td>- bb cluster variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbmh</em>&nbsp;</td><td>- ab cluster mean </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rbvh</em>&nbsp;</td><td>- ab cluster variance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cn</em>&nbsp;</td><td>- copy number - are we 1 copy (all homs) or two allowing hets </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00624">624</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00133">snp_distribution::aa</a>, <a class="el" href="snp_8label_8h_source.html#l00134">snp_distribution::ab</a>, <a class="el" href="snp_8label_8h_source.html#l00135">snp_distribution::bb</a>, <a class="el" href="snp_8label_8h_source.html#l00059">cluster_data::k</a>, and <a class="el" href="snp_8label_8cpp_source.html#l00502">make_a_call()</a>.</p>

</div>
</div>
<a class="anchor" id="a553a86714dd371ce3f5833b6f8b3f447"></a><!-- doxytag: member="snp.label.cpp::mask" ref="a553a86714dd371ce3f5833b6f8b3f447" args="(double *final, int length, double val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mask </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>val</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>mask out a portion of an array </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- array to be masked </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- size of margin of array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>val</em>&nbsp;</td><td>- value to be placed in masked area </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00207">207</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8cpp_source.html#l00062">hax()</a>.</p>

<p>Referenced by <a class="el" href="DM_8cpp_source.html#l00342">GetPValue()</a>.</p>

</div>
</div>
<a class="anchor" id="a13b6fb2fd4777966e2fc309ddac76b38"></a><!-- doxytag: member="snp.label.cpp::mixture_penalty" ref="a13b6fb2fd4777966e2fc309ddac76b38" args="(double a, double b, double c, double oa, double ob, double oc, double lambda)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mixture_penalty </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>oa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>oc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>lambda</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This penalizes unusual frequency distributions. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- first cluster freq </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- second cluster freq </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>- third cluster freq </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>oa</em>&nbsp;</td><td>- number of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ob</em>&nbsp;</td><td>- number of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>oc</em>&nbsp;</td><td>- number of observations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lambda</em>&nbsp;</td><td>- parameterized safety value to avoid zero frequency </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l01471">1471</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="aa07c57aa95a5e1df7ed8e7d7c5154780"></a><!-- doxytag: member="snp.label.cpp::outer_minus" ref="aa07c57aa95a5e1df7ed8e7d7c5154780" args="(double *final, const double *a, const double *b, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void outer_minus </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>takes outer difference of two vectors </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- output matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- input vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- input vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00191">191</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8cpp_source.html#l00062">hax()</a>.</p>

</div>
</div>
<a class="anchor" id="a8e097ae837d7e8b8ff40b974a07570aa"></a><!-- doxytag: member="snp.label.cpp::qtoeq" ref="a8e097ae837d7e8b8ff40b974a07570aa" args="(vector&lt; double &gt; &amp;q, int ZS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qtoeq </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ZS</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>convert log-likelihood of all labelings into relative probability </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>q</em>&nbsp;</td><td>- matrix to be converted </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ZS</em>&nbsp;</td><td>- edge size of matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00949">949</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8cpp_source.html#l00062">hax()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l00222">vmask()</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="a4ad3f76517de13f099989b46c01d6c50"></a><!-- doxytag: member="snp.label.cpp::reversecumsum" ref="a4ad3f76517de13f099989b46c01d6c50" args="(double *final, const double *source, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reversecumsum </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>takes a cumulative sum and makes it cumulate from the other end </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- output, reverse cumulative sum </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>- input, forward direction cumulative sum </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00161">161</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1a85fb40b35261384899759ca5a83b66"></a><!-- doxytag: member="snp.label.cpp::setup_bins" ref="a1a85fb40b35261384899759ca5a83b66" args="(binned_data &amp;zall, vector&lt; double &gt; &amp;z, vector&lt; double &gt; &amp;w, vector&lt; int &gt; &amp;zerohints, vector&lt; double &gt; &amp;zeroInbred, int zlength, int bins, int hok, double Cpenalty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setup_bins </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbinned__data.html">binned_data</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>zall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>zerohints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>zeroInbred</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>zlength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>hok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>Cpenalty</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>assigns the sorted constrast data into "bins" for fast processing </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>zall</em>&nbsp;</td><td>- the bins of the data, number per bin, sums, sum-squares, hints </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>z</em>&nbsp;</td><td>- the raw data, sorted by constrast </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zerohints</em>&nbsp;</td><td>- what are the reference genotypes supplied </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zlength</em>&nbsp;</td><td>- how many values in the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bins</em>&nbsp;</td><td>- how many bins at most for the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hok</em>&nbsp;</td><td>- can homs be flipped in hints? </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00785">785</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00119">binned_data::noc</a>, <a class="el" href="snp_8label_8h_source.html#l00117">binned_data::nod</a>, <a class="el" href="snp_8label_8h_source.html#l00118">binned_data::noh</a>, <a class="el" href="snp_8label_8h_source.html#l00108">binned_data::nz</a>, <a class="el" href="snp_8label_8h_source.html#l00115">binned_data::zxy</a>, <a class="el" href="snp_8label_8h_source.html#l00112">binned_data::zy</a>, <a class="el" href="snp_8label_8h_source.html#l00109">binned_data::zz</a>, <a class="el" href="snp_8label_8h_source.html#l00110">binned_data::zzx</a>, and <a class="el" href="snp_8label_8h_source.html#l00113">binned_data::zzy</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l02038">initialize_bins()</a>.</p>

</div>
</div>
<a class="anchor" id="ac2829bc689e49ff601dd7a2cabb6eec2"></a><!-- doxytag: member="snp.label.cpp::setupBRLMM" ref="ac2829bc689e49ff601dd7a2cabb6eec2" args="(vector&lt; double &gt; &amp;m, vector&lt; double &gt; &amp;Minv, vector&lt; double &gt; &amp;Sinv, snp_param &amp;sp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setupBRLMM </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>Minv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>Sinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsnp__param.html">snp_param</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>setup the matrixes for doing individual BRLMM steps </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>m</em>&nbsp;</td><td>- prior mean vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Minv</em>&nbsp;</td><td>- inverse matrix of covariances (pseudo-observations) for means </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Sinv</em>&nbsp;</td><td>- inverse matrix of variances of observations within genotypes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classsnp__param.html" title="this holds all the parameters for a snp, including alg choices">snp_param</a></em>&nbsp;</td><td>- parameters of algorithm </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l01027">1027</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8h_source.html#l00133">snp_distribution::aa</a>, <a class="el" href="snp_8label_8h_source.html#l00134">snp_distribution::ab</a>, <a class="el" href="snp_8label_8h_source.html#l00135">snp_distribution::bb</a>, <a class="el" href="snp_8label_8h_source.html#l00059">cluster_data::k</a>, <a class="el" href="snp_8label_8h_source.html#l00057">cluster_data::m</a>, <a class="el" href="snp_8label_8h_source.html#l00058">cluster_data::ss</a>, and <a class="el" href="snp_8label_8h_source.html#l00140">snp_distribution::xhb</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l01363">labelstoposterior()</a>.</p>

</div>
</div>
<a class="anchor" id="a1f2ff039971eee5c78e94867f1cc9369"></a><!-- doxytag: member="snp.label.cpp::sumthree" ref="a1f2ff039971eee5c78e94867f1cc9369" args="(vector&lt; double &gt; &amp;z, vector&lt; double &gt; &amp;a, vector&lt; double &gt; &amp;b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sumthree </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sum two vectors </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>z</em>&nbsp;</td><td>- output </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- input </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- input </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00305">305</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l01363">labelstoposterior()</a>.</p>

</div>
</div>
<a class="anchor" id="a0119ec6004b03769d03578f1a2c7e289"></a><!-- doxytag: member="snp.label.cpp::timesone" ref="a0119ec6004b03769d03578f1a2c7e289" args="(vector&lt; double &gt; &amp;z, vector&lt; double &gt; &amp;a, vector&lt; double &gt; &amp;b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timesone </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>multiply a 1x3 vector by a 3x3 matrix </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>z</em>&nbsp;</td><td>- output </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- 3x3 matrix (as 9 length vector) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- 1x3 vector (as 3 length vector) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00340">340</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l01363">labelstoposterior()</a>.</p>

</div>
</div>
<a class="anchor" id="afc25b20145576567e02ac9bfa60efaa0"></a><!-- doxytag: member="snp.label.cpp::timesthree" ref="afc25b20145576567e02ac9bfa60efaa0" args="(vector&lt; double &gt; &amp;z, vector&lt; double &gt; &amp;a, vector&lt; double &gt; &amp;b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timesthree </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>multiply two 3x3 matrices </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>z</em>&nbsp;</td><td>- output </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- input 3x3 matrix (as 9 length vector) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- input 3x3 matrix (as 9 length vector) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00319">319</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l01363">labelstoposterior()</a>.</p>

</div>
</div>
<a class="anchor" id="ad32e3aff38d25c6b491ca6ed6e7fbc0d"></a><!-- doxytag: member="snp.label.cpp::transfer" ref="ad32e3aff38d25c6b491ca6ed6e7fbc0d" args="(double *final, double *source, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transfer </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>copies one float vector to another </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- destination vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>- source vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00074">74</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae947c9f1d5e7e344a40a3672ce12da20"></a><!-- doxytag: member="snp.label.cpp::vcumsum" ref="ae947c9f1d5e7e344a40a3672ce12da20" args="(vector&lt; double &gt; &amp;final, const vector&lt; double &gt; &amp;source, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vcumsum </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>cumulative sum of source vector using STL </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- destination for cumulative sum </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>- source of individual values </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data to sum over [carried over] </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00101">101</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l00984">eqtoproblabel()</a>, and <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="a0753c4704b4a8316c7aec8ad57f1e59f"></a><!-- doxytag: member="snp.label.cpp::vmask" ref="a0753c4704b4a8316c7aec8ad57f1e59f" args="(vector&lt; double &gt; &amp;final, int length, double val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vmask </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>val</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>mask out a portion of an array </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- array to be masked </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- size of margin of array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>val</em>&nbsp;</td><td>- value to be placed in masked area </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00222">222</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>References <a class="el" href="snp_8label_8cpp_source.html#l00062">hax()</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l00949">qtoeq()</a>.</p>

</div>
</div>
<a class="anchor" id="a8edf9aba80a02747bdb9108abc2f1e27"></a><!-- doxytag: member="snp.label.cpp::vmult" ref="a8edf9aba80a02747bdb9108abc2f1e27" args="(vector&lt; double &gt; &amp;X, double factor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vmult </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>factor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>multiply each element of a vector by a value </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>X</em>&nbsp;</td><td>- vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>factor</em>&nbsp;</td><td>- factor to multiply each element by </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00265">265</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a36c1a215b939f32b274bc2e7bf086e71"></a><!-- doxytag: member="snp.label.cpp::vplusscaldr" ref="a36c1a215b939f32b274bc2e7bf086e71" args="(double *final, double *a, double k, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vplusscaldr </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>add a constant to each element of a vector </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- output vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- input vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>k</em>&nbsp;</td><td>- value to be added </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00253">253</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a71b11dd6854f20d84e0f3f8993a6cdbe"></a><!-- doxytag: member="snp.label.cpp::vreversecumsum" ref="a71b11dd6854f20d84e0f3f8993a6cdbe" args="(vector&lt; double &gt; &amp;final, const vector&lt; double &gt; &amp;source, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vreversecumsum </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>takes a cumulative sum and makes it cumulate from the other end </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- output, reverse cumulative sum </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>- input, forward direction cumulative sum </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of data (not needed for STL) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00174">174</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

<p>Referenced by <a class="el" href="snp_8label_8cpp_source.html#l01519">integratebrlmmoverlabelings()</a>.</p>

</div>
</div>
<a class="anchor" id="a8de4a2f660ae0703b6f1f922b0b29478"></a><!-- doxytag: member="snp.label.cpp::vsum" ref="a8de4a2f660ae0703b6f1f922b0b29478" args="(double *final, const double *a, const double *b, int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vsum </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sum two vectors </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>final</em>&nbsp;</td><td>- output </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- input vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- input vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>- length of input vectors </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="snp_8label_8cpp_source.html#l00239">239</a> of file <a class="el" href="snp_8label_8cpp_source.html">snp.label.cpp</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Jul 15 2014 10:37:54 for Affymetrix Power Tools by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
